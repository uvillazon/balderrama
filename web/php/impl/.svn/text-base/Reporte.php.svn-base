<?php
session_name("balderrama");
session_start();

////////////////////////////////////////////////////

function reporteEmpresaHTML($idempresa, $return)
{
    $sql2 = "SELECT
 nombre,mes_planillla
FROM
  empresas
WHERE
  idempresa = '$idempresa'";
    $idalmacenA =  findBySqlReturnCampoUnique($sql2, true, true, 'nombre');
    $empresa1 = $idalmacenA['resultado'];
      $empresa=strtoupper($empresa1);

       $idalmacenA1 =  findBySqlReturnCampoUnique($sql2, true, true, 'mes_planillla');
    $mesplanilla = $idalmacenA1['resultado'];
     $idsCAr = split("/", $mesplanilla);
$mesplani=$idsCAr[0];
$anioplani=$idsCAr[1];
if($mesplani == "01") {
 $mes="ENERO";
 $mesred="Ene";

 }
if($mesplani == "02") {
 $mes="FEBRERO";
 $mesred="Feb";
 }
if($mesplani == "03") {
 $mes="MARZO";
 $mesred="Mar";
 }
if($mesplani == "04") {
 $mes="ABRIL";}
if($mesplani == "05") {
 $mes="MAYO";}
if($mesplani == "06") {
 $mes="JUNIO";}
if($mesplani == "07") {
 $mes="JULIO";}
if($mesplani == "08") {
 $mes="AGOSTO";}
if($mesplani == "09") {
 $mes="SEPTIEMBRE";}
if($mesplani == "10") {
 $mes="OCTUBRE";}
if($mesplani == "11") {
 $mes="NOVIEMBRE";}
if($mesplani == "12") {
 $mes="DICIEMBRE";}
    //    echo $idalmacen;
 
$fecha2= split("-", $fecha1);
$y=$fecha2[0];
$m=$fecha2[1];
$d=$fecha2[2];
$fecha=$d."-".$m."-".$y;
    $html = "";
 $html .= "<tr><td colspan='4' align='center'>
    <p>AGENCIA DE CALZADOS<br />
         BALDERRAMA<br />
         Telf. 4-258993  Fax: 4-504183
    </p>
</td></tr>";
    $html .= "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN'>";
    $html .= "<html>";
    $html .= "<body>";
    $html .= "<tr>";

    $html .= "<table cellpadding='1' cellspacing='0' border='0' style='width:100%' font-size:11px; font-family:Tahoma;'>";
    $html .= "<td style='width:100%;height:100%;text-align:right;font-size:12px;font-family:Tahoma;'>";
    $html .= "$fecha  $tipo";
    $html .= "</td>";
    $html .= "<tr>";

    //$html .= "<tr style='width:100%height:100px;text-align:center;font-size:15px;font-family:Tahoma;'>";
    $html .= "<td style='width:100%;height:100px;text-align:center;font-size:15px;font-family:Tahoma;'>";
    $html .= "Empresa ".$empresa." <br>";
    $html .= "MES PLANILLA  $mes  $anioplani";
    $html .= "</td>";
    $html .= "</tr>";
    $html .= "</table>";
   $html .= "</tr>";
   $html .= "<tr>";

    $html .= "<td style='width:33%;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $sql = "SELECT e.direccion,e.telefono,e.mes_planillla AS MesPlanilla,CONCAT( c.nombre, '-', c.apellido ) AS responsable,inf.saldo_empresa
FROM empresas e,clienteempresa c,inf_empresa inf
WHERE e.idempresa=inf.idempresa AND e.idempresa=c.idempresa AND c.referencia='responsable' AND e.idempresa!='epr-0' AND e.idempresa = '$idempresa' ";
    //    MostrarConsulta($sql);
    $producto = dibujarTuplaOfSQLNormal($sql, "Informacion");
    $html .= $producto['resultado'];
    $html .= "</td>";
    $html .= "<td style='width:33%;text-align:right;font-size:11px;font-family:Tahoma;' valign='top'>";
    $sqlCar = "SELECT saldo_anterior, importe_boleta,importe_cobro,importe_devolucion,importe_castigo,importe_descuento,comision,diferencia,saldo_empresa,saldo_planilla,fecha_planilla
FROM inf_empresa WHERE idempresa = '$idempresa'";
    $carac = dibujarTablaOfSQLNormal($sqlCar, "Movimiento");
    $html .= $carac['resultado'];
    $html .="<br>";
    $html .= "</td>";
    $html .= "<td style='width:33%;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";

    $html .= "</td>";
    $html .= "</tr>";
    //$html .= "<tr>";
    //    $html .= "<td>";
     $mesplanilla = $idalmacenA1['resultado'];
     $idsCAr = split("/", $mesplanilla);

$sql5 = "SELECT
 vd.boleta
FROM
  ventasdetalle vd, credito c
WHERE
  vd.idventadetalle=c.idventadetalle AND c.idempresa = '$idempresa' AND c.no_planilla ='$planilla'";
    $idalmacenA =  findBySqlReturnCampoUnique($sql5, true, true, 'boleta');
    $tipo = $idalmacenA['resultado'];
  //	$sql2="SELECT i.numero_registro from ingreso i, tipo_ingreso ti where i.id_tipo_ingreso = ti.id_tipo_ingreso and i.fecha_ingreso>='".$_GET['fechaingreso7']."' and i.fecha_ingreso<='".$_GET['fechaingreso8']."' and i.id_tipo_ingreso='10'";
  $res2= consultaDB($sql5);
 // $r2=mysql_fetch_array($res2);
  //$numero = mysql_num_fields($res2);
  //echo $numero;
 // mysql_fetch_array
//echo "$r2[0]";
//$numero="3";
 for ($i = 0; $i <= $numero; $i++) {
 $r2[0];

$r2= mysql_fetch_array($res2);
 }
$re2=$r2[0]."-".$r2[1]."-".$r2[2];
//echo $sql5;

$recibo="1";
    //$html .= "<td style='width:400px;height:100px;border-bottom:1px solid #000000;'><img style='height:100px;' src='logo.jpg'>";
   // $html .= "<td style='width:200px;height:100px;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:100%;'>";
   // $html .= "<tr><tr>";
    $html .= "<tr><td align='right' style='font-size:11px; font-family:Tahoma; text-align:center;font-weight:bold;'><td><tr>";
  $sqlCar = "SELECT CONCAT( ce.nombre, '-', ce.apellido ) AS NombreyApellido, ce.item,'$re2' AS NumeroRecibo, ventasmes AS VentaOriginal, pago1 AS '$mes1',pago2 AS '$mes2',(pago3+pago4+pago5+pago6+pago7) AS '$mes3',pe.total AS Total
FROM planillaemitida pe, clienteempresa ce WHERE pe.idclienteempresa=ce.idclienteempresa AND pe.idempresa = '$idempresa' AND pe.no_planilla ='$planilla' ";
    $carac = dibujarTablaOfSQLNormal($sqlCar, "Creditos");
    $html .= $carac['resultado'];


    $html .= "</table>";
   // $html .= "</td>";
  //  $html .= "</tr>";

    $html .= "</body>";
    $html .= "</html>";
    if($return == true)
    {
        return $html;
    }
    else
    {
        echo $html;
    }

}


function reportesclienteHTML($idempresa, $return)
{
    $sql2 = "SELECT
 nombre,mes_planillla
FROM
  empresas
WHERE
  idempresa = '$idempresa'";
    $idalmacenA =  findBySqlReturnCampoUnique($sql2, true, true, 'nombre');
    $empresa1 = $idalmacenA['resultado'];
      $empresa=strtoupper($empresa1);

       $idalmacenA1 =  findBySqlReturnCampoUnique($sql2, true, true, 'mes_planillla');
    $mesplanilla = $idalmacenA1['resultado'];
     $idsCAr = split("/", $mesplanilla);
$mesplani=$idsCAr[0];
$anioplani=$idsCAr[1];
if($mesplani == "01") {
 $mes="ENERO";
 $mesred="Ene";

 }
if($mesplani == "02") {
 $mes="FEBRERO";
 $mesred="Feb";
 }
if($mesplani == "03") {
 $mes="MARZO";
 $mesred="Mar";
 }
if($mesplani == "04") {
 $mes="ABRIL";}
if($mesplani == "05") {
 $mes="MAYO";}
if($mesplani == "06") {
 $mes="JUNIO";}
if($mesplani == "07") {
 $mes="JULIO";}
if($mesplani == "08") {
 $mes="AGOSTO";}
if($mesplani == "09") {
 $mes="SEPTIEMBRE";}
if($mesplani == "10") {
 $mes="OCTUBRE";}
if($mesplani == "11") {
 $mes="NOVIEMBRE";}
if($mesplani == "12") {
 $mes="DICIEMBRE";}
    //    echo $idalmacen;

$fecha2= split("-", $fecha1);
$y=$fecha2[0];
$m=$fecha2[1];
$d=$fecha2[2];
$fecha=$d."-".$m."-".$y;
    $html = "";
 $html .= "<tr><td colspan='4' align='center'>
    <p>AGENCIA DE CALZADOS<br />
         BALDERRAMA<br />
         Telf. 4-258993  Fax: 4-504183
    </p>
</td></tr>";
    $html .= "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN'>";
    $html .= "<html>";
    $html .= "<body>";
    $html .= "<tr>";

    $html .= "<table cellpadding='1' cellspacing='0' border='0' style='width:100%' font-size:11px; font-family:Tahoma;'>";
    $html .= "<td style='width:100%;height:100%;text-align:right;font-size:12px;font-family:Tahoma;'>";
    $html .= "$fecha  $tipo";
    $html .= "</td>";
    $html .= "<tr>";

    //$html .= "<tr style='width:100%height:100px;text-align:center;font-size:15px;font-family:Tahoma;'>";
    $html .= "<td style='width:100%;height:100px;text-align:center;font-size:15px;font-family:Tahoma;'>";
    $html .= "Empresa ".$empresa." <br>";
    $html .= "MES PLANILLA  $mes  $anioplani";
    $html .= "</td>";
    $html .= "</tr>";
    $html .= "</table>";
   $html .= "</tr>";
   $html .= "<tr>";
    $html .= "<td style='width:33%;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $sql = "SELECT e.direccion,e.telefono,e.mes_planillla AS MesPlanilla,CONCAT( c.nombre, '-', c.apellido ) AS responsable,inf.saldo_empresa
FROM empresas e,clienteempresa c,inf_empresa inf
WHERE e.idempresa=inf.idempresa AND e.idempresa=c.idempresa AND c.referencia='responsable' AND e.idempresa!='epr-0' AND e.idempresa = '$idempresa' ";
    //    MostrarConsulta($sql);
    $producto = dibujarTuplaOfSQLNormal($sql, "Informacion");
    $html .= $producto['resultado'];
    $html .= "</td>";
    $html .= "<td style='width:33%;text-align:right;font-size:11px;font-family:Tahoma;' valign='top'>";
    $sqlCar = "SELECT nombre AS Nombre, apellido AS Apellido,nit AS Nit,item AS Item,saldoactual AS SaldoCliente FROM clienteempresa WHERE codigo!='Sin Codigo'  AND idempresa = '$idempresa'";
    $carac = dibujarTablaOfSQLNormal($sqlCar, "CLIENTES");
    $html .= $carac['resultado'];
    $html .="<br>";
    $html .= "</td>";
    $html .= "<td style='width:33%;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";

    $html .= "</td>";
    $html .= "</tr>";
    //$html .= "<tr>";
    //    $html .= "<td>";
     $mesplanilla = $idalmacenA1['resultado'];
     $idsCAr = split("/", $mesplanilla);

$sql5 = "SELECT
 vd.boleta
FROM
  ventasdetalle vd, credito c
WHERE
  vd.idventadetalle=c.idventadetalle AND c.idempresa = '$idempresa' AND c.no_planilla ='$planilla'";
    $idalmacenA =  findBySqlReturnCampoUnique($sql5, true, true, 'boleta');
    $tipo = $idalmacenA['resultado'];
  //	$sql2="SELECT i.numero_registro from ingreso i, tipo_ingreso ti where i.id_tipo_ingreso = ti.id_tipo_ingreso and i.fecha_ingreso>='".$_GET['fechaingreso7']."' and i.fecha_ingreso<='".$_GET['fechaingreso8']."' and i.id_tipo_ingreso='10'";
  $res2= consultaDB($sql5);
 // $r2=mysql_fetch_array($res2);
  //$numero = mysql_num_fields($res2);
  //echo $numero;
 // mysql_fetch_array
//echo "$r2[0]";
//$numero="3";
 for ($i = 0; $i <= $numero; $i++) {
 $r2[0];

$r2= mysql_fetch_array($res2);
 }
$re2=$r2[0]."-".$r2[1]."-".$r2[2];
//echo $sql5;

$recibo="1";
    //$html .= "<td style='width:400px;height:100px;border-bottom:1px solid #000000;'><img style='height:100px;' src='logo.jpg'>";
   // $html .= "<td style='width:200px;height:100px;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:100%;'>";
   // $html .= "<tr><tr>";
    $html .= "<tr><td align='right' style='font-size:11px; font-family:Tahoma; text-align:center;font-weight:bold;'><td><tr>";
  $sqlCar = "SELECT CONCAT( ce.nombre, '-', ce.apellido ) AS NombreyApellido, ce.item,'$re2' AS NumeroRecibo, ventasmes AS VentaOriginal, pago1 AS '$mes1',pago2 AS '$mes2',(pago3+pago4+pago5+pago6+pago7) AS '$mes3',pe.total AS Total
FROM planillaemitida pe, clienteempresa ce WHERE pe.idclienteempresa=ce.idclienteempresa AND pe.idempresa = '$idempresa' AND pe.no_planilla ='$planilla' ";
    $carac = dibujarTablaOfSQLNormal($sqlCar, "Creditos");
    $html .= $carac['resultado'];


    $html .= "</table>";
   // $html .= "</td>";
  //  $html .= "</tr>";

    $html .= "</body>";
    $html .= "</html>";
    if($return == true)
    {
        return $html;
    }
    else
    {
        echo $html;
    }

}
function planillareemitidaHTML($idempresa,$planilla, $return)
{
    $sql2 = "SELECT
 nombre,mes_planillla
FROM
  empresas
WHERE
  idempresa = '$idempresa'";
    $idalmacenA =  findBySqlReturnCampoUnique($sql2, true, true, 'nombre');
    $empresa1 = $idalmacenA['resultado'];
      $empresa=strtoupper($empresa1);

       $idalmacenA1 =  findBySqlReturnCampoUnique($sql2, true, true, 'mes_planillla');
    $mesplanilla = $idalmacenA1['resultado'];
     $idsCAr = split("/", $mesplanilla);
$mesplani=$idsCAr[0];
$anioplani=$idsCAr[1];
if($mesplani == "01") {
 $mes="ENERO";
 $mesred="Ene";

 }
if($mesplani == "02") {
 $mes="FEBRERO";
 $mesred="Feb";
 }
if($mesplani == "03") {
 $mes="MARZO";
 $mesred="Mar";
 }
if($mesplani == "04") {
 $mes="ABRIL";}
if($mesplani == "05") {
 $mes="MAYO";}
if($mesplani == "06") {
 $mes="JUNIO";}
if($mesplani == "07") {
 $mes="JULIO";}
if($mesplani == "08") {
 $mes="AGOSTO";}
if($mesplani == "09") {
 $mes="SEPTIEMBRE";}
if($mesplani == "10") {
 $mes="OCTUBRE";}
if($mesplani == "11") {
 $mes="NOVIEMBRE";}
if($mesplani == "12") {
 $mes="DICIEMBRE";}
    //    echo $idalmacen;
 $sql3 = "SELECT
 tiporegistro
FROM
  movimientoplanilla
WHERE
  idempresa = '$idempresa' AND no_planilla ='$planilla' AND detalle ='reemision' AND emitido='1'";
    $idalmacenA =  findBySqlReturnCampoUnique($sql3, true, true, 'tiporegistro');
    $tipo = $idalmacenA['resultado'];
   // echo $sql3;
    $sql2 = "SELECT
 fechaemitida
FROM
  planillaemitida
WHERE
  idempresa = '$idempresa' AND no_planilla ='$planilla' ";
    $idalmacenA =  findBySqlReturnCampoUnique($sql2, true, true, 'fechaemitida');
    $fecha1 = $idalmacenA['resultado'];
$fecha2= split("-", $fecha1);
$y=$fecha2[0];
$m=$fecha2[1];
$d=$fecha2[2];
$fecha=$d."-".$m."-".$y;
    $html = "";
 $html .= "<tr><td colspan='4' align='center'>
    <p>AGENCIA DE CALZADOS<br />
         BALDERRAMA<br />
         Telf. 4-258993  Fax: 4-504183
    </p>
</td></tr>";
    $html .= "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN'>";
    $html .= "<html>";
    $html .= "<body>";
    $html .= "<tr>";
$tipo1="-R";
    $html .= "<table cellpadding='1' cellspacing='0' border='0' style='width:100%' font-size:11px; font-family:Tahoma;'>";
    $html .= "<td style='width:100%;height:100%;text-align:right;font-size:12px;font-family:Tahoma;'>";
    $html .= "$fecha  $tipo1";
    $html .= "</td>";
    $html .= "<tr>";

    //$html .= "<tr style='width:100%height:100px;text-align:center;font-size:15px;font-family:Tahoma;'>";
    $html .= "<td style='width:100%;height:100px;text-align:center;font-size:15px;font-family:Tahoma;'>";
    $html .= "CREDITOS OTORGADOS A ".$empresa." <br>";
    $html .= "CORRESPONDIENTES AL MES DE  $mes  $anioplani";
    $html .= "</td>";
    $html .= "</tr>";
    $html .= "</table>";
   $html .= "</tr>";
    
    //$html .= "<tr>";
    //    $html .= "<td>";
     $mesplanilla = $idalmacenA1['resultado'];
     $idsCAr = split("/", $mesplanilla);
$mesplani=$idsCAr[0];
$anioplani=$idsCAr[1];
 if($mesplani == "01") {
 $mesred="Ene";
 $mes1=$mesred-$anioplani;
$mes2="Feb"-$anioplani;
$mes3="Mar"-$anioplani;
 }
if($mesplani == "02") {
 $mesred="Feb";
$mes1=$mesred."-".$anioplani ;
$mes2="Mar"."-".$anioplani;
$mes3="Abr"."-".$anioplani;
 }
if($mesplani == "03") {
 $mesred="Mar";
$mes1=$mesred."-".$anioplani ;
$mes2="Abr"."-".$anioplani;
$mes3="May"."-".$anioplani;

 }
if($mesplani == "04") {
$mesred="Abr";
$mes1=$mesred."-".$anioplani ;
$mes2="May"."-".$anioplani;
$mes3="Jun"."-".$anioplani;
}
if($mesplani == "05") {
    $mesred="May";
$mes1=$mesred."-".$anioplani ;
$mes2="Jun"."-".$anioplani;
$mes3="Jul"."-".$anioplani;

}
if($mesplani == "06") {
 $mesred="Jun";
$mes1=$mesred."-".$anioplani ;
$mes2="Jul"."-".$anioplani;
$mes3="Agos"."-".$anioplani;

 }
if($mesplani == "07") {
 $mesred="Jul";
$mes1=$mesred."-".$anioplani ;
$mes2="Agos"."-".$anioplani;
$mes3="Sept"."-".$anioplani;
 }
if($mesplani == "08") {
 $mesred="Agos";
$mes1=$mesred."-".$anioplani ;
$mes2="Sept"."-".$anioplani;
$mes3="Oct"."-".$anioplani;

 }
if($mesplani == "09") {
 $mesred="Sept";
$mes1=$mesred."-".$anioplani ;
$mes2="Oct"."-".$anioplani;
$mes3="Nov"."-".$anioplani;

 }
if($mesplani == "10") {
 $mesred="Oct";
$mes1=$mesred."-".$anioplani ;

 }
if($mesplani == "11") {
 $mesred="Nov";
$mes1=$mesred."-".$anioplani ;
$mes2="Dic"."-".$anioplani;
$mes3="Ene"."-".$anioplani;

 }
if($mesplani == "12") {
 $mesred="Dic";
$mes1=$mesred."-".$anioplani ;
$mes2="Ene"."-".$anioplani;
$mes3="Feb"."-".$anioplani;
 }
$sql5 = "SELECT
 vd.boleta
FROM
  ventasdetalle vd, credito c
WHERE
  vd.idventadetalle=c.idventadetalle AND c.idempresa = '$idempresa' AND c.no_planilla ='$planilla'";
    $idalmacenA =  findBySqlReturnCampoUnique($sql5, true, true, 'boleta');
    $tipo = $idalmacenA['resultado'];
  //	$sql2="SELECT i.numero_registro from ingreso i, tipo_ingreso ti where i.id_tipo_ingreso = ti.id_tipo_ingreso and i.fecha_ingreso>='".$_GET['fechaingreso7']."' and i.fecha_ingreso<='".$_GET['fechaingreso8']."' and i.id_tipo_ingreso='10'";
  $res2= consultaDB($sql5);
 // $r2=mysql_fetch_array($res2);
  //$numero = mysql_num_fields($res2);
  //echo $numero;
 // mysql_fetch_array
//echo "$r2[0]";
//$numero="3";
 for ($i = 0; $i <= $numero; $i++) {
 $r2[0];
 
$r2= mysql_fetch_array($res2);
 }
$re2=$r2[0]."-".$r2[1]."-".$r2[2];
//echo $sql5;

$recibo="1";
    //$html .= "<td style='width:400px;height:100px;border-bottom:1px solid #000000;'><img style='height:100px;' src='logo.jpg'>";
   // $html .= "<td style='width:200px;height:100px;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:100%;'>";
   // $html .= "<tr><tr>";
    $html .= "<tr><td align='right' style='font-size:11px; font-family:Tahoma; text-align:center;font-weight:bold;'><td><tr>";
  $sqlCar = "SELECT CONCAT( ce.nombre, '-', ce.apellido ) AS NombreyApellido, ce.item,'$re2' AS NumeroRecibo, ventasmes AS VentaOriginal, pago1 AS '$mes1',pago2 AS '$mes2',(pago3+pago4+pago5+pago6+pago7) AS '$mes3',pe.total AS Total
FROM planillaemitida pe, clienteempresa ce WHERE pe.idclienteempresa=ce.idclienteempresa AND pe.idempresa = '$idempresa' AND pe.no_planilla ='$planilla' ";
    $carac = dibujarTablaOfSQLNormal($sqlCar, "Creditos");
    $html .= $carac['resultado'];
    

    $html .= "</table>";
   // $html .= "</td>";
  //  $html .= "</tr>";
    
    $html .= "</body>";
    $html .= "</html>";
    if($return == true)
    {
        return $html;
    }
    else
    {
        echo $html;
    }

}
function planillaemitidaHTML($idempresa,$planilla, $return)
{
    $sql2 = "SELECT
 nombre,mes_planillla
FROM
  empresas
WHERE
  idempresa = '$idempresa'";
    $idalmacenA =  findBySqlReturnCampoUnique($sql2, true, true, 'nombre');
    $empresa1 = $idalmacenA['resultado'];
      $empresa=strtoupper($empresa1);

       $idalmacenA1 =  findBySqlReturnCampoUnique($sql2, true, true, 'mes_planillla');
    $mesplanilla = $idalmacenA1['resultado'];
     $idsCAr = split("/", $mesplanilla);
$mesplani=$idsCAr[0];
$anioplani=$idsCAr[1];
if($mesplani == "01") {
 $mes="ENERO";
 $mesred="Ene";

 }
if($mesplani == "02") {
 $mes="FEBRERO";
 $mesred="Feb";
 }
if($mesplani == "03") {
 $mes="MARZO";
 $mesred="Mar";
 }
if($mesplani == "04") {
 $mes="ABRIL";}
if($mesplani == "05") {
 $mes="MAYO";}
if($mesplani == "06") {
 $mes="JUNIO";}
if($mesplani == "07") {
 $mes="JULIO";}
if($mesplani == "08") {
 $mes="AGOSTO";}
if($mesplani == "09") {
 $mes="SEPTIEMBRE";}
if($mesplani == "10") {
 $mes="OCTUBRE";}
if($mesplani == "11") {
 $mes="NOVIEMBRE";}
if($mesplani == "12") {
 $mes="DICIEMBRE";}
    //    echo $idalmacen;
 $sql3 = "SELECT
 tiporegistro
FROM
  movimientoplanilla
WHERE
  idempresa = '$idempresa' AND no_planilla ='$planilla' AND detalle ='emision' AND emitido='1'";
    $idalmacenA =  findBySqlReturnCampoUnique($sql3, true, true, 'tiporegistro');
    $tipo = $idalmacenA['resultado'];
   // echo $sql3;
    $sql2 = "SELECT
 fechaemitida
FROM
  planillaemitida
WHERE
  idempresa = '$idempresa' AND no_planilla ='$planilla' ";
    $idalmacenA =  findBySqlReturnCampoUnique($sql2, true, true, 'fechaemitida');
    $fecha1 = $idalmacenA['resultado'];
$fecha2= split("-", $fecha1);
$y=$fecha2[0];
$m=$fecha2[1];
$d=$fecha2[2];
$fecha=$d."-".$m."-".$y;
    $html = "";
 $html .= "<tr><td colspan='4' align='center'>
    <p>AGENCIA DE CALZADOS<br />
         BALDERRAMA<br />
         Telf. 4-258993  Fax: 4-504183
    </p>
</td></tr>";
    $html .= "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN'>";
    $html .= "<html>";
    $html .= "<body>";
    $html .= "<tr>";

    $html .= "<table cellpadding='1' cellspacing='0' border='0' style='width:100%' font-size:11px; font-family:Tahoma;'>";
    $html .= "<td style='width:100%;height:100%;text-align:right;font-size:12px;font-family:Tahoma;'>";
    $html .= "$fecha  $tipo";
    $html .= "</td>";
    $html .= "<tr>";

    //$html .= "<tr style='width:100%height:100px;text-align:center;font-size:15px;font-family:Tahoma;'>";
    $html .= "<td style='width:100%;height:100px;text-align:center;font-size:15px;font-family:Tahoma;'>";
    $html .= "CREDITOS OTORGADOS A ".$empresa." <br>";
    $html .= "CORRESPONDIENTES AL MES DE  $mes  $anioplani";
    $html .= "</td>";
    $html .= "</tr>";
    $html .= "</table>";
   $html .= "</tr>";

    //$html .= "<tr>";
    //    $html .= "<td>";
     $mesplanilla = $idalmacenA1['resultado'];
     $idsCAr = split("/", $mesplanilla);
$mesplani=$idsCAr[0];
$anioplani=$idsCAr[1];
 if($mesplani == "01") {
 $mesred="Ene";
 $mes1=$mesred-$anioplani;
$mes2="Feb"-$anioplani;
$mes3="Mar"-$anioplani;
 }
if($mesplani == "02") {
 $mesred="Feb";
$mes1=$mesred."-".$anioplani ;
$mes2="Mar"."-".$anioplani;
$mes3="Abr"."-".$anioplani;
 }
if($mesplani == "03") {
 $mesred="Mar";
$mes1=$mesred."-".$anioplani ;
$mes2="Abr"."-".$anioplani;
$mes3="May"."-".$anioplani;

 }
if($mesplani == "04") {
$mesred="Abr";
$mes1=$mesred."-".$anioplani ;
$mes2="May"."-".$anioplani;
$mes3="Jun"."-".$anioplani;
}
if($mesplani == "05") {
    $mesred="May";
$mes1=$mesred."-".$anioplani ;
$mes2="Jun"."-".$anioplani;
$mes3="Jul"."-".$anioplani;

}
if($mesplani == "06") {
 $mesred="Jun";
$mes1=$mesred."-".$anioplani ;
$mes2="Jul"."-".$anioplani;
$mes3="Agos"."-".$anioplani;

 }
if($mesplani == "07") {
 $mesred="Jul";
$mes1=$mesred."-".$anioplani ;
$mes2="Agos"."-".$anioplani;
$mes3="Sept"."-".$anioplani;
 }
if($mesplani == "08") {
 $mesred="Agos";
$mes1=$mesred."-".$anioplani ;
$mes2="Sept"."-".$anioplani;
$mes3="Oct"."-".$anioplani;

 }
if($mesplani == "09") {
 $mesred="Sept";
$mes1=$mesred."-".$anioplani ;
$mes2="Oct"."-".$anioplani;
$mes3="Nov"."-".$anioplani;

 }
if($mesplani == "10") {
 $mesred="Oct";
$mes1=$mesred."-".$anioplani ;

 }
if($mesplani == "11") {
 $mesred="Nov";
$mes1=$mesred."-".$anioplani ;
$mes2="Dic"."-".$anioplani;
$mes3="Ene"."-".$anioplani;

 }
if($mesplani == "12") {
 $mesred="Dic";
$mes1=$mesred."-".$anioplani ;
$mes2="Ene"."-".$anioplani;
$mes3="Feb"."-".$anioplani;
 }
$sql5 = "SELECT
 vd.boleta
FROM
  ventasdetalle vd, credito c
WHERE
  vd.idventadetalle=c.idventadetalle AND c.idempresa = '$idempresa' AND c.no_planilla ='$planilla'";
    $idalmacenA =  findBySqlReturnCampoUnique($sql5, true, true, 'boleta');
    $tipo = $idalmacenA['resultado'];
  //	$sql2="SELECT i.numero_registro from ingreso i, tipo_ingreso ti where i.id_tipo_ingreso = ti.id_tipo_ingreso and i.fecha_ingreso>='".$_GET['fechaingreso7']."' and i.fecha_ingreso<='".$_GET['fechaingreso8']."' and i.id_tipo_ingreso='10'";
  $res2= consultaDB($sql5);
 // $r2=mysql_fetch_array($res2);
  //$numero = mysql_num_fields($res2);
  //echo $numero;
 // mysql_fetch_array
//echo "$r2[0]";
//$numero="3";
 for ($i = 0; $i <= $numero; $i++) {
 $r2[0];

$r2= mysql_fetch_array($res2);
 }
$re2=$r2[0]."-".$r2[1]."-".$r2[2];
//echo $sql5;

$recibo="1";
    //$html .= "<td style='width:400px;height:100px;border-bottom:1px solid #000000;'><img style='height:100px;' src='logo.jpg'>";
   // $html .= "<td style='width:200px;height:100px;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:100%;'>";
   // $html .= "<tr><tr>";
    $html .= "<tr><td align='right' style='font-size:11px; font-family:Tahoma; text-align:center;font-weight:bold;'><td><tr>";
  $sqlCar = "SELECT CONCAT( ce.nombre, '-', ce.apellido ) AS NombreyApellido, ce.item,'$re2' AS NumeroRecibo, ventasmes AS VentaOriginal, pago1 AS '$mes1',pago2 AS '$mes2',(pago3+pago4+pago5+pago6+pago7) AS '$mes3',pe.total AS Total
FROM planillaemitida pe, clienteempresa ce WHERE pe.idclienteempresa=ce.idclienteempresa AND pe.idempresa = '$idempresa' AND pe.no_planilla ='$planilla' ";
    $carac = dibujarTablaOfSQLNormal($sqlCar, "Creditos");
    $html .= $carac['resultado'];


    $html .= "</table>";
   // $html .= "</td>";
  //  $html .= "</tr>";

    $html .= "</body>";
    $html .= "</html>";
    if($return == true)
    {
        return $html;
    }
    else
    {
        echo $html;
    }

}

function  reporteComprasTotales($almacenV,$fechainiV,$fechafinV,$return = true)
{
    if($sort != null)
    {
        $order = "ORDER BY $sort ";
        if($dir != null)
        {
            $order .= " $dir ";
        }
    }
    if($fechainiV == "" || $fechainiV == null)
    {
        $fechainiV = date("Y-m-d");
    }
    if($fechafinV == "" || $fechafinV == null)
    {
        $fechafinV = date("Y-m-d");
    }

    $dev['totalCount'] = 0;
    $dev['mensaje'] = "";
    $dev['error']   = "";
    $dev['resultado'] = "";

    $select = " comp.fecha,
  comp.idcompra,
  comp.montoapagar Neto,
  itm.cantidad,
  itm.precio,
  prod.nombre as producto ";
    $from = " `compra` comp,
  `items` itm,
  `productos` prod ";
    $where = " itm.idcompra = comp.idcompra AND
  prod.idproducto = itm.idproducto ";



    if($fechainiV != null && $fechainiV != "")
    {
        $where .= " AND comp.fecha >= '$fechainiV'";
    }

    if($fechafinV != null && $fechafinV != "")
    {
        $where .= " AND comp.fecha <= '$fechafinV'";
    }

    $sql = "SELECT ".$select." FROM ".$from. " WHERE ".$where." ".$order;
    //    MostrarConsulta($sql);
    $html = "";
    $html .= "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN'>";
    $html .= "<html>";
    $html .= "<head>";
    $html .= "<title></title>";
    $html .= "<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>";
    $html .= "<link href='".$_SESSION["ruta"]."css/print.css' rel='stylesheet' type='text/css' media='all'>";
    //$html .= "<link href='../print.css' rel='stylesheet' type='text/css' media='all'>";
    $html .= "</head>";
    $html .= "<body>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
    $html .= "<tr>";
    //$html .= "<td style='width:400px;height:100px;border-bottom:1px solid #000000;'><img style='height:100px;' src='logo.jpg'>";
    $html .= "</td>";
    $html .= "<td style='width:150px;height:100px;border-bottom:1px solid #000000;text-align:center;font-size:20px;font-family:Tahoma;'>";
    $html .= "REPORTE TOTAL <br>DE<br> COMPRAS";
    $html .= "</td>";
    $html .= "<td style='width:200px;height:100px;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:200px;'>";
    //    $html .= "<tr><td align='right'><img src='".$_SESSION["ruta"]."php/dao/impl/codigo.jpg'><td><tr>";
    $html .= "<tr><td align='right' style='font-size:11px; font-family:Tahoma; text-align:center;font-weight:bold;'>".$ven[0]['idventa']."<td><tr>";
    $html .= "</table>";
    $html .= "</td>";
    $html .= "</tr>";

    $html .= "<tr>";
    $html .= "<td colspan='3'>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:100%;font-size:11px;font-weight:0;'>";
    //$html .= "<table border='1' width='100'>";lorg
    $html .= "<tr>";
    $html .= "<th >Factura:</th>";
    $html .= "<th style='text-align:left;border-left: 1px solid #000000;'>$tfacturaV</th>";
    $html .= "</tr>";
    $html .= "<tr>";
    $html .= "<th >Almacen:</th>";
    //    if($almacenV != "Todos" && $almacenV != null && $almacenV != "")
    //    {
    //        $sql6= " SELECT nombre,idalmacen FROM almacen WHERE idalmacen= '$almacenV'
    //  ";
    //        $datosa = getTablaToArrayOfSQL($sql6);
    //        $vena = $datosa["resultado"];
    //        //      $almacenV = $vena[0]['nombre'];
    //    }


  /*$sqlid= "SELECT
  alm.nombre
FROM
  almacen alm
WHERE
  alm.idalmacen = '$idalmacenV'";

    $res= findBySqlReturnCampoUnique($sqlid, true,true, "nombre");
    $almacen= $res['resultado'];*/


    $html .= "<th style='text-align:left;border-left: 1px solid #000000;'>$almacenV</th>";
    //    $html .= "<th >Moneda:</th>";
    //    $html .= "<th style='text-align:left;border-left: 1px solid #000000;'>$monedaV</th>";
    $html .= "<th >Fecha Ini:</th>";
    $html .= "<th style='text-align:left;border-left: 1px solid #000000;'>$fechainiV</th>";
    $html .= "</tr>";
    $html .= "<tr>";
    $html .= "<th >Vendedor:</th>";
    //    $vendedorV =$_SESSION['idusuario'];
    //    echo $_SESSION['idusuario'];
    ////    $vendedor1 = $_SESSION['apellido1'];
    ////    if($vendedorV != "Todos" && $vendedorV != null && $vendedorV != "")
    ////    {
    //    $sql5[]= " SELECT nombre,apellido1,idusuario FROM usuario WHERE idusuario= '$vendedorV'
    //  ";
    //    MostrarConsulta($sql5);
    //$datosb = getTablaToArrayOfSQL($sql5);
    //        $venb = $datosb["resultado"];
    //        $vendedorV = $venb[0]['nombre'];
    //	$vendedor1 = $venb[0]['apellido1'];
    ////	}
    $html .= "<th style='text-align:left;border-left: 1px solid #000000;'>$vendedorV-$vendedor1</th>";
    //    $html .= "<th >Tipo:</th>";
    //    $html .= "<th style='text-align:left;border-left: 1px solid #000000;'>$tipoV</th>";
    $html .= "<th >Fecha Fin</th>";
    $html .= "<th style='text-align:left;border-left: 1px solid #000000;'>$fechafinV</th>";
    $html .= "</tr>";
    $html .= "<tr>";

    $html .= "<th >Cliente</th>";
    //    if($clienteV != "Todos" && $clienteV != null && $clienteV != "")
    //    {
    //        $sql4= " SELECT nombre,idcliente,nit FROM cliente WHERE nit= '$clienteV'
    //  ";
    //        $datosc = getTablaToArrayOfSQL($sql4);
    //        $venc = $datosc["resultado"];
    //        $clienteV = $venc[0]['nombre'];
    //    }
    $html .= "<th style='text-align:left;border-left: 1px solid #000000;'>$clienteV</th>";
    $html .= "</tr>";

    $html .= "</table>";
    $html .= "</td>";
    $html .= "</tr>";
    $html .= "<tr>";
    $html .= "<td colspan='3'>";
    $table = dibujarTablaOfSQL($sql, $tc);
    $html .= $table['resultado'];
    $html .= "</td>";
    $html .= "</tr>";
    $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'><div id='pie'>
    <p>Importadora Asia<br />
         Cochabamba - Bolivia<br />
         Telf. 4555651
    </p>
</div></td></tr>";
    $html .= "</table>";
    $html .= "</body>";
    $html .= "</html>";
    if($return == true)
    {
        return $html;
    }
    else
    {
        echo $html;
    }
}

////////////////////////////////////////////////////

function  reporteComprasTotales1($almacenV,$fechainiV,$fechafinV,$return = true)
{
    if($sort != null)
    {
        $order = "ORDER BY $sort ";
        if($dir != null)
        {
            $order .= " $dir ";
        }
    }
    if($fechainiV == "" || $fechainiV == null)
    {
        $fechainiV = date("Y-m-d");
    }
    if($fechafinV == "" || $fechafinV == null)
    {
        $fechafinV = date("Y-m-d");
    }

    $dev['totalCount'] = 0;
    $dev['mensaje'] = "";
    $dev['error']   = "";
    $dev['resultado'] = "";

    $select = " comp.fecha,
  comp.idcompra,
  comp.montoapagar Neto,
  itm.cantidad,
  itm.precio,
  prod.nombre as producto ";
    $from = " `compra` comp,
  `items` itm,
  `productos` prod ";
    $where = " itm.idcompra = comp.idcompra AND
  prod.idproducto = itm.idproducto ";



    if($fechainiV != null && $fechainiV != "")
    {
        $where .= " AND comp.fecha >= '$fechainiV'";
    }

    if($fechafinV != null && $fechafinV != "")
    {
        $where .= " AND comp.fecha <= '$fechafinV'";
    }

    $sql = "SELECT ".$select." FROM ".$from. " WHERE ".$where." ".$order;
    //    MostrarConsulta($sql);
    $html = "";
    $html .= "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN'>";
    $html .= "<html>";
    $html .= "<head>";
    $html .= "<title></title>";
    $html .= "<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>";
    $html .= "<link href='".$_SESSION["ruta"]."css/print.css' rel='stylesheet' type='text/css' media='all'>";
    //$html .= "<link href='../print.css' rel='stylesheet' type='text/css' media='all'>";
    $html .= "</head>";
    $html .= "<body>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
    $html .= "<tr>";
    //$html .= "<td style='width:400px;height:100px;border-bottom:1px solid #000000;'><img style='height:100px;' src='logo.jpg'>";
    $html .= "</td>";
    $html .= "<td style='width:150px;height:100px;border-bottom:1px solid #000000;text-align:center;font-size:20px;font-family:Tahoma;'>";
    $html .= "REPORTE TOTAL <br>MERMAS";
    $html .= "</td>";
    $html .= "<td style='width:200px;height:100px;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:200px;'>";
    //    $html .= "<tr><td align='right'><img src='".$_SESSION["ruta"]."php/dao/impl/codigo.jpg'><td><tr>";
    $html .= "<tr><td align='right' style='font-size:11px; font-family:Tahoma; text-align:center;font-weight:bold;'>".$ven[0]['idventa']."<td><tr>";
    $html .= "</table>";
    $html .= "</td>";
    $html .= "</tr>";

    $html .= "<tr>";
    $html .= "<td colspan='3'>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:100%;font-size:11px;font-weight:0;'>";
    //$html .= "<table border='1' width='100'>";lorg
    $html .= "<tr>";
    $html .= "<th >Factura:</th>";
    $html .= "<th style='text-align:left;border-left: 1px solid #000000;'>$tfacturaV</th>";
    $html .= "</tr>";
    $html .= "<tr>";
    $html .= "<th >Almacen:</th>";
    //    if($almacenV != "Todos" && $almacenV != null && $almacenV != "")
    //    {
    //        $sql6= " SELECT nombre,idalmacen FROM almacen WHERE idalmacen= '$almacenV'
    //  ";
    //        $datosa = getTablaToArrayOfSQL($sql6);
    //        $vena = $datosa["resultado"];
    //        //      $almacenV = $vena[0]['nombre'];
    //    }


  /*$sqlid= "SELECT
  alm.nombre
FROM
  almacen alm
WHERE
  alm.idalmacen = '$idalmacenV'";

    $res= findBySqlReturnCampoUnique($sqlid, true,true, "nombre");
    $almacen= $res['resultado'];*/


    $html .= "<th style='text-align:left;border-left: 1px solid #000000;'>$almacenV</th>";
    //    $html .= "<th >Moneda:</th>";
    //    $html .= "<th style='text-align:left;border-left: 1px solid #000000;'>$monedaV</th>";
    $html .= "<th >Fecha Ini:</th>";
    $html .= "<th style='text-align:left;border-left: 1px solid #000000;'>$fechainiV</th>";
    $html .= "</tr>";
    $html .= "<tr>";
    $html .= "<th >Vendedor:</th>";
    //    $vendedorV =$_SESSION['idusuario'];
    //    echo $_SESSION['idusuario'];
    ////    $vendedor1 = $_SESSION['apellido1'];
    ////    if($vendedorV != "Todos" && $vendedorV != null && $vendedorV != "")
    ////    {
    //    $sql5[]= " SELECT nombre,apellido1,idusuario FROM usuario WHERE idusuario= '$vendedorV'
    //  ";
    //    MostrarConsulta($sql5);
    //$datosb = getTablaToArrayOfSQL($sql5);
    //        $venb = $datosb["resultado"];
    //        $vendedorV = $venb[0]['nombre'];
    //	$vendedor1 = $venb[0]['apellido1'];
    ////	}
    $html .= "<th style='text-align:left;border-left: 1px solid #000000;'>$vendedorV-$vendedor1</th>";
    //    $html .= "<th >Tipo:</th>";
    //    $html .= "<th style='text-align:left;border-left: 1px solid #000000;'>$tipoV</th>";
    $html .= "<th >Fecha Fin</th>";
    $html .= "<th style='text-align:left;border-left: 1px solid #000000;'>$fechafinV</th>";
    $html .= "</tr>";
    $html .= "<tr>";

    $html .= "<th >Cliente</th>";
    //    if($clienteV != "Todos" && $clienteV != null && $clienteV != "")
    //    {
    //        $sql4= " SELECT nombre,idcliente,nit FROM cliente WHERE nit= '$clienteV'
    //  ";
    //        $datosc = getTablaToArrayOfSQL($sql4);
    //        $venc = $datosc["resultado"];
    //        $clienteV = $venc[0]['nombre'];
    //    }
    $html .= "<th style='text-align:left;border-left: 1px solid #000000;'>$clienteV</th>";
    $html .= "</tr>";

    $html .= "</table>";
    $html .= "</td>";
    $html .= "</tr>";
    $html .= "<tr>";
    $html .= "<td colspan='3'>";
    $table = dibujarTablaOfSQL($sql, $tc);
    $html .= $table['resultado'];
    $html .= "</td>";
    $html .= "</tr>";
    $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'><div id='pie'>
    <p>Importadora Asia<br />
         Cochabamba - Bolivia<br />
         Telf. 4555651
    </p>
</div></td></tr>";
    $html .= "</table>";
    $html .= "</body>";
    $html .= "</html>";
    if($return == true)
    {
        return $html;
    }
    else
    {
        echo $html;
    }
}
///////////////////////////////////////////////////

function  reporteClientesTotales($almacenV,$fechainiV,$fechafinV,$return = true)
{
    if($sort != null)
    {
        $order = "ORDER BY $sort ";
        if($dir != null)
        {
            $order .= " $dir ";
        }
    }
    if($fechainiV == "" || $fechainiV == null)
    {
        $fechainiV = date("Y-m-d");
    }
    if($fechafinV == "" || $fechafinV == null)
    {
        $fechafinV = date("Y-m-d");
    }

    $dev['totalCount'] = 0;
    $dev['mensaje'] = "";
    $dev['error']   = "";
    $dev['resultado'] = "";

    $select = " CONCAT(cli.nombre, ' ', cli.apellido1, ' ', cli.apellido2) AS Cliente,
  ven.idventa,
  ven.fecha,
  ven.montoapagar AS Efectivo,
  itve.cantidad,
  prod.nombre AS producto,
  usr.nombre as atendio ";
    $from = " ventas ven,
  itemventa itve,
  productos prod,
  cliente cli,
  almacenes alm,
  `usuario` usr";
    $where = " cli.idcliente = ven.idcliente AND
  ven.idventa = itve.idventa AND
  itve.idproducto = prod.idproducto AND
  cli.idalmacen = alm.idalmacen AND
  alm.nombre = '$almacenV' AND
  ven.responsable = usr.idusuario ";



    if($fechainiV != null && $fechainiV != "")
    {
        $where .= " AND ven.fecha >= '$fechainiV'";
    }

    if($fechafinV != null && $fechafinV != "")
    {
        $where .= " AND ven.fecha <= '$fechafinV'";
    }

    $sql = "SELECT ".$select." FROM ".$from. " WHERE ".$where." ".$order;
    //        MostrarConsulta($sql);
    $html = "";
    $html .= "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN'>";
    $html .= "<html>";
    $html .= "<head>";
    $html .= "<title></title>";
    $html .= "<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>";
    $html .= "<link href='".$_SESSION["ruta"]."css/print.css' rel='stylesheet' type='text/css' media='all'>";
    //$html .= "<link href='../print.css' rel='stylesheet' type='text/css' media='all'>";
    $html .= "</head>";
    $html .= "<body>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
    $html .= "<tr>";
    //$html .= "<td style='width:400px;height:100px;border-bottom:1px solid #000000;'><img style='height:100px;' src='logo.jpg'>";
    $html .= "</td>";
    $html .= "<td style='width:150px;height:100px;border-bottom:1px solid #000000;text-align:center;font-size:20px;font-family:Tahoma;'>";
    $html .= "REPORTE TOTAL <br>DE<br> COMPRAS";
    $html .= "</td>";
    $html .= "<td style='width:200px;height:100px;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:200px;'>";
    //    $html .= "<tr><td align='right'><img src='".$_SESSION["ruta"]."php/dao/impl/codigo.jpg'><td><tr>";
    $html .= "<tr><td align='right' style='font-size:11px; font-family:Tahoma; text-align:center;font-weight:bold;'>".$ven[0]['idventa']."<td><tr>";
    $html .= "</table>";
    $html .= "</td>";
    $html .= "</tr>";

    $html .= "<tr>";
    $html .= "<td colspan='3'>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:100%;font-size:11px;font-weight:0;'>";
    //$html .= "<table border='1' width='100'>";lorg
    $html .= "<tr>";
    $html .= "<th >Factura:</th>";
    $html .= "<th style='text-align:left;border-left: 1px solid #000000;'>$tfacturaV</th>";
    $html .= "</tr>";
    $html .= "<tr>";
    $html .= "<th >Almacen:</th>";
    //    if($almacenV != "Todos" && $almacenV != null && $almacenV != "")
    //    {
    //        $sql6= " SELECT nombre,idalmacen FROM almacen WHERE idalmacen= '$almacenV'
    //  ";
    //        $datosa = getTablaToArrayOfSQL($sql6);
    //        $vena = $datosa["resultado"];
    //        //      $almacenV = $vena[0]['nombre'];
    //    }


  /*$sqlid= "SELECT
  alm.nombre
FROM
  almacen alm
WHERE
  alm.idalmacen = '$idalmacenV'";

    $res= findBySqlReturnCampoUnique($sqlid, true,true, "nombre");
    $almacen= $res['resultado'];*/


    $html .= "<th style='text-align:left;border-left: 1px solid #000000;'>$almacenV</th>";
    //    $html .= "<th >Moneda:</th>";
    //    $html .= "<th style='text-align:left;border-left: 1px solid #000000;'>$monedaV</th>";
    $html .= "<th >Fecha Ini:</th>";
    $html .= "<th style='text-align:left;border-left: 1px solid #000000;'>$fechainiV</th>";
    $html .= "</tr>";
    $html .= "<tr>";
    $html .= "<th >Vendedor:</th>";
    //    $vendedorV =$_SESSION['idusuario'];
    //    echo $_SESSION['idusuario'];
    ////    $vendedor1 = $_SESSION['apellido1'];
    ////    if($vendedorV != "Todos" && $vendedorV != null && $vendedorV != "")
    ////    {
    //    $sql5[]= " SELECT nombre,apellido1,idusuario FROM usuario WHERE idusuario= '$vendedorV'
    //  ";
    //    MostrarConsulta($sql5);
    //$datosb = getTablaToArrayOfSQL($sql5);
    //        $venb = $datosb["resultado"];
    //        $vendedorV = $venb[0]['nombre'];
    //	$vendedor1 = $venb[0]['apellido1'];
    ////	}
    $html .= "<th style='text-align:left;border-left: 1px solid #000000;'>$vendedorV-$vendedor1</th>";
    //    $html .= "<th >Tipo:</th>";
    //    $html .= "<th style='text-align:left;border-left: 1px solid #000000;'>$tipoV</th>";
    $html .= "<th >Fecha Fin</th>";
    $html .= "<th style='text-align:left;border-left: 1px solid #000000;'>$fechafinV</th>";
    $html .= "</tr>";
    $html .= "<tr>";

    $html .= "<th >Cliente</th>";
    //    if($clienteV != "Todos" && $clienteV != null && $clienteV != "")
    //    {
    //        $sql4= " SELECT nombre,idcliente,nit FROM cliente WHERE nit= '$clienteV'
    //  ";
    //        $datosc = getTablaToArrayOfSQL($sql4);
    //        $venc = $datosc["resultado"];
    //        $clienteV = $venc[0]['nombre'];
    //    }
    $html .= "<th style='text-align:left;border-left: 1px solid #000000;'>$clienteV</th>";
    $html .= "</tr>";

    $html .= "</table>";
    $html .= "</td>";
    $html .= "</tr>";
    $html .= "<tr>";
    $html .= "<td colspan='3'>";
    $table = dibujarTablaOfSQL($sql, $tc);
    $html .= $table['resultado'];
    $html .= "</td>";
    $html .= "</tr>";
    $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'><div id='pie'>
    <p>Importadora Asia<br />
         Cochabamba - Bolivia<br />
         Telf. 4555651
    </p>
</div></td></tr>";
    $html .= "</table>";
    $html .= "</body>";
    $html .= "</html>";
    if($return == true)
    {
        return $html;
    }
    else
    {
        echo $html;
    }
}

/////////////////////
function reporteProducto($idproducto,$idalmacen, $return)
{
    $sqlruta = "
        SELECT
          ima.ruta
        FROM
          `imagenes` ima
        WHERE
          ima.idproducto = '$idproducto'
        ";

    //$idalmacen = $_SESSION['idalmacen'];

    //    echo "el ide es".$idalmacen;
    $res= findBySqlReturnCampoUnique($sqlruta, true,true, "ruta");
    $ruta= $res['resultado'];

    //    echo $ruta;
    $html = "";

    $html .= "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN'>";
    $html .= "<html>";
    $html .= "<head>";
    $html .= "<title></title>";
    $html .= "<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>";
    $html .= "<link href='".$_SESSION["ruta"]."css/print.css' rel='stylesheet' type='text/css' media='all'>";
    //$html .= "<link href='../print.css' rel='stylesheet' type='text/css' media='all'>";
    $html .= "</head>";
    $html .= "<body>";
    $html .= "<table cellpadding='1' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
    //$html .= "<td style='width:400px;height:100px;border-bottom:1px solid #000000;'><img style='height:100px;' src='logo.jpg'>";
    $html .= "</td>";

    $html .= "<td style='width:150px;height:100px;border-bottom:1px solid #000000;text-align:center;font-size:20px;font-family:Tahoma;'>";

    $html .= "REPORTE <br>DE<br> PRODUCTO";
    $html .= "</td>";
    $html .= "<td style='border-bottom:1px solid #000000;'><img src='images/jpg.php?name=../php/".$ruta."&size=100'>";
    $html .= "<td style='width:200px;height:100px;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:200px;'>";
    $html .= "<tr><tr>";
    $html .= "<tr><td align='right' style='font-size:11px; font-family:Tahoma; text-align:center;font-weight:bold;'><td><tr>";


    $html .= "</table>";
    $html .= "</td>";
    $html .= "</tr>";
    $html .= "<tr>";
    $html .= "<td style='width:33%;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $sql = "SELECT p.codigo AS Codigo,  p.nombre AS Nombre, p.detalle AS Descripcion ,
  p.stockminimo AS StockMinimo, k.precio1bs AS PrecioBS, k.precio1sus AS PrecioSUS, c.nombre AS Categoria,
  k.precio2bs AS PrecioMinimo, k.fechamodificacion AS FechaReg, pv.nombre AS Proveedor, p.unidad AS Unidad
FROM productos p, kardexalmacen k, categorias c, proveedores pv
WHERE p.idproveedor = pv.idproveedor AND p.idcategoria = c.idcategoria AND p.idproducto =k.idproducto  AND p.idproducto = '$idproducto' and k.idalmacen = '$idalmacen'";
    //    MostrarConsulta($sql);
    $producto = dibujarTuplaOfSQLNormal($sql, "Informacion del producto");
    $html .= $producto['resultado'];
    $html .= "</td>";
    $html .= "<td style='width:33%;text-align:right;font-size:11px;font-family:Tahoma;' valign='top'>";
    $sqlCar = "SELECT pv.nombre, pv.representante FROM productos p,proveedores pv WHERE  p.idproveedor = pv.idproveedor AND p.idproducto = '$idproducto'";
    $carac = dibujarTablaOfSQLNormal($sqlCar, "Proveedor");
    $html .= $carac['resultado'];
    $html .="<br>";
    $sqlKar = "SELECT k.saldocantidad AS Cantidad, k.costounitario AS Costo, k.fechamodificacion AS Fecha FROM kardexalmacen k WHERE k.idproducto = '$idproducto' and k.idalmacen = '$idalmacen' ";
    //    MostrarConsulta($sqlKar);
    $kardex = dibujarTuplaOfSQLNormal($sqlKar, "Kardex");
    $html .= $kardex['resultado'];
    $html .= "</td>";
    $html .= "<td style='width:33%;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";

    $html .= "</td>";
    $html .= "</tr>";
    $html .= "<tr><td colspan='3'>";
    $sqlInv = "
(SELECT
  a.nombre AS almacen,
  ka.saldocantidad as cantidad,
  a.direccion AS ubicacion,

  ka.precio1bs AS precioBS,
  ka.precio1sus AS precioSUS
FROM
  kardexalmacen ka,
  almacenes a
WHERE
  ka.idalmacen = a.idalmacen AND
  ka.idproducto = '$idproducto')
  UNION
  (
SELECT
  a.nombre AS almacen,
  ka.saldocantidad as cantidad,
  a.direccion AS ubicacion,

  ka.precio1bs AS precioBS,
  ka.precio1sus AS precioSUS
FROM
  kardexalmacen ka,
  almacenes a
WHERE
  a.idalmacen = 'alm-1000' AND
  ka.idproducto = '$idproducto'
  )

";
    $inventario = dibujarTablaOfSQLNormal($sqlInv, "Inventario");
    $html .= $inventario['resultado'];
    $html .= "</td></tr>";

    $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'><div id='pie'>
    <p>Importadora Asia<br />
         Cochabamba - Bolivia<br />
         Telf. 4555651
    </p>
</div></td></tr>";
    $html .= "</table>";
    $html .= "</body>";
    $html .= "</html>";
    if($return == true)
    {
        return $html;
    }
    else
    {
        echo $html;
    }

}

function reporteMarcaProductos($idmarca, $return)
{
    //    $sqlruta = "
    //        SELECT
    //  ma.idmarca,
    //  ma.codigo,
    //  ma.nombre,
    //  ma.imagen,
    //  ca.nombre AS categoria,
    //  pr.nombre AS proveedor
    //FROM
    //  `marcas` ma,
    //  `categorias` ca,
    //  `proveedores` pr
    //WHERE
    //  ma.idproveedor = pr.idproveedor AND
    //  ma.idcategoria = ca.idcategoria
    //  ma.idmarca = $idmarca
    //        ";

    //$idalmacen = $_SESSION['idalmacen'];

    //    echo "el ide es".$idalmacen;
    //    $res= findBySqlReturnCampoUnique($sqlruta, true,true, "ruta");
    //    $ruta= $res['resultado'];

    //    echo $ruta;
    $html = "";

    $html .= "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN'>";
    $html .= "<html>";
    $html .= "<head>";
    $html .= "<title></title>";
    $html .= "<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>";
    $html .= "<link href='".$_SESSION["ruta"]."css/print.css' rel='stylesheet' type='text/css' media='all'>";
    //$html .= "<link href='../print.css' rel='stylesheet' type='text/css' media='all'>";
    $html .= "</head>";
    $html .= "<body>";
    $html .= "<table cellpadding='1' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
    //$html .= "<td style='width:400px;height:100px;border-bottom:1px solid #000000;'><img style='height:100px;' src='logo.jpg'>";
    $html .= "</td>";

    $html .= "<td style='width:150px;height:100px;border-bottom:1px solid #000000;text-align:center;font-size:20px;font-family:Tahoma;'>";

    $html .= "REPORTE <br>DE<br> PRODUCTO";
    $html .= "</td>";
    $html .= "<td style='border-bottom:1px solid #000000;'><img src='images/jpg.php?name=../php/".$ruta."&size=100'>";
    $html .= "<td style='width:200px;height:100px;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:200px;'>";
    $html .= "<tr><tr>";
    $html .= "<tr><td align='right' style='font-size:11px; font-family:Tahoma; text-align:center;font-weight:bold;'><td><tr>";


    $html .= "</table>";
    $html .= "</td>";
    $html .= "</tr>";
    $html .= "<tr>";
    $html .= "<td style='width:33%;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $sql=" SELECT
  ma.idmarca,
  ma.codigo,
  ma.nombre,
  ma.imagen,
  ca.nombre AS categoria,
  pr.nombre AS proveedor
FROM
  marcas ma,
  categorias ca,
  proveedores pr
WHERE
  ma.idproveedor = pr.idproveedor AND
  ma.idcategoria = ca.idcategoria AND
  ma.idmarca = '$idmarca'

";
    //    MostrarConsulta($sql);
    $carac1 = dibujarTablaOfSQLNormal($sql, "Informacion Prouctos");
    $html .= $carac1['resultado'];
    $html .= "</td>";
    $html .= "<td style='width:33%;text-align:right;font-size:11px;font-family:Tahoma;' valign='top'>";
    //    $sqlCar = "SELECT pv.nombre, pv.representante FROM productos p,proveedores pv WHERE  p.idproveedor = pv.idproveedor AND p.idproducto = '$idproduct'";
    //    $carac = dibujarTablaOfSQLNormal($sqlCar, "Proveedor");
    //    $html .= $carac['resultado'];
    $html .="<br>";
    //    $sqlKar = "SELECT k.saldocantidad AS Cantidad, k.costounitario AS Costo, k.fechamodificacion AS Fecha FROM kardexalmacen k WHERE k.idproducto = '$idproduct' and k.idalmacen = '$idalmacen' ";
    //    //    MostrarConsulta($sqlKar);
    //    $kardex = dibujarTuplaOfSQLNormal($sqlKar, "Kardex");
    //    $html .= $kardex['resultado'];
    $html .= "</td>";
    $html .= "<td style='width:33%;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";

    $html .= "</td>";
    $html .= "</tr>";
    $html .= "<tr><td colspan='3'>";
    //    $sqlInv = "
    //(SELECT
    //  a.nombre AS almacen,
    //  ka.saldocantidad as cantidad,
    //  a.direccion AS ubicacion,
    //
    //  ka.precio1bs AS precioBS,
    //  ka.precio1sus AS precioSUS
    //FROM
    //  kardexalmacen ka,
    //  almacenes a
    //WHERE
    //  ka.idalmacen = a.idalmacen AND
    //  ka.idproducto = '$idproduct')
    //  UNION
    //  (
    //SELECT
    //  a.nombre AS almacen,
    //  ka.saldocantidad as cantidad,
    //  a.direccion AS ubicacion,
    //
    //  ka.precio1bs AS precioBS,
    //  ka.precio1sus AS precioSUS
    //FROM
    //  kardexalmacen ka,
    //  almacenes a
    //WHERE
    //  a.idalmacen = 'alm-1000' AND
    //  ka.idproducto = '$idproduct'
    //  )
    //
    //";
    //    $inventario = dibujarTablaOfSQLNormal($sqlInv, "Inventario");
    //    $html .= $inventario['resultado'];
    $html .= "</td></tr>";

    $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'><div id='pie'>
    <p>Calzados Balderrama<br />
         Cochabamba - Bolivia<br />

    </p>
</div></td></tr>";
    $html .= "</table>";
    $html .= "</body>";
    $html .= "</html>";
    if($return == true)
    {
        return $html;
    }
    else
    {
        echo $html;
    }

}

function reporteMaterial($idmaterial, $return)
{


    $html = "";

    $html .= "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN'>";
    $html .= "<html>";
    $html .= "<head>";
    $html .= "<title></title>";
    $html .= "<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>";
    $html .= "<link href='".$_SESSION["ruta"]."css/print.css' rel='stylesheet' type='text/css' media='all'>";
    //$html .= "<link href='../print.css' rel='stylesheet' type='text/css' media='all'>";
    $html .= "</head>";
    $html .= "<body>";
    $html .= "<table cellpadding='1' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
    $html .= "<tr>";
    //$html .= "<td style='width:400px;height:100px;border-bottom:1px solid #000000;'><img style='height:100px;' src='logo.jpg'>";
    $html .= "</td>";
    $html .= "<td style='width:150px;height:100px;border-bottom:1px solid #000000;text-align:center;font-size:20px;font-family:Tahoma;'>";
    $html .= "<h2>REPORTE <BR> MATERIAL </h2><br>";
    $html .= "</td>";
    $html .= "<td style='width:200px;height:100px;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";
    //    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:200px;'>";
    //    //$html .= "<tr><td align='right'><img src='".$_SESSION["ruta"]."php/codigo.jpg'><td><tr>";
    //    $html .= "<tr><td align='right' style='font-size:11px; font-family:Tahoma; text-align:center;font-weight:bold;'><td><tr>";
    //    $html .= "</table>";
    //    $html .= "</td>";
    //    $html .= "</tr>";
    $html .= "<tr>";
    //    $html .= "<td>";
    $html .= "</td>";

    $html .= "<td style='width:33%;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $sql = "SELECT idmateria as idmaterial, codigo, nombre, descripcion
FROM `materiales`
where idmateria = '$idmaterial'
";
    $table = dibujarTablaOfSQLNormal($sql, "MATERIALES");
    $html .= $table['resultado'];
    $html .= "</td>";
    $html .= "<td style='width:33%;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";

    $html .= "</td>";
    $html .= "</tr>";
    $html .= "<tr><td colspan='3'>";

    $html .= "</td></tr>";
  /*$html .= "<tr><td colspan='3'>";
    $sqlInv = "SELECT
 mka.fecha,mka.hora,mka.descripcion, p.idproducto AS codigo,p.nombre AS producto,p.estado,mka.entrada,mka.salida,mka.saldo,mka.ingreso,mka.egreso,mka.saldobs
FROM
  almacenes a,
  productos p,
  movimientokardexalmacen mka
WHERE
  mka.idproducto=p.idproducto AND
  mka.idalmacen = a.idalmacen AND
  mka.idalmacen = '$idalmacen' ";
    $inventario = dibujarTablaOfSQLNormal($sqlInv, "Movimientos de Almacen");
    $html .= $inventario['resultado'];
    $html .= "</td></tr>";
    */

    $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'><div id='pie'>
    <p>Calzados Balderrama<br />
         Cochabamba - Bolivia<br />

    </p>
</div></td></tr>";

    $html .= "</table>";
    $html .= "</body>";
    $html .= "</html>";
    if($return == true)
    {
        return $html;
    }
    else
    {
        echo $html;
    }



}


function reporteMuestra($idmuestra, $return)
{
    $sql ="
    SELECT
  mar.pedido
FROM
  marcas mar,
  muestras mue
WHERE
  mar.idmarca = mue.idmarca AND
  mue.idmuestra = '$idmuestra'
    ";
    $res =findBySqlReturnCampoUnique($sql,true,true, "pedido");
    $pedido = $res['resultado'];
    if($pedido == "1")
    {
        $sql1 = "
            SELECT
              mo.codigo,
              mo.material,
              mo.color,
              mo.cantidad,
              mue.preciooficina

            FROM
              modelos mo,
              modelo_muestra mue
            WHERE
              mue.idmuestra = '$idmuestra' AND
              mue.idmodelo = mo.idmodelo
            ";
    }
    else
    {
        $sql1 ="
                SELECT
                  mo.codigo,
                  mo.cantidad,
                  mo.coleccion,
                  mue.preciooficina,
                  mo.stylename
                FROM
                  modelos mo,
                  modelo_muestra mue
                WHERE
                  mue.idmuestra = '$idmuestra' AND
                  mue.idmodelo = mo.idmodelo
                ";
    }

    $html = "";

    $html .= "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN'>";
    $html .= "<html>";
    $html .= "<head>";
    $html .= "<title></title>";
    $html .= "<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>";
    $html .= "<link href='".$_SESSION["ruta"]."css/print.css' rel='stylesheet' type='text/css' media='all'>";
    //$html .= "<link href='../print.css' rel='stylesheet' type='text/css' media='all'>";
    $html .= "</head>";
    $html .= "<body>";
    $html .= "<table cellpadding='1' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
    $html .= "<tr>";
    $html .= "<td style='width:400px;height:100px;border-bottom:1px solid #000000;'><img style='height:100px;' src='logo.jpg'>";
    $html .="</tr>";
    $html .= "</td>";
    $html .= "<td style='width:150px;height:100px;border-bottom:1px solid #000000;text-align:center;font-size:20px;font-family:Tahoma;'>";
    $html .= "<h2>REPORTE <BR> MUESTRA </h2><br>";
    $html .= "</td>";
    $html .= "<td style='width:200px;height:100px;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";
    //    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:200px;'>";
    //        $html .= "<tr><td align='right'><img src='".$_SESSION["ruta"]."php/codigo.jpg'><td><tr>";
    //    $html .= "<tr><td align='right' style='font-size:11px; font-family:Tahoma; text-align:center;font-weight:bold;'><td><tr>";
    //    $html .= "</table>";
    //    $html .= "</td>";
    //    $html .= "</tr>";
    $html .= "<tr>";
    //    $html .= "<td>";
    $html .= "</td>";

    $html .= "<td style='width:33%;text-align:right;font-size:11px;font-family:Tahoma;'>";
    //    $sql = "SELECT idmateria as idmaterial, codigo, nombre, descripcion
    //FROM `materiales`
    //where idmateria = '$idmaterial'
    //";
    $table = dibujarTablaOfSQLNormal($sql1, "MUESTRAS");
    $html .= $table['resultado'];
    $html .= "</td>";
    $html .= "<td style='width:33%;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";

    $html .= "</td>";
    $html .= "</tr>";
    $html .= "<tr><td colspan='3'>";

    $html .= "</td></tr>";
  /*$html .= "<tr><td colspan='3'>";
    $sqlInv = "SELECT
 mka.fecha,mka.hora,mka.descripcion, p.idproducto AS codigo,p.nombre AS producto,p.estado,mka.entrada,mka.salida,mka.saldo,mka.ingreso,mka.egreso,mka.saldobs
FROM
  almacenes a,
  productos p,
  movimientokardexalmacen mka
WHERE
  mka.idproducto=p.idproducto AND
  mka.idalmacen = a.idalmacen AND
  mka.idalmacen = '$idalmacen' ";
    $inventario = dibujarTablaOfSQLNormal($sqlInv, "Movimientos de Almacen");
    $html .= $inventario['resultado'];
    $html .= "</td></tr>";
    */

    $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'><div id='pie'>
    <p>Calzados Balderrama<br />
         Cochabamba - Bolivia<br />

    </p>
</div></td></tr>";

    $html .= "</table>";
    $html .= "</body>";
    $html .= "</html>";
    if($return == true)
    {
        return $html;
    }
    else
    {
        echo $html;
    }



}




function reporteColeccion($idcoleccion, $return)
{


    $html = "";

    $html .= "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN'>";
    $html .= "<html>";
    $html .= "<head>";
    $html .= "<title></title>";
    $html .= "<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>";
    $html .= "<link href='".$_SESSION["ruta"]."css/print.css' rel='stylesheet' type='text/css' media='all'>";
    //$html .= "<link href='../print.css' rel='stylesheet' type='text/css' media='all'>";
    $html .= "</head>";
    $html .= "<body>";
    $html .= "<table cellpadding='1' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
    $html .= "<tr>";
    //$html .= "<td style='width:400px;height:100px;border-bottom:1px solid #000000;'><img style='height:100px;' src='logo.jpg'>";
    $html .= "</td>";
    $html .= "<td style='width:150px;height:100px;border-bottom:1px solid #000000;text-align:center;font-size:20px;font-family:Tahoma;'>";
    $html .= "<h2>REPORTE <BR> COLECCION </h2><br>";
    $html .= "</td>";
    $html .= "<td style='width:200px;height:100px;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";
    //    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:200px;'>";
    //    //$html .= "<tr><td align='right'><img src='".$_SESSION["ruta"]."php/codigo.jpg'><td><tr>";
    //    $html .= "<tr><td align='right' style='font-size:11px; font-family:Tahoma; text-align:center;font-weight:bold;'><td><tr>";
    //    $html .= "</table>";
    //    $html .= "</td>";
    //    $html .= "</tr>";
    $html .= "<tr>";
    //    $html .= "<td>";
    $html .= "</td>";

    $html .= "<td style='width:33%;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $sql = "SELECT
  col.anio,
  col.colecion,
  col.codigo
FROM
  coleccion col
WHERE
  col.idcoleccion = '$idcoleccion'
";
    $table = dibujarTablaOfSQLNormal($sql, "COLECCIONES");
    $html .= $table['resultado'];
    $html .= "</td>";
    $html .= "<td style='width:33%;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";

    $html .= "</td>";
    $html .= "</tr>";
    $html .= "<tr><td colspan='3'>";

    $html .= "</td></tr>";
  /*$html .= "<tr><td colspan='3'>";
    $sqlInv = "SELECT
 mka.fecha,mka.hora,mka.descripcion, p.idproducto AS codigo,p.nombre AS producto,p.estado,mka.entrada,mka.salida,mka.saldo,mka.ingreso,mka.egreso,mka.saldobs
FROM
  almacenes a,
  productos p,
  movimientokardexalmacen mka
WHERE
  mka.idproducto=p.idproducto AND
  mka.idalmacen = a.idalmacen AND
  mka.idalmacen = '$idalmacen' ";
    $inventario = dibujarTablaOfSQLNormal($sqlInv, "Movimientos de Almacen");
    $html .= $inventario['resultado'];
    $html .= "</td></tr>";
    */

    $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'><div id='pie'>
    <p>Calzados Balderrama<br />
         Cochabamba - Bolivia<br />

    </p>
</div></td></tr>";

    $html .= "</table>";
    $html .= "</body>";
    $html .= "</html>";
    if($return == true)
    {
        return $html;
    }
    else
    {
        echo $html;
    }



}

function reporteAlmacen($idalmacen, $return)
{


    $html = "";

    $html .= "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN'>";
    $html .= "<html>";
    $html .= "<head>";
    $html .= "<title></title>";
    $html .= "<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>";
    $html .= "<link href='".$_SESSION["ruta"]."css/print.css' rel='stylesheet' type='text/css' media='all'>";
    //$html .= "<link href='../print.css' rel='stylesheet' type='text/css' media='all'>";
    $html .= "</head>";
    $html .= "<body>";
    $html .= "<table cellpadding='1' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
    $html .= "<tr>";
    //$html .= "<td style='width:400px;height:100px;border-bottom:1px solid #000000;'><img style='height:100px;' src='logo.jpg'>";
    $html .= "</td>";
    $html .= "<td style='width:150px;height:100px;border-bottom:1px solid #000000;text-align:center;font-size:20px;font-family:Tahoma;'>";
    $html .= "<h2>REPORTE <BR> ALMACEN </h2><br>";
    $html .= "</td>";
    $html .= "<td style='width:200px;height:100px;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";
    //    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:200px;'>";
    //    //$html .= "<tr><td align='right'><img src='".$_SESSION["ruta"]."php/codigo.jpg'><td><tr>";
    //    $html .= "<tr><td align='right' style='font-size:11px; font-family:Tahoma; text-align:center;font-weight:bold;'><td><tr>";
    //    $html .= "</table>";
    //    $html .= "</td>";
    //    $html .= "</tr>";
    $html .= "<tr>";
    //    $html .= "<td>";
    $html .= "</td>";

    $html .= "<td style='width:33%;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $sql = "SELECT
  alm.nombre as almacenes,
  CONCAT(usu.nombre,
  usu.apellido1,
  usu.apellido2)as usuarios,

  ciu.nombre as ciudad,
  alm.telefono,
  alm.direccion
FROM
  almacenes alm,
  ciudades ciu,
  usuario usu
WHERE
  alm.idciudad = ciu.idciudad AND
  alm.responsable = usu.idusuario AND
  alm.idalmacen = '$idalmacen'
";
    $table = dibujarTablaOfSQLNormal($sql, "ALMACENES");
    $html .= $table['resultado'];
    $html .= "</td>";
    $html .= "<td style='width:33%;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";

    $html .= "</td>";
    $html .= "</tr>";
    $html .= "<tr><td colspan='3'>";

    $html .= "</td></tr>";
  /*$html .= "<tr><td colspan='3'>";
    $sqlInv = "SELECT
 mka.fecha,mka.hora,mka.descripcion, p.idproducto AS codigo,p.nombre AS producto,p.estado,mka.entrada,mka.salida,mka.saldo,mka.ingreso,mka.egreso,mka.saldobs
FROM
  almacenes a,
  productos p,
  movimientokardexalmacen mka
WHERE
  mka.idproducto=p.idproducto AND
  mka.idalmacen = a.idalmacen AND
  mka.idalmacen = '$idalmacen' ";
    $inventario = dibujarTablaOfSQLNormal($sqlInv, "Movimientos de Almacen");
    $html .= $inventario['resultado'];
    $html .= "</td></tr>";
    */

    $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'><div id='pie'>
    <p>Calzados Balderrama<br />
         Cochabamba - Bolivia<br />

    </p>
</div></td></tr>";

    $html .= "</table>";
    $html .= "</body>";
    $html .= "</html>";
    if($return == true)
    {
        return $html;
    }
    else
    {
        echo $html;
    }



}


function reporteLinea($idlinea, $return)
{


    $html = "";

    $html .= "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN'>";
    $html .= "<html>";
    $html .= "<head>";
    $html .= "<title></title>";
    $html .= "<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>";
    $html .= "<link href='".$_SESSION["ruta"]."css/print.css' rel='stylesheet' type='text/css' media='all'>";
    //$html .= "<link href='../print.css' rel='stylesheet' type='text/css' media='all'>";
    $html .= "</head>";
    $html .= "<body>";
    $html .= "<table cellpadding='1' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
    $html .= "<tr>";
    //$html .= "<td style='width:400px;height:100px;border-bottom:1px solid #000000;'><img style='height:100px;' src='logo.jpg'>";
    $html .= "</td>";
    $html .= "<td style='width:150px;height:100px;border-bottom:1px solid #000000;text-align:center;font-size:20px;font-family:Tahoma;'>";
    $html .= "<h2>REPORTE <BR> LINEA </h2><br>";
    $html .= "</td>";
    $html .= "<td style='width:200px;height:100px;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";
    //    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:200px;'>";
    //    //$html .= "<tr><td align='right'><img src='".$_SESSION["ruta"]."php/codigo.jpg'><td><tr>";
    //    $html .= "<tr><td align='right' style='font-size:11px; font-family:Tahoma; text-align:center;font-weight:bold;'><td><tr>";
    //    $html .= "</table>";
    //    $html .= "</td>";
    //    $html .= "</tr>";
    $html .= "<tr>";
    //    $html .= "<td>";
    $html .= "</td>";

    $html .= "<td style='width:33%;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $sql = "SELECT
  lin.nombre,
  lin.descripcion,
  lin.codigo,
  lin.idlinea
FROM
  `lineas` lin
WHERE
  lin.idlinea = '$idlinea'
";
    $table = dibujarTablaOfSQLNormal($sql, "LINEAS");
    $html .= $table['resultado'];
    $html .= "</td>";
    $html .= "<td style='width:33%;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";

    $html .= "</td>";
    $html .= "</tr>";
    $html .= "<tr><td colspan='3'>";

    $html .= "</td></tr>";
  /*$html .= "<tr><td colspan='3'>";
    $sqlInv = "SELECT
 mka.fecha,mka.hora,mka.descripcion, p.idproducto AS codigo,p.nombre AS producto,p.estado,mka.entrada,mka.salida,mka.saldo,mka.ingreso,mka.egreso,mka.saldobs
FROM
  almacenes a,
  productos p,
  movimientokardexalmacen mka
WHERE
  mka.idproducto=p.idproducto AND
  mka.idalmacen = a.idalmacen AND
  mka.idalmacen = '$idalmacen' ";
    $inventario = dibujarTablaOfSQLNormal($sqlInv, "Movimientos de Almacen");
    $html .= $inventario['resultado'];
    $html .= "</td></tr>";
    */

    $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'><div id='pie'>
    <p>Calzados Balderrama<br />
         Cochabamba - Bolivia<br />

    </p>
</div></td></tr>";

    $html .= "</table>";
    $html .= "</body>";
    $html .= "</html>";
    if($return == true)
    {
        return $html;
    }
    else
    {
        echo $html;
    }



}


function reporteCajero($idusuario,$fechaInicio,$fechaFin, $return)
{
    $html = "";


    $sql = "SELECT
  SUM(ven.montoapagar) AS caja
FROM
  ventas ven,
  usuario usr
WHERE
  ven.cajero = usr.idusuario AND
  ven.fecha BETWEEN '$fechaInicio' AND '$fechaFin' AND
  usr.idusuario = '$idusuario'

";
    //    MostrarConsulta($sql);
    $datos = getTablaToArrayOfSQL($sql);
    if($datos['error'] == "false")
    {
        echo "No existe ventas en esa fecha ...............";
        exit;
    }
    else
    {


        $ven1 = $datos["resultado"];
        $totalMonto = $ven1[0]['caja'];


        $html .= "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN'>";
        $html .= "<html>";
        $html .= "<head>";
        $html .= "<title></title>";
        $html .= "<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>";
        $html .= "<link href='".$_SESSION["ruta"]."css/print.css' rel='stylesheet' type='text/css' media='all'>";
        //$html .= "<link href='../print.css' rel='stylesheet' type='text/css' media='all'>";
        $html .= "</head>";
        $html .= "<body>";
        $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
        $html .= "<tr>";
        //$html .= "<td style='width:400px;height:100px;border-bottom:1px solid #000000;'><img style='height:100px;' src='logo.jpg'>";
        $html .= "</td>";
        $html .= "<td style='width:150px;height:100px;border-bottom:1px solid #000000;text-align:center;font-size:20px;font-family:Tahoma;'>";
        $html .= "REPORTE <br>DE<br> VENTAS";
        $html .= "</td>";
        $html .= "<td style='width:200px;height:100px;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";
        $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:200px;'>";
        //$html .= "<tr><td align='right'><img src='".$_SESSION["ruta"]."php/impl/codigo.jpg'><td><tr>";
        $html .= "<tr><td align='right' style='font-size:11px; font-family:Tahoma; text-align:center;font-weight:bold;'>".$ven1[0]['idventa']."<td><tr>";
        $html .= "</table>";
        $html .= "</td>";
        $html .= "</tr>";
        $html .= "<tr>";
        $html .= "<td colspan='3'>";
        $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
        $html .= "<tr><td style='width:100px;font-size:11px;font-weight:bold;'></td><td style='width:500px;' ></td><td style='width:75px;font-size:11px;font-weight:bold;'></td><td style='width:75px;'></td></tr>";
        $html .= "<tr><td style='font-size:11px;font-weight:bold;</td><td></td><td style='font-size:11px;font-weight:bold;'> </td><td></td></tr>";
        $html .= "<tr><td style='font-size:11px;font-weight:bold;'></td><td></td><td style='font-size:11px;font-weight:bold;'>Fecha:</td><td>".date("Y-m-d")."</td></tr>";
        $html .= "<tr><td style='font-size:11px;font-weight:bold;'></td><td></td><td style='font-size:11px;font-weight:bold;'></td></tr>";
        $html .= "</br>";
        $html .= "</table>";
        $html .= "</br>";
        $html .= "</td>";
        $html .= "</tr>";
        $html .= "<tr>";
        $html .= "<td colspan='3'>";
        $sqlIV = "
SELECT
  concat(usr.nombre,' ',usr.apellido1,' ',usr.apellido2) as cajero,
  ven.fecha,
  ven.idventa,
  prod.nombre as producto,
  ven.montoapagar as ingreso
FROM
  usuario usr,
  ventas ven,
  `itemventa` itv,
  `productos` prod
WHERE
  usr.idusuario = ven.cajero AND
  usr.idusuario = '$idusuario' AND
  ven.fecha BETWEEN '$fechaInicio' AND '$fechaFin' AND
  itv.idventa = ven.idventa AND
  itv.idproducto = prod.idproducto
GROUP BY

  ven.idventa
                  ";
        //         $totalDescuento = $ven[0]['descuento'];
        //        $table = dibujarTablaOfSQL($sqlIV, "productos");
        $table=dibujarTablaOfSQLNormal($sqlIV, "Productos");
        $html .= $table['resultado'];
        $html .= "</td>";
        $html .= "</tr>";
        $html .= "<tr>";
        $html .= "<td colspan='3'>";
        $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
        $html .= "<tr><td style='width:100px;font-size:11px;font-weight:bold;'></td><td style='width:450px;'></td><td style='width:125px;font-size:11px;font-weight:bold;'></td><td style='width:75px;text-align:right;'></td></tr>";
        $html .= "<tr><td style='font-size:11px;font-weight:bold;'></td><td></td><td style='font-size:11px;font-weight:bold;'> </td><td style='width:75px;text-align:right;'></td></tr>";
        //$html .= "<tr><td style='font-size:11px;font-weight:bold;'>Emitido por:</td><td>".$ven[0]['login']."</td><td style='font-size:11px;font-weight:bold;'>Total credito (".$ven[0]['descuento']."):</td><td style='width:75px;text-align:right;'>".$totalCredito."</td></tr>";
        $html .= "</br>";
        $html .= "<tr><td style='font-size:11px;font-weight:bold;'></td><td></td><td style='font-size:11px;font-weight:bold;'>Total Ventas :</td><td style='width:75px;text-align:right;'>".$totalMonto."</td></tr>";
        //        $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'>Foreground SRL</td></tr>";
        $html .= "</table>";
        $html .= "</td>";
        $html .= "</tr>";

        $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'><div id='pie'>
    <p>Importadora Asia<br />
         Cochabamba - Bolivia<br />
         Telf. 4555651
    </p>
</div></td></tr>";
        $html .= "</table>";
        $html .= "</body>";
        $html .= "</html>";
        if($return == true)
        {
            return $html;
        }
        else
        {
            echo $html;
        }
    }
}



function reporteStok( $return)
{
    $html = "";


    $html .= "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN'>";
    $html .= "<html>";
    $html .= "<head>";
    $html .= "<title></title>";
    $html .= "<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>";
    $html .= "<link href='".$_SESSION["ruta"]."css/print.css' rel='stylesheet' type='text/css' media='all'>";
    //$html .= "<link href='../print.css' rel='stylesheet' type='text/css' media='all'>";
    $html .= "</head>";
    $html .= "<body>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
    $html .= "<tr>";
    //$html .= "<td style='width:400px;height:100px;border-bottom:1px solid #000000;'><img style='height:100px;' src='logo.jpg'>";
    $html .= "</td>";
    $html .= "<td style='width:150px;height:100px;border-bottom:1px solid #000000;text-align:center;font-size:20px;font-family:Tahoma;'>";
    $html .= "REPORTE <br>STOCK";
    $html .= "</td>";
    $html .= "<td style='width:200px;height:100px;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:200px;'>";
    //$html .= "<tr><td align='right'><img src='".$_SESSION["ruta"]."php/impl/codigo.jpg'><td><tr>";
    $html .= "<tr><td align='right' style='font-size:11px; font-family:Tahoma; text-align:center;font-weight:bold;'>".$ven[0]['idcompra']."<td><tr>";
    $html .= "</table>";

    $html .= "<tr>";
    $html .= "<td colspan='3'>";

    $html .="<HR>";
    $html .= "</td>";
    $html .= "</tr>";
    $html .= "<tr>";
    $html .= "<td colspan='3'>";
    $sqlCar1 = "SELECT
  prod.codigo,
  prod.nombre AS producto,
  prod.marca,
  cat.nombre as categoria,
  prod.estado,
  (krd.cantidad + kal.cantidad) AS cantidad,
  prov.nombre AS proveedor,
  krd.precio2bs AS precioMenor,
  krd.precio1bs AS precioMayor

FROM
  productos prod,
  proveedores prov,
  kardex krd,
  kardexalmacen kal,
  `categorias` cat
WHERE
  prod.idproducto = krd.idproducto AND
  prod.idproducto = kal.idproducto AND
  prod.idproveedor = prov.idproveedor AND
  prod.idcategoria = cat.idcategoria
GROUP BY
  prod.codigo";
    //AND c.idcompra = '$idcompra'";
    $carac1 = dibujarTablaOfSQLNormal($sqlCar1, "STOCK");
    $html .= $carac1['resultado'];
    $html .="<HR>";
    $html .= "</td>";
    $html .= "</tr>";

    $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'><div id='pie'>
    <p>Importadora Asia<br />
         Cochabamba - Bolivia<br />
         Telf. 4555651
    </p>
    </div></td></tr>";
    $html .= "</table>";
    $html .= "</body>";
    $html .= "</html>";
    if($return == true)
    {
        return $html;
    }
    else
    {
        echo $html;
    }

}


function reporteProductoVendido( $return)
{
    $html = "";


    $html .= "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN'>";
    $html .= "<html>";
    $html .= "<head>";
    $html .= "<title></title>";
    $html .= "<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>";
    $html .= "<link href='".$_SESSION["ruta"]."css/print.css' rel='stylesheet' type='text/css' media='all'>";
    //$html .= "<link href='../print.css' rel='stylesheet' type='text/css' media='all'>";
    $html .= "</head>";
    $html .= "<body>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
    $html .= "<tr>";
    //$html .= "<td style='width:400px;height:100px;border-bottom:1px solid #000000;'><img style='height:100px;' src='logo.jpg'>";
    $html .= "</td>";
    $html .= "<td style='width:150px;height:100px;border-bottom:1px solid #000000;text-align:center;font-size:20px;font-family:Tahoma;'>";
    $html .= "REPORTE <br>PRODUCTO <BR> VENDIDO";
    $html .= "</td>";
    $html .= "<td style='width:200px;height:100px;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:200px;'>";
    //$html .= "<tr><td align='right'><img src='".$_SESSION["ruta"]."php/impl/codigo.jpg'><td><tr>";
    $html .= "<tr><td align='right' style='font-size:11px; font-family:Tahoma; text-align:center;font-weight:bold;'>".$ven[0]['idcompra']."<td><tr>";
    $html .= "</table>";

    $html .= "<tr>";
    $html .= "<td colspan='3'>";

    $html .="<HR>";
    $html .= "</td>";
    $html .= "</tr>";
    $html .= "<tr>";
    $html .= "<td colspan='3'>";
    $sqlCar1 = "SELECT
  COUNT(prod.nombre) AS numero,
  prod.codigo,
  prod.nombre AS producto,
  ven.fecha,
  CONCAT(usr.nombre, ' ', usr.apellido1, ' ', usr.apellido2) AS nombre,
  CONCAT(cli.nombre, ' ', cli.apellido1, ' ', cli.apellido2) AS cliente
FROM
  productos prod,
  ventas ven,
  itemventa itv,
  usuario usr,
  cliente cli
WHERE
  ven.idventa = itv.idventa AND
  itv.idproducto = prod.idproducto AND
  ven.cajero = usr.idusuario AND
  ven.idcliente = cli.idcliente
GROUP BY
  prod.codigo,
  prod.nombre,
  ven.fecha,
  CONCAT(usr.nombre, ' ', usr.apellido1, ' ', usr.apellido2),
  CONCAT(cli.nombre, ' ', cli.apellido1, ' ', cli.apellido2)
ORDER BY
  numero DESC
";
    //AND c.idcompra = '$idcompra'";
    $carac1 = dibujarTablaOfSQLNormal($sqlCar1, "PRODUCTOS VENDIDOS");
    $html .= $carac1['resultado'];
    $html .="<HR>";
    $html .= "</td>";
    $html .= "</tr>";

    $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'><div id='pie'>
    <p>Importadora Asia<br />
         Cochabamba - Bolivia<br />
         Telf. 4555651
    </p>
    </div></td></tr>";
    $html .= "</table>";
    $html .= "</body>";
    $html .= "</html>";
    if($return == true)
    {
        return $html;
    }
    else
    {
        echo $html;
    }

}


function reporteGeneralModelo( $return)
{
    $html = "";


    $html .= "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN'>";
    $html .= "<html>";
    $html .= "<head>";
    $html .= "<title></title>";
    $html .= "<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>";
    $html .= "<link href='".$_SESSION["ruta"]."css/print.css' rel='stylesheet' type='text/css' media='all'>";
    //$html .= "<link href='../print.css' rel='stylesheet' type='text/css' media='all'>";
    $html .= "</head>";
    $html .= "<body>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
    $html .= "<tr>";
    //$html .= "<td style='width:400px;height:100px;border-bottom:1px solid #000000;'><img style='height:100px;' src='logo.jpg'>";
    $html .= "</td>";
    $html .= "<td style='width:150px;height:100px;border-bottom:1px solid #000000;text-align:center;font-size:20px;font-family:Tahoma;'>";
    $html .= "REPORTE <br>MODELOS";
    $html .= "<br>";
    $html .= "fecha >";
    $html .= Date("Y-m-d");
    $html .= "</td>";
    $html .= "<td style='width:200px;height:100px;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:200px;'>";
    //$html .= "<tr><td align='right'><img src='".$_SESSION["ruta"]."php/impl/codigo.jpg'><td><tr>";
    $html .= "<tr><td align='right' style='font-size:11px; font-family:Tahoma; text-align:center;font-weight:bold;'>".$ven[0]['idcompra']."<td><tr>";
    $html .= "</table>";

    $html .= "<tr>";
    $html .= "<td colspan='3'>";
    //    $sqlCar = "SELECT c.codigo, c.fecha, c.hora, c.montototal, c.descuento
    //                FROM compra c ORDER BY `c`.`idcompra` ASC";
    //    $carac = dibujarTablaOfSQLNormal($sqlCar, "COMPRAS");
    //    $html .= $carac['resultado'];
    $html .="<HR>";
    $html .= "</td>";
    $html .= "</tr>";
    $html .= "<tr>";
    $html .= "<td colspan='3'>";
    $sqlCar1 = "
       SELECT
  md.codigo,
  md.linea,
  md.color,
  md.material,
  md.imagen,
  md.cantidad,
  col.colecion,
  mar.nombre
FROM
  modelos md,
  marcas mar,
  `coleccion` col
WHERE
  md.idmarca = mar.idmarca AND
  md.idcoleccion = col.idcoleccion";
    //AND c.idcompra = '$idcompra'";
    $carac1 = dibujarTablaOfSQLNormal($sqlCar1, "MODELOS");
    $html .= $carac1['resultado'];
    $html .="<HR>";
    $html .= "</td>";
    $html .= "</tr>";

    $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'><div id='pie'>
    <p>Calzados Balderrama<br />
         Cochabamba - Bolivia<br />

    </p>
    </div></td></tr>";
    $html .= "</table>";
    $html .= "</body>";
    $html .= "</html>";
    if($return == true)
    {
        return $html;
    }
    else
    {
        echo $html;
    }

}

function reporteKardex($idproducto,$idalmacen, $return)
{
    $html = "";

    $html .= "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN'>";
    $html .= "<html>";
    $html .= "<head>";
    $html .= "<title></title>";
    $html .= "<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>";
    $html .= "<link href='".$_SESSION["ruta"]."css/print.css' rel='stylesheet' type='text/css' media='all'>";
    //$html .= "<link href='../print.css' rel='stylesheet' type='text/css' media='all'>";
    $html .= "</head>";
    $html .= "<body>";
    $html .= "<table cellpadding='1' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
    //$html .= "<td style='width:400px;height:100px;border-bottom:1px solid #000000;'><img style='height:100px;' src='logo.jpg'>";
    $html .= "</td>";
    $html .= "<td style='width:150px;height:100px;border-bottom:1px solid #000000;text-align:center;font-size:20px;font-family:Tahoma;'>";

    $html .= "REPORTE <br>KARDEX";
    $html .= "</td>";
    //$html .= "<td style='width:400px;height:100px;border-bottom:1px solid #000000;'><img style='height:100px;' src='logo.jpg'>";
    $html .= "<td style='width:200px;height:100px;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:200px;'>";
    $html .= "<tr><tr>";
    $html .= "<tr><td align='right' style='font-size:11px; font-family:Tahoma; text-align:center;font-weight:bold;'><td><tr>";


    $html .= "</table>";
    $html .= "</td>";
    $html .= "</tr>";
    $html .= "<tr>";
    $html .= "<td style='width:33%;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $sql = "SELECT p.codigo AS Codigo, p.codigofrabrica AS CodFab, p.nombre AS Nombre, p.detalle AS Descripcion ,
  p.stockminimo AS StockMinimo, k.precio1bs AS PrecioBS, k.precio1sus AS PrecioSUS, c.nombre AS Categoria,
  k.precio2bs AS PrecioMinimo, k.fechamodificacion AS FechaReg, pv.nombre AS Proveedor, p.unidad AS Unidad
FROM productos p, kardex k, categorias c, proveedores pv
WHERE p.idproveedor = pv.idproveedor AND p.idcategoria = c.idcategoria AND p.idproducto =k.idproducto AND p.idkardex=k.idkardex AND p.idproducto = '$idproducto'";
    $producto = dibujarTuplaOfSQLNormal($sql, "Informacion del producto");
    $html .= $producto['resultado'];
    $html .= "</td>";
    $html .= "<td style='width:33%;text-align:right;font-size:11px;font-family:Tahoma;' valign='top'>";
    $sqlCar = "SELECT pv.nombre, pv.representante FROM productos p,proveedores pv WHERE  p.idproveedor = pv.idproveedor AND p.idproducto = '$idproducto'";
    $carac = dibujarTablaOfSQLNormal($sqlCar, "Proveedor");
    $html .= $carac['resultado'];
    $html .="<br>";
    $sqlKar = "SELECT k.saldocantidad AS Cantidad, k.costounitario AS Costo, k.fechamodificacion AS Fecha FROM kardex k WHERE k.idproducto = '$idproducto'";
    $kardex = dibujarTuplaOfSQLNormal($sqlKar, "Kardex");
    $html .= $kardex['resultado'];
    $html .= "</td>";
    $html .= "<td style='width:33%;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";

    $html .= "</td>";
    $html .= "</tr>";
    $html .= "<tr><td colspan='3'>";
    $sqlid= "SELECT
  alm.idalmacen
FROM
  almacenes alm
WHERE
  alm.idalmacen = '$idalmacen'";

    //    $result = findBySqlReturnCampoUnique($sql1, true, true, "nombre");
    //    $tipocliente = $result['resultado'];

    $res= findBySqlReturnCampoUnique($sqlid, true,true, "idalmacen");
    $almacenid= $res['resultado'];
    //echo $almacenid;
    //    if($tipocliente == "Regular" || $tipocliente == "Exclusivo")
    //    {
    //echo "regular";
    if($almacenid=="alm-1000")
    {
        //echo "es el almacen".$almacenid;
        $sqlInv="
               SELECT
          CONCAT(mok.fecha, mok.hora) AS fecha,
          mok.descripcion,
          mok.entrada,
          mok.salida,
          mok.saldo,
          mok.preciounitario,
          mok.ingreso,
          mok.egreso,
          mok.saldobs as saldo
        FROM
          movimientokardex mok
        WHERE
          mok.idproducto = '$idproducto'
        ";
        $inventario = dibujarTablaOfSQLNormal($sqlInv, "Inventario");
        $html .= $inventario['resultado'];
    }
    else
    {
        // echo "no es el mismo";
        $sqlInv="
               SELECT
          CONCAT(mkal.fecha, mkal.hora) AS fecha,
          mkal.descripcion AS detalle,
          mkal.entrada,
          mkal.salida,
          mkal.saldo,
          mkal.costounitario,
          mkal.ingreso,
          mkal.egreso,
          mkal.saldobs as saldo
        FROM
          movimientokardexalmacen mkal
        WHERE
          mkal.idproducto = '$idproducto'
        ";
        $inventario = dibujarTablaOfSQLNormal($sqlInv, "Inventario");
        $html .= $inventario['resultado'];

    }


    $html .= "</td></tr>";

    $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'><div id='pie'>
    <p>Importadora Asia<br />
         Cochabamba - Bolivia<br />
         Telf. 4555651
    </p>
</div></td></tr>";
    $html .= "</table>";
    $html .= "</body>";
    $html .= "</html>";
    if($return == true)
    {
        return $html;
    }
    else
    {
        echo $html;
    }

}


function reporteVentaDiaria($idalmacen,$return)
{
    $html = "";

    $html .= "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN'>";
    $html .= "<html>";
    $html .= "<head>";
    $html .= "<title></title>";
    $html .= "<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>";
    $html .= "<link href='".$_SESSION["ruta"]."css/print.css' rel='stylesheet' type='text/css' media='all'>";
    //$html .= "<link href='../print.css' rel='stylesheet' type='text/css' media='all'>";
    $html .= "</head>";
    $html .= "<body>";
    $html .= "<table cellpadding='1' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
    $html .= "<tr>";
    //$html .= "<td style='width:400px;height:100px;border-bottom:1px solid #000000;'><img style='height:100px;' src='logo.jpg'>";
    $html .= "</td>";
    $html .= "<td style='width:150px;height:100px;border-bottom:1px solid #000000;text-align:center;font-size:20px;font-family:Tahoma;'>";
    $html .= "REPORTE <br>DE <br>VENTAS DIARIAS  ";
    $html .= "</td>";
    $html .= "<td style='width:200px;height:100px;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";
    //    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:200px;'>";
    //    //$html .= "<tr><td align='right'><img src='".$_SESSION["ruta"]."php/codigo.jpg'><td><tr>";
    //    $html .= "<tr><td align='right' style='font-size:11px; font-family:Tahoma; text-align:center;font-weight:bold;'><td><tr>";
    //    $html .= "</table>";
    //    $html .= "</td>";
    //    $html .= "</tr>";
    $html .= "<tr>";
    //    $html .= "<td>";
    $html .= "</td>";
    // echo $idalmacen;
    $html .= "<td style='width:33%;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $sql = "SELECT a.idalmacen,c.nombre AS comunidad,a.nombre,a.direccion,a.telefono,a.estado,a.tipo
FROM almacenes a, comunidades c
WHERE a.idcomunidad=c.idcomunidad AND a.idalmacen = '$idalmacen'";
    //MostrarConsulta($sql);
    $producto = dibujarTuplaOfSQLNormal($sql, "Informacion del Almacen");
    $html .= $producto['resultado'];
    $html .= "</td>";
    $html .= "<td style='width:33%;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";

    $html .= "</td>";
    $html .= "</tr>";
    $html .= "<tr><td colspan='3'>";

    $sqlid= "SELECT
  alm.idalmacen
FROM
  almacenes alm
WHERE
  alm.idalmacen = '$idalmacen'";

    //    $result = findBySqlReturnCampoUnique($sql1, true, true, "nombre");
    //    $tipocliente = $result['resultado'];

    $res= findBySqlReturnCampoUnique($sqlid, true,true, "idalmacen");
    $almacenid= $res['resultado'];
    //echo $almacenid;
    //echo $idalmacen;

    if($almacenid=="alm-1000")
    {
        $fecha1 = date("Y-m-d");
        //  echo "es el almacen".$almacenid;
        //         echo $fecha1;
        $sqlInv ="
               SELECT
                  prod.codigo,
                  prod.nombre as producto,
                  prod.idproveedor as proveedor,
                  mkd.fecha,
                  mkd.salida,
                  mkd.egreso AS ingreso

                FROM
                  productos prod,
                  movimientokardex mkd
                WHERE
                  mkd.idproducto = prod.idproducto AND
                  mkd.salida NOT LIKE '0' and
                  date(mkd.fecha) BETWEEN '$fecha1' AND '$fecha1'
                        ";
        //        MostrarConsulta($sqlInv);
        $inventario = dibujarTablaOfSQLNormal($sqlInv, "VENTAS");
        $html .= $inventario['resultado'];
    }
    else
    {
        //        echo "no es el mismo";
        $fecha2 = date("Y-m-d");
        $sqlInv="
               SELECT
                  prod.codigo,
                  prod.nombre as producto,
                  prod.idproveedor as proveedor,
                  mkda.fecha,
                  mkda.salida,
                  mkda.egreso AS ingreso

                FROM
                  productos prod,
                  movimientokardexalmacen mkda
                WHERE
                  mkda.idproducto = prod.idproducto AND
                  mkda.salida NOT LIKE '0' and
                  date(mkda.fecha) BETWEEN '$fecha2' AND '$fecha2'
        ";
        $inventario = dibujarTablaOfSQLNormal($sqlInv, "VENTAS");
        $html .= $inventario['resultado'];

    }


    $html .= "</td></tr>";
    $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'><div id='pie'>
    <p>Importadora Asia<br />
         Cochabamba - Bolivia<br />
         Telf. 4555651
    </p>
</div></td></tr>";

    $html .= "</table>";
    $html .= "</body>";
    $html .= "</html>";
    if($return == true)
    {
        return $html;
    }
    else
    {
        echo $html;
    }


}

function generarCompra($idcompra, $return)
{
    //hoooooooooooooooooooooooo
    $html = "";
    $sql = "SELECT
  c.idcompra,
  c.numero,
 c.idproveedor,
 c.fecha,
 c.idmoneda,
 c.montototal,
 c.montoapagar,
 c.observacion,
 c.descuento,
 c.tipo AS tipocompra,
 c.idtipodocumento,
  p.nombre AS nombreproveedor,
 --ciu.idciudad,
ciu.nombre AS ciudad,
 p.representante,
 ic.cantidad,
 ic.preciobs,
 ic.preciosus,
 ic.total

FROM
  compra c, proveedores p, items ic, ciudades ciu
WHERE
  c.idcompra = '$idcompra'

 AND ic.idcompra = c.idcompra
AND c.idproveedor = p.idproveedor";
    $datos = getTablaToArrayOfSQL($sql);
    if($datos['error'] == "false")
    {
        echo "No existe esta compra ...............";
        exit;
    }
    else
    {
        $ven = $datos["resultado"];
        /*aqui modificamos los campos segun la moneda */
        $totalMonto = $ven[0]['montototal'];
        //  $totalCredito = $ven[0]['credito'];
        $totalDescuento = $ven[0]['descuento'];
        $totalNeto = $ven[0]['montoapagar'];
        $tc = $ven[0]['monto'];;

        //        $totalMonto = $totalMonto/$tc;
        //        $totalCredito = $totalCredito/$tc;
        //        $totalDescuento = $totalDescuento/$tc;
        //        $totalNeto = $totalNeto/$tc;
        //funcionnnnnn

        $totalMonto = redondear($totalMonto, $_SESSION['usrDigitos']);
        //$totalCredito = redondear($totalCredito, $_SESSION['usrDigitos']);
        $totalDescuento = redondear($totalDescuento, $_SESSION['usrDigitos']);
        $totalNeto = redondear($totalNeto, $_SESSION['usrDigitos']);

/*aqui modificamos los campos segun la monedad */


        $html .= "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN'>";
        $html .= "<html>";
        $html .= "<head>";
        $html .= "<title></title>";
        $html .= "<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>";
        $html .= "<link href='".$_SESSION["ruta"]."css/print.css' rel='stylesheet' type='text/css' media='all'>";
        //$html .= "<link href='../print.css' rel='stylesheet' type='text/css' media='all'>";
        $html .= "</head>";
        $html .= "<body>";
        $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
        $html .= "<tr>";
        //$html .= "<td style='width:400px;height:100px;border-bottom:1px solid #000000;'><img style='height:100px;' src='logo.jpg'>";
        $html .= "</td>";
        $html .= "<td style='width:150px;height:100px;border-bottom:1px solid #000000;text-align:center;font-size:20px;font-family:Tahoma;'>";
        $html .= "COMPRA<br>DE<br> PRODUCTOS";
        $html .= "</td>";
        $html .= "<td style='width:200px;height:100px;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";
        $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:200px;'>";
        //$html .= "<tr><td align='right'><img src='".$_SESSION["ruta"]."php/impl/codigo.jpg'><td><tr>";
        $html .= "<tr><td align='right' style='font-size:11px; font-family:Tahoma; text-align:center;font-weight:bold;'>".$ven[0]['idcompra']."<td><tr>";
        $html .= "</table>";
        $html .= "</td>";
        $html .= "</tr>";
        $html .= "<tr>";
        $html .= "<td colspan='3'>";
        $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
        $html .= "<tr><td style='width:100px;font-size:11px;font-weight:bold;'></td><td style='width:500px;' ></td><td style='width:75px;font-size:11px;font-weight:bold;'>Numero:</td><td style='width:75px;'>".$ven[0]['numero']."</td></tr>";
        $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Ciudad:</td><td>".$ven[0]['ciudad']."</td><td style='font-size:11px;font-weight:bold;'> ".$ven[0]['abreviacion']."</td><td>".$tc."</td></tr>";
        $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Representante:</td><td>".$ven[0]['representante']."</td><td style='font-size:11px;font-weight:bold;'>Fecha:</td><td>".$ven[0]['fecha']."</td></tr>";
        $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Por lo siguiente...</td><td></td><td style='font-size:11px;font-weight:bold;'></td></tr>";
        $html .= "</table>";
        $html .= "</td>";
        $html .= "</tr>";
        $html .= "<tr>";
        $html .= "<td colspan='3'>";
        $sqlIV = "SELECT p.codigo,  p.nombre,p.detalle,pv.nombre AS proveedor,c.nombre AS categoria ,ic.cantidad, ic.preciobs, ic.cantidad*ic.preciobs AS importe  FROM categorias c,items ic, productos p, proveedores pv WHERE p.idcategoria=c.idcategoria AND p.idproveedor=pv.idproveedor AND ic.idcompra = '$idcompra' AND ic.idproducto = p.idproducto";
        $table = dibujarTablaOfSQL($sqlIV, $tc);
        $html .= $table['resultado'];
        $html .= "</td>";
        $html .= "</tr>";
        $html .= "<tr>";
        $html .= "<td colspan='3'>";
        $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
        $html .= "<tr><td style='width:100px;font-size:11px;font-weight:bold;'>Son:</td><td style='width:450px;'>".convertir_a_letras($totalNeto, $ven[0]['abreviacion'])."</td><td style='width:125px;font-size:11px;font-weight:bold;'>Total Precio :</td><td style='width:75px;text-align:right;'>".$ven[0]['montototal']."</td></tr>";
        $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Observaciones:</td><td>".$ven[0]['observacion']."</td><td style='font-size:11px;font-weight:bold;'>Total Descuento:</td><td style='width:75px;text-align:right;'>".$ven[0]['descuento']."</td></tr>";
        //$html .= "<tr><td style='font-size:11px;font-weight:bold;'>Emitido por:</td><td>".$ven[0]['login']."</td><td style='font-size:11px;font-weight:bold;'>Total credito (".$ven[0]['descuento']."):</td><td style='width:75px;text-align:right;'>".$totalCredito."</td></tr>";
        $html .= "<tr><td style='font-size:11px;font-weight:bold;'></td><td></td><td style='font-size:11px;font-weight:bold;'>Total Compra :</td><td style='width:75px;text-align:right;'>".$ven[0]['montoapagar']."</td></tr>";
        //        $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'>Foreground SRL</td></tr>";
        $html .= "</table>";
        $html .= "</td>";
        $html .= "</tr>";

        $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'><div id='pie'>
    <p>Importadora Asia<br />
         Cochabamba - Bolivia<br />
         Telf. 4555651
    </p>
</div></td></tr>";
        $html .= "</table>";
        $html .= "</body>";
        $html .= "</html>";
        if($return == true)
        {
            return $html;
        }
        else
        {
            echo $html;
        }
    }

}


function reporteEntregaItemsHTML($identregacompra, $return)
{
    //hoooooooooooooooooooooooo
    $html = "";
    $sql = "
SELECT
  com.montoapagar,
  com.numero,
  com.fecha,
  com.montocancelado,
  com.idcompra
FROM
  `compra` com,
  `entregacompra` ecp
WHERE
  com.idcompra = ecp.idcompra AND
  ecp.identregacompra = '$identregacompra'
";


    //    $sql = "SELECT
    //  c.idcompra,
    //  c.numero,
    // c.idproveedor,
    // c.fecha,
    // c.idmoneda,
    // c.montototal,
    // c.montoapagar,
    // c.observacion,
    // c.descuento,
    // c.tipo AS tipocompra,
    // c.idtipodocumento,
    //  p.nombre AS nombreproveedor,
    // ciu.idciudad,
    //ciu.nombre AS ciudad,
    // p.representante,
    // ic.cantidad,
    // ic.preciobs,
    // ic.preciosus,
    // ic.total
    //
    //FROM
    //  compra c, proveedores p, items ic, ciudades ciu
    //WHERE
    //  c.idcompra = '$idcompra'
    //
    // AND ic.idcompra = c.idcompra
    //AND c.idproveedor = p.idproveedor
    //AND p.idciudad = ciu.idciudad";
    $datos = getTablaToArrayOfSQL($sql);
    if($datos['error'] == "false")
    {
        echo "No existe esta compra ...............";
        exit;
    }
    else
    {
        $entrega = $datos["resultado"];
        /*aqui modificamos los campos segun la moneda */
        $totalMonto = $entrega[0]['montototal'];
        //  $totalCredito = $ven[0]['credito'];
        $totalDescuento = $entrega[0]['montocancelado'];
        $totalNeto = $entrega[0]['montoapagar'];

        $deuda = $entrega[0]['montoapagar']-$entrega[0]['montocancelado'];
        //echo $deuda;
        $tc = $entrega[0]['numero'];;

        //        $totalMonto = $totalMonto/$tc;
        //        $totalCredito = $totalCredito/$tc;
        //        $totalDescuento = $totalDescuento/$tc;
        //        $totalNeto = $totalNeto/$tc;
        //funcionnnnnn

        $totalMonto = redondear($totalMonto, $_SESSION['usrDigitos']);
        //$totalCredito = redondear($totalCredito, $_SESSION['usrDigitos']);
        $totalDescuento = redondear($totalDescuento, $_SESSION['usrDigitos']);
        $totalNeto = redondear($totalNeto, $_SESSION['usrDigitos']);

/*aqui modificamos los campos segun la monedad */


        $html .= "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN'>";
        $html .= "<html>";
        $html .= "<head>";
        $html .= "<title></title>";
        $html .= "<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>";
        $html .= "<link href='".$_SESSION["ruta"]."css/print.css' rel='stylesheet' type='text/css' media='all'>";
        //$html .= "<link href='../print.css' rel='stylesheet' type='text/css' media='all'>";
        $html .= "</head>";
        $html .= "<body>";
        $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
        $html .= "<tr>";
        //  $html .= "<td style='width:400px;height:100px;border-bottom:1px solid #000000;'><img style='height:100px;' src='logo.jpg'>";
        $html .= "</td>";
        $html .= "<td style='width:150px;height:100px;border-bottom:1px solid #000000;text-align:center;font-size:20px;font-family:Tahoma;'>";
        $html .= "ENTREGA";
        $html .= "</td>";
        $html .= "<td style='width:200px;height:100px;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";
        $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:200px;'>";
        //$html .= "<tr><td align='right'><img src='".$_SESSION["ruta"]."php/impl/codigo.jpg'><td><tr>";
        $html .= "<tr><td align='right' style='font-size:11px; font-family:Tahoma; text-align:center;font-weight:bold;'>".$entrega[0]['identregacompra']."<td><tr>";
        $html .= "</table>";
        $html .= "</td>";
        $html .= "</tr>";
        $html .= "<tr>";
        $html .= "<td colspan='3'>";
        $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
        $html .= "<tr><td style='width:100px;font-size:11px;font-weight:bold;'></td><td style='width:500px;' ></td><td style='width:75px;font-size:11px;font-weight:bold;'>Numero:</td><td style='width:75px;'>".$entrega[0]['numero']."</td></tr>";
        $html .= "<tr><td style='font-size:11px;font-weight:bold;'>De la compra:</td><td>".$entrega[0]['idcompra']."</td><td style='font-size:11px;font-weight:bold;'> ".$entrega[0]['abreviacion']."</td></tr>";
        $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Monto a Pagar:</td><td>".$entrega[0]['montoapagar']."</td><td style='font-size:11px;font-weight:bold;'>Fecha:</td><td>".$entrega[0]['fecha']."</td></tr>";
        $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Monto Cancelado:</td><td>".$entrega[0]['montocancelado']."</td><td style='font-size:11px;font-weight:bold;'></td></tr>";
        $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Deuda:</td><td>".$deuda."</td><td style='font-size:11px;font-weight:bold;'></td></tr>";
        $html .= "</table>";
        $html .= "</td>";
        $html .= "</tr>";
        $html .= "<tr>";
        $html .= "<td colspan='3'>";
        $sqlIV = "
               SELECT DISTINCT
  prod.codigo,
  prov.nombre as proveedor,
  prod.detalle,
  enit.cantidad,
  enit.preciobs AS precio
FROM
  productos prod,
  proveedores prov,
  entregaitems enit
WHERE
  enit.idproducto = prod.idproducto AND
  prov.idproveedor = prod.idproveedor AND
  enit.identregacompra = '$identregacompra'     ";

        $sql2 = "

        SELECT DISTINCT
          SUM(enit.cantidad) AS cantidad,
          SUM(enit.preciobs) AS precio
        FROM
          entregaitems enit
        WHERE
          enit.identregacompra = '$identregacompra'
            ";
        $result = findBySqlReturnCampoUnique($sql2, true, true, "cantidad");
        $cantidad = $result['resultado'];
        $result = findBySqlReturnCampoUnique($sql2, true, true, "precio");
        $precio = $result['resultado'];

        //echo $cantidad;
        //echo $precio;

        $table = dibujarTablaOfSQL($sqlIV, $tc);
        $html .= $table['resultado'];
        $html .= "</td>";
        $html .= "</tr>";
        $html .= "<tr>";
        $html .= "<td colspan='3'>";
        $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
        $html .= "<tr><td style='width:100px;font-size:11px;font-weight:bold;'>Son:</td><td style='width:450px;'>".convertir_a_letras($totalNeto, $entrega[0]['abreviacion'])."</td><td style='width:125px;font-size:11px;font-weight:bold;'>Total Precio :</td><td style='width:75px;text-align:right;'>".$precio."</td></tr>";
        $html .= "<tr><td style='font-size:11px;font-weight:bold;'></td><td></td><td style='font-size:11px;font-weight:bold;'>Total Descuento:</td><td style='width:75px;text-align:right;'>0</td></tr>";
        $html .= "<tr><td style='font-size:11px;font-weight:bold;'></td><td></td><td style='font-size:11px;font-weight:bold;'>Total Entrega (".$cantidad."):</td><td style='width:75px;text-align:right;'>".$totalCredito."</td></tr>";
        // $html .= "<tr><td style='font-size:11px;font-weight:bold;'></td><td></td><td style='font-size:11px;font-weight:bold;'>Total Compra :</td><td style='width:75px;text-align:right;'>".$entrega[0]['montoapagar']."</td></tr>";
        // $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'>Foreground SRL</td></tr>";
        $html .= "</table>";
        $htmls .= "</td>";
        $html .= "</tr>";

        $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'><div id='pie'>
    <p>Importadora Asia<br />
         Cochabamba - Bolivia<br />
         Telf. 4555651
    </p>
</div></td></tr>";
        $html .= "</table>";
        $html .= "</body>";
        $html .= "</html>";
        if($return == true)
        {
            return $html;
        }
        else
        {
            echo $html;
        }
    }

}




function compraconcuentaHTML($idcompra, $return)
{
    //hoooooooooooooooooooooooo
    $html = "";
    $sql = "SELECT
  c.idcompra,
 c.idproveedor,
 c.fecha,
 c.idmoneda,
 c.montototal,
 c.montoapagar,
 c.observacion,
 c.descuento,
 c.tipo AS tipocompra,
 c.idtipodocumento,
  p.nombre AS nombreproveedor,
 ciu.idciudad,
ciu.nombre AS ciudad,
 p.representante,
 ic.cantidad,
 ic.preciobs,
 ic.preciosus,
 ic.total,
 tpv.saldo,
 cpr.codigo

FROM
  compra c, proveedores p, items ic, ciudades ciu, tipoproveedor tp, cuentaproveedor cpr, transaccionproveedor tpv
WHERE
  c.idcompra = '$idcompra'
  AND p.idtipoproveedor=tp.idtipoproveedor
 AND  p.idproveedor=cpr.idproveedor
  AND cpr.idcuentaproveedor=tpv.idcuentaproveedor
 AND ic.idcompra = c.idcompra
AND c.idproveedor = p.idproveedor
AND p.idciudad = ciu.idciudad";
    $datos = getTablaToArrayOfSQL($sql);
    if($datos['error'] == "false")
    {
        echo "No existe esta compra ...............";
        exit;
    }
    else
    {
        $ven = $datos["resultado"];
        /*aqui modificamos los campos segun la moneda */
        $totalMonto = $ven[0]['montototal'];
        //  $totalCredito = $ven[0]['credito'];
        $totalDescuento = $ven[0]['descuento'];
        $totalNeto = $ven[0]['montoapagar'];
        $tc = $ven[0]['monto'];;

        //        $totalMonto = $totalMonto/$tc;
        //        $totalCredito = $totalCredito/$tc;
        //        $totalDescuento = $totalDescuento/$tc;
        //        $totalNeto = $totalNeto/$tc;
        //funcionnnnnn

        $totalMonto = redondear($totalMonto, $_SESSION['usrDigitos']);
        //$totalCredito = redondear($totalCredito, $_SESSION['usrDigitos']);
        $totalDescuento = redondear($totalDescuento, $_SESSION['usrDigitos']);
        $totalNeto = redondear($totalNeto, $_SESSION['usrDigitos']);

/*aqui modificamos los campos segun la monedad */


        $html .= "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN'>";
        $html .= "<html>";
        $html .= "<head>";
        $html .= "<title></title>";
        $html .= "<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>";
        $html .= "<link href='".$_SESSION["ruta"]."css/print.css' rel='stylesheet' type='text/css' media='all'>";
        //$html .= "<link href='../print.css' rel='stylesheet' type='text/css' media='all'>";
        $html .= "</head>";
        $html .= "<body>";
        $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
        $html .= "<tr>";
        //$html .= "<td style='width:400px;height:100px;border-bottom:1px solid #000000;'><img style='height:100px;' src='logo.jpg'>";
        $html .= "</td>";
        //$html .= "<td style='width:150px;height:100px;border-bottom:1px solid #000000;text-align:center;font-size:20px;font-family:Tahoma;'>";
        $html .= "COMPRA<br>DE<br> PRODUCTOS";
        //$html .= "</td>";
        //$html .= "<td style='width:200px;height:100px;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";
        //$html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:200px;'>";
        //$html .= "<tr><td align='right'><img src='".$_SESSION["ruta"]."php/impl/codigo.jpg'><td><tr>";
        //$html .= "<tr><td align='right' style='font-size:11px; font-family:Tahoma; text-align:center;font-weight:bold;'>".$ven[0]['idcompra']."<td><tr>";
        // $html .= "</table>";
        //$html .= "</td>";
        //$html .= "</tr>";
        //$html .= "<tr>";
        //        $html .= "<td colspan='3'>";
        //        $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
        //        $html .= "<tr><td style='width:100px;font-size:11px;font-weight:bold;'>Proveedor:</td><td style='width:500px;' >".$ven[0]['nombreproveedor']."</td><td style='width:75px;font-size:11px;font-weight:bold;'>Numero:</td><td style='width:75px;'>".$ven[0]['numero']."</td></tr>";
        //        $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Ciudad:</td><td>".$ven[0]['ciudad']."</td><td style='font-size:11px;font-weight:bold;'>T/C (Bs/".$ven[0]['abreviacion'].")</td><td>".$tc."</td></tr>";
        //        $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Representante:</td><td>".$ven[0]['representante']."</td><td style='font-size:11px;font-weight:bold;'>Fecha:</td><td>".$ven[0]['fecha']."</td></tr>";
        //        $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Por lo siguiente...</td><td></td><td style='font-size:11px;font-weight:bold;'>Fecha:</td><td>".$ven[0]['fecha']."</td></tr>";
        //        $html .= "</table>";
        $html .= "</td>";
        $html .= "</tr>";
        $html .= "<tr>";
        $html .= "<td colspan='3'>";
        $sqlIV = "SELECT p.codigo,  p.nombre, ic.cantidad, p.unidad AS unidad, ic.preciobs, ic.cantidad*ic.preciobs AS importe  FROM items ic, productos p WHERE ic.idcompra = '$idcompra' AND ic.idproducto = p.idproducto";
        $table = dibujarTablaOfSQL($sqlIV, $tc);
        $html .= $table['resultado'];
        $html .= "</td>";
        $html .= "</tr>";
        $html .= "<tr>";
        $html .= "<td colspan='3'>";
        $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
        $html .= "<tr><td style='width:100px;font-size:11px;font-weight:bold;'>Son:</td><td style='width:450px;'>".convertir_a_letras($totalNeto, $ven[0]['abreviacion'])."</td><td style='width:125px;font-size:11px;font-weight:bold;'>Total Precio (".$ven[0]['abreviacion']."):</td><td style='width:75px;text-align:right;'>".$totalMonto."</td></tr>";
        $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Observaciones:</td><td>".$ven[0]['observacion']."</td><td style='font-size:11px;font-weight:bold;'>Total Desc (".$ven[0]['descuento']."):</td><td style='width:75px;text-align:right;'>".$totalDescuento."</td></tr>";
        $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Emitido por:</td><td>".$ven[0]['login']."</td><td style='font-size:11px;font-weight:bold;'>Total saldo (".$ven[0]['saldo']."):</td><td style='width:75px;text-align:right;'>".$totalCredito."</td></tr>";
        $html .= "<tr><td style='font-size:11px;font-weight:bold;'></td><td></td><td style='font-size:11px;font-weight:bold;'>Total Compra (".$ven[0]['total']."):</td><td style='width:75px;text-align:right;'></td></tr>";
        //        $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'>Foreground SRL</td></tr>";
        $html .= "</table>";
        $html .= "</td>";
        $html .= "</tr>";

        $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'><div id='pie'>
    <p>Importadora Asia<br />
         Cochabamba - Bolivia<br />
         Telf. 4555651
    </p>
</div></td></tr>";
        $html .= "</table>";
        $html .= "</body>";
        $html .= "</html>";
        if($return == true)
        {
            return $html;
        }
        else
        {
            echo $html;
        }
    }

}

function reporteCompras( $return)
{
    //hoooooooooooooooooooooooo
    $html = "";


    $html .= "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN'>";
    $html .= "<html>";
    $html .= "<head>";
    $html .= "<title></title>";
    $html .= "<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>";
    $html .= "<link href='".$_SESSION["ruta"]."css/print.css' rel='stylesheet' type='text/css' media='all'>";
    //$html .= "<link href='../print.css' rel='stylesheet' type='text/css' media='all'>";
    $html .= "</head>";
    $html .= "<body>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
    $html .= "<tr>";
    //$html .= "<td style='width:400px;height:100px;border-bottom:1px solid #000000;'><img style='height:100px;' src='logo.jpg'>";
    $html .= "</td>";
    $html .= "<td style='width:150px;height:100px;border-bottom:1px solid #000000;text-align:center;font-size:20px;font-family:Tahoma;'>";
    $html .= "REPORTE <br>DE<BR> COMPRAS";
    $html .= "</td>";
    $html .= "<td style='width:200px;height:100px;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:200px;'>";
    //$html .= "<tr><td align='right'><img src='".$_SESSION["ruta"]."php/impl/codigo.jpg'><td><tr>";
    $html .= "<tr><td align='right' style='font-size:11px; font-family:Tahoma; text-align:center;font-weight:bold;'>".$ven[0]['idcompra']."<td><tr>";
    $html .= "</table>";

    $html .= "<tr>";
    $html .= "<td colspan='3'>";
    $sqlCar = "SELECT c.codigo, c.fecha, c.hora, c.montototal, c.descuento
                FROM compra c ORDER BY `c`.`idcompra` ASC";
    $carac = dibujarTablaOfSQLNormal($sqlCar, "COMPRAS");
    $html .= $carac['resultado'];
    $html .="<HR>";
    $html .= "</td>";
    $html .= "</tr>";
    $html .= "<tr>";
    $html .= "<td colspan='3'>";
    $sqlCar1 = "SELECT i.idcompra, i.nombre AS nombre, pp.nombre AS Producto, p.nombre AS Proveedor, ci.nombre AS Ciudad, i.cantidad, i.total, i.preciobs
        FROM compra c, items i, proveedores p, ciudades ci, productos pp
        WHERE c.idproveedor = p.idproveedor
        AND i.idproducto = pp.idproducto
        AND i.idcompra = c.idcompra
        AND p.idciudad = ci.idciudad
        ORDER BY `i`.`idcompra` ASC";
    //AND c.idcompra = '$idcompra'";
    $carac1 = dibujarTablaOfSQLNormal($sqlCar1, "PRODUCTOS");
    $html .= $carac1['resultado'];
    $html .="<HR>";
    $html .= "</td>";
    $html .= "</tr>";

    $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'><div id='pie'>
    <p>Importadora Asia<br />
         Cochabamba - Bolivia<br />
         Telf. 4555651
    </p>
    </div></td></tr>";
    $html .= "</table>";
    $html .= "</body>";
    $html .= "</html>";
    if($return == true)
    {
        return $html;
    }
    else
    {
        echo $html;
    }


}




function reporteEstadodeResultados($return)
{

    $html = "";

    $html .= "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN'>";
    $html .= "<html>";
    $html .= "<head>";
    $html .= "<title></title>";
    $html .= "<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>";
    $html .= "<link href='".$_SESSION["ruta"]."css/print.css' rel='stylesheet' type='text/css' media='all'>";
    //$html .= "<link href='../print.css' rel='stylesheet' type='text/css' media='all'>";
    $html .= "</head>";
    $html .= "<body>";
    $html .= "<table cellpadding='1' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
    $html .= "<tr>";
    $html .= "<td style='width:400px;height:100px;border-bottom:1px solid #000000;'><img style='height:100px;' src='".$_SESSION["ruta"]."php/configuracion/".$_SESSION["empresa"]."/".$producto[0]['link']."'>";
    $html .= "</td>";
    $html .= "<td style='width:150px;height:100px;border-bottom:1px solid #000000;text-align:center;font-size:20px;font-family:Tahoma;'>";
    $html .= "ESTADO <br>DE<br> RESULTADOS";
    $html .= "</td>";
    $html .= "<td style='width:200px;height:100px;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:200px;'>";
    $html .= "<tr><tr>";
    $html .= "<tr><td align='right' style='font-size:11px; font-family:Tahoma; text-align:center;font-weight:bold;'><td><tr>";
    $html .= "</table>";
    $html .= "</td>";
    $html .= "</tr>";
    $html .= "<tr>";
    $html .= "<td>";
    $html .= "</td>";
    $html .= "</tr>";
    $html .= "<tr>";
    $html .= "<td>";
    $html .= "</td>";

    $html .= "<td style='width:33%;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $sql4 = " SELECT SUM( e.montoapagar ) AS VentasNetas
FROM venta e";
    $producto4 = dibujarTuplaOfSQLNormal($sql4, "Ventas Netas");
    $html .= $producto4['resultado'];
    $html .= "</tr>";
    $html .= "<tr>";
    $html .= "<td style='width:33%;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $sql6 = " SELECT SUM(ic.total) AS InventarioInicial
FROM compra c,`items` ic
WHERE ic.idcompra=c.idcompra ";
    $producto6 = dibujarTuplaOfSQLNormal($sql6, "Inventario Inicial en Mercaderia");
    $html .= $producto6['resultado'];
    $html .= "</tr>";

    $html .= "<tr>";
    $html .= "<td style='width:33%;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $sql5 = " SELECT SUM(ic.total) AS Compras
FROM compra c,`items` ic
WHERE ic.idcompra=c.idcompra ";
    $producto5 = dibujarTuplaOfSQLNormal($sql5, "Compras + Fletes");
    $datos5 = getTablaToArrayOfSQL($sql5);
    $ven5 = $datos5["resultado"];
    $comprastotal = $ven5[0]['Compras'];

    $html .= $producto5['resultado'];
    $html .= "</tr>";
    $html .= "<tr>";
    $html .= "<td style='width:33%;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $sql7 = " SELECT SUM( mk.saldobs ) AS inventariofinal
FROM productos p, `movimientokardexalmacen` mk
WHERE p.idproducto = mk.idproducto
AND mk.fecha = (
SELECT MAX( mk.fecha )
FROM `movimientokardexalmacen` mk, productos p
WHERE p.idproducto = mk.idproducto ) ";
    $producto7 = dibujarTuplaOfSQLNormal($sql7, "Inventario Final de Mercaderia");
    $html .= $producto7['resultado'];
    $html .= "</tr>";
    $datos4 = getTablaToArrayOfSQL($sql4);
    $ven4 = $datos4["resultado"];
    $ventasnetas = $ven4[0]['VentasNetas'];

    $datos6 = getTablaToArrayOfSQL($sql6);
    $ven6 = $datos6["resultado"];
    $inventarioinicial = $ven6[0]['InventarioInicial'];
    $datos7 = getTablaToArrayOfSQL($sql7);
    $ven7 = $datos7["resultado"];
    $inventariofinal = $ven7[0]['inventariofinal'];


    $costoventas=($inventarioinicial + $comprastotal)-$inventariofinal;
    $html .= "<tr>";

    $html .= "<td style='text-align:left;'>Costo de Ventas</td>";
    $html .= "<td style='text-align:left;'>$costoventas</td>";
    $html .= "</tr>";

    $html .= "<tr>";
    $utilidadbruta=$ventasnetas- $costoventas;
    $html .= "<td style='text-align:left;'>Utilidad Bruta en Ventas</td>";
    $html .= "<td style='text-align:left;'>$utilidadbruta</td>";
    $html .= "</tr>";

    $html .= "<td style='width:33%;text-align:right;font-size:11px;font-family:Tahoma;'>";

    $sql = " SELECT ce.nombre, SUM( ie.total ) AS total
FROM egreso e, itemegreso ie, cuentaegreso ce
WHERE ie.idegreso = e.idegreso
AND ie.idcuentaegreso = ce.idcuentaegreso
GROUP BY ce.idcuentaegreso";
    $producto = dibujarTablaOfSQLNormal($sql, "GASTOS DE OPERACION");
    $html .= $producto['resultado'];
    $html .= "</td>";
    $html .= "<tr>";
    $html .= "<td style='width:33%;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $sql2 = " SELECT SUM( e.montototal ) AS totalGastos
FROM egreso e
";
    $producto2 = dibujarTuplaOfSQLSimple($sql2);
    $html .= $producto2['resultado'];
    $html .= "</td>";
    $html .= "</tr>";
    $datosc = getTablaToArrayOfSQL($sql2);
    $venc = $datosc["resultado"];
    $totalgastos = $venc[0]['totalGastos'];
    $html .= "<tr>";
    $html .= "<td style='text-align:left;'>Total Gastos de Operacion</td>";
    $html .= "<td style='text-align:left;'>$totalgastos</td>";
    $html .= "</tr>";
    $html .= "<tr>";
    $utilidadoperacion= $utilidadbruta-$totalgastos;
    $html .= "<td style='text-align:left;'>Utilidad de Operacion</td>";
    $html .= "<td style='text-align:left;'>$utilidadoperacion</td>";
    $html .= "</tr>";
    $html .= "</td>";
    $html .= "</tr>";
    $html .= "</table>";
    $html .= "<table>";
    $html .= "<tr>";

    $html .= "<td style='width:33%;text-align:right;font-size:11px;font-family:Tahoma;'>";

    $sql = " SELECT p.codigo, p.nombre, mk.saldo, mk.saldobs, mk.fecha
FROM `productos` p, `movimientokardexalmacen` mk
WHERE p.idproducto = mk.idproducto
AND mk.fecha = (
SELECT MAX( mk.fecha )
FROM `movimientokardexalmacen` mk, `productos` p
WHERE p.idproducto = mk.idproducto ) ";
    $producto = dibujarTablaOfSQLNormal($sql, "DETALLE DE INVENTARIO FINAL");
    $html .= $producto['resultado'];
    $html .= "</td>";
    $html .= "</tr>";
    $html .= "</table>";
    $html .= "</body>";
    $html .= "</html>";
    if($return == true)
    {
        return $html;
    }
    else
    {
        echo $html;
    }

}




function reporteEntregaHTML($idventamayor, $return)
{
 $idtienda = $_SESSION['idtienda'];
     // echo "codigo".$idventadetalle;
    $html = "";
$sql1 = "
      SELECT
ved.idventamayor,ved.boleta,mar.nombre AS marca,ved.idcliente,cli.nombre AS cliente,cre.fecha AS fechaventa,cre.fechamoroso,
 ved.totalprecio,ved.totalcajas,ved.totalpares,ved.observacion
FROM
   `ventamayor` ved,`marcas` mar, clientes cli,creditomayor cre
WHERE
   ved.idalmacen=mar.idmarca AND ved.idcliente=cli.idcliente AND ved.idventamayor=cre.idventamayor AND ved.idventamayor = '$idventamayor' ";


//    $sql1 = " SELECT ved.numero,ved.fecha, ved.observacion,ved.nit,ved.hora,CONCAT( ved.nombrecliente, '-', ved.apellidocliente ) AS cliente,ved.idclienteempresa,ved.tipoventa, ved.cantidad, ved.totalbs AS total, ved.descuento, ved.montocancelado,ved.montoapagar, ved.montocanceladosus
//FROM ventasdetalle ved
//WHERE ved.idventadetalle = '$idventadetalle' "
//    ;
//               // MostrarConsulta($sql1);
    $dato = getTablaToArrayOfSQL($sql1);
    $ven = $dato["resultado"];
     $numrecibo = $ven[0]['boleta'];
     $idclienteempresa=$ven[0]['idcliente'];

$sql2 ="
SELECT cli.idcliente, CONCAT(cli.codigo,'/',ciu.codigo) AS cliente FROM `clientes` cli, `ciudades` ciu
WHERE cli.idciudad = ciu.idciudad AND cli.idcliente= '$idclienteempresa'
";
      
  $idalmacenA =  findBySqlReturnCampoUnique($sql2, true, true, 'cliente');
    $clienteempresa = $idalmacenA['resultado'];

   $html .= "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN'>";
    $html .= "<html>";
    $html .= "<head>";
    $html .= "<title></title>";
    $html .= "<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>";
    $html .= "<link href='".$_SESSION["ruta"]."css/print.css' rel='stylesheet' type='text/css' media='all'>";
    //$html .= "<link href='../print.css' rel='stylesheet' type='text/css' media='all'>";
    $html .= "</head>";
    $html .= "<body>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
    $html .= "<tr>";
    //$html .= "<td style='width:400px;height:100px;border-bottom:1px solid #000000;'><img style='height:100px;' src='logo.jpg'>";
    $html .= "</td>";
    $html .= "<tr><td style='width:100px;font-size:11px;font-weight:bold;'>";
 $html .= "CALZADOS BALDERRAMA CBBA<br>";
  $html .= "Dir. San Martin esq.  Uruguay N 0699<br>";
   $html .= "Tel 4504183  Fax 4128833<br>";
    $html .= "e-mail: calzaba@supernet.com.bo";
$html .= "</td>";
$html .= "<td style='width:100px;font-size:11px;font-weight:bold;'></td>";
//$html .= "<td align:'left'; style='width:10px;height:100px;border-bottom:0px solid #000000;text-align:left;font-size:20px;font-family:Tahoma;'>";
//    $html .= "NOTA   DE ENTREGA";
//   $html .= "</td>";
  $html .= "<td style='width:200px;'>";
  $html .= "NOTA   DE ENTREGA";
   $html .= "</td>";
  $html .= "</tr>";

  $html .= "<td style='width:200px;height:100px;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:200px;'>";
    //$html .= "<tr><td align='right'><img src='".$_SESSION["ruta"]."php/impl/codigo.jpg'><td><tr>";
    $html .= "<tr><td align='right' style='font-size:11px; font-family:Tahoma; text-align:center;font-weight:bold;'>";
    $html .= "<tr>";
    $html .= "<td>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
    $html .= "<tr><td style='width:100px;font-size:11px;font-weight:bold;'></td><td style='width:500px;'></td><td style='width:75px;font-size:11px;font-weight:bold;'>Nro:</td><td style='width:75px;'>".$numrecibo."</td></tr>";
   //$cliente=$ven[0]['cliente'];
//$clienteempresa= $ven1[0]['clienteempresa'];
   if($ven[0]['nit']==NULL || $ven[0]['nit']==''){
   $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Cliente:</td><td>".$clienteempresa."</td><td style='font-size:11px;font-weight:bold;'> ".$ven1[0]['abreviacion']."</td><td>".$tc."</td></tr>";
   }

   $fecha1=$ven[0]['fechaventa'];
   $formatear = explode( '-' , $fecha1);
$fecha = $formatear[2].'-'.$formatear[1].'-' .$formatear[0];
   $html .= "<td></td><td></td><td style='font-size:11px;font-weight:bold;'>Fecha:</td><td>".$fecha."</td></tr>";
$html .= "<td style='font-size:11px;font-weight:bold;'>Por lo siguiente.....</td></tr>";
    $html .= "</table><br>";
    $html .= "</td>";
    $html .= "</tr>";
    $html .= "<tr>";
    $html .= "<td colspan='3'>";
    $sql2 ="
SELECT idventamayordetalle
FROM ventamayordetalle
WHERE idventamayor = '$idventamayor'
";

  $idalmacenA =  findBySqlReturnCampoUnique($sql2, true, true, 'idventamayordetalle');
    $idventamayordetalle = $idalmacenA['resultado'];
 $sqlIV = "
(SELECT
CONCAT(COALESCE(det.color,'C'), ' ', COALESCE(det.material,'M'),' ', COALESCE(det.stylename,'S'),' ',COALESCE(det.linea,'L')) AS detalle,
mo.codigo AS modelo, dtp.preciooficina AS PrecioSus,emp.codigo AS vendedor,
   dtp.cantidad,
    dtp.totalcajas AS Cajas,
  dtp.totalpares AS Pares,
  dtp.precioventa AS TotalSus,emp.codigo AS vendedor

FROM
  `ventamayordetalle` dtp,`empleados` emp,`modelos` mo,kardexalmacen kar,detallepedido det
WHERE
  det.idkardexalmacen = dtp.idkardexalmacen AND dtp.idempleado= emp.idempleado AND dtp.idkardexalmacen=kar.idkardexalmacen AND
kar.idmodelo=mo.idmodelo AND dtp.idempleado=emp.idempleado AND dtp.idventamayor = '$idventamayor')
 

";
   // $inventario = dibujarTablaOfSQLNormal($sqlInv, "Inventario");
    //$html .= $inventario['resultado'];
 
     $sqlV = " SELECT
                                dtpt.talla,
                                dtpt.cantidad
                                FROM
                               `detalleventamayortalla` dtpt
                                WHERE
                                dtpt.idventamayordetalle = '$idventamayordetalle'
                                ";

    //         $totalDescuento = $ven[0]['descuento'];
    $table =
      // MostrarConsulta($sqlIV);
     // dibujarTablaOfSQLNormal

        $table = dibujarTablaOfSQLNormal($sqlIV, "Detalle de Entrega");
    $html .= $table['resultado'];
    $html .= "</td>";
    $html .= "</tr>";
     $html .= "<tr>";
    $html .= "<td colspan='3'>";
     $sqlV = " SELECT
                                dtpt.talla,
                                dtpt.cantidad
                                FROM
                               `detalleventamayortalla` dtpt
                                WHERE
                                dtpt.idventamayordetalle = '$idventamayordetalle'
                                ";
    echo $idventamayor;
 $table1 =
           $table1 = dibujarTablaOfSQL($sqlV, "Tallas");
         //  $table1 =  dibujarTuplaOfSQLNormal($sqlV, $titulo = "ninguno");

    $html .= $table1['resultado'];
    $html .= "</td>";
    $html .= "</tr>";
    $html .= "<tr>";
    $html .= "<td colspan='3'>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'><br>";
  //  $html .= "<td style='width:100px;font-size:11px;font-weight:bold;'>Son:</td><td style='width:450px;'>".convertir_a_letras($ven[0]['total'], $ven[0]['abreviacion'])."</td>";
//    $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Observaciones:</td><td>".$ven[0]['observacion']."</td><td style='font-size:11px;font-weight:bold;'> Descuento:</td><td style='width:75px;text-align:right;'>".$ven1[0]['descuento']."</td></tr>";
    //$html .= "<tr><td style='font-size:11px;font-weight:bold;'>Emitido por:</td><td>".$ven[0]['login']."</td><td style='font-size:11px;font-weight:bold;'>Total credito (".$ven[0]['descuento']."):</td><td style='width:75px;text-align:right;'>".$totalCredito."</td></tr>";
//    $html .= "<tr><td style='font-size:11px;font-weight:bold;'></td><td></td><td style='font-size:11px;font-weight:bold;'>Total Venta :</td><td style='width:75px;text-align:right;'>".$montoapagar."</td></tr>";
    //        $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'>Foreground SRL</td></tr>";
    $html .= "</table>";
    $html .= "</td>";
    $html .= "</tr>";
 $html .= "<tr>";
    $html .= "<td colspan='3'>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
    $html .= "<tr><td style='width:100px;font-size:11px;font-weight:bold;'></td><td style='width:500px;' ></td><td style='width:75px;font-size:11px;font-weight:bold;'>Numero:</td><td style='width:75px;'>".$ven1[0]['numerodocumento']."</td></tr>";
    $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Cantidad:</td><td>".$ven[0]['cantidad']."</td><td style='font-size:11px;font-weight:bold;'> ".$ven1[0]['abreviacion']."</td><td>".$tc."</td></tr>";
    $html .= "<td></td><td style='font-size:11px;font-weight:bold;'>Monto Total Bs:</td><td>".$ven[0]['total']."</td></tr>";
    $html .= "<td></td><td style='font-size:11px;font-weight:bold;'>Descuento:</td><td>".$ven[0]['descuento']."</td></tr>";
    $html .= "<td></td><td style='font-size:11px;font-weight:bold;'>Monto Cancelado Bs:</td><td>".$ven[0]['montocancelado']."</td></tr>";
 $html .= "<tr><td style='width:100px;font-size:15px;font-weight:bold;'>Son:</td><td style='width:450px;'>".convertir_a_letras($totalNeto, $ven[0]['abreviacion'])."</td><td style='font-size:15px;font-weight:bold;'>Total Descuento:</td><td style='width:75px;text-align:right;'>".$ven[0]['descuento']."</td></tr>";
        $html .= "<tr><td style='font-size:15px;font-weight:bold;'>Observaciones:</td><td>".$ven[0]['observacion']."</td><td style='font-size:15px;font-weight:bold;'>Total Venta :</td><td style='font-size:15px;font-weight:bold;text-align:right;'>".$ven[0]['montoapagar']."</td></tr>";

   // $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Por lo siguiente.....</td>";
    $html .= "</table><br>";
    $html .= "</td>";
    $html .= "</tr>";
    $html .= "<tr>";

    $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'><div id='pie'>
    <p>Calzados Balderrama<br />
         Cochabamba - Bolivia<br />

    </p>
</div></td></tr>";
    $html .= "</table>";
    $html .= "</body>";
    $html .= "</html>";
    if($return == true)
    {
        return $html;
    }
    else
    {
        echo $html;
    }

    //    }
}



function reporteEntrega($identrega, $return)
{
    //hoooooooooooooooooooooooo
    $html = "";

    $sql1="SELECT
*
FROM
  ventamayor ent,

WHERE
  ent.idventamayor= '$identrega'
";
    $dato = getTablaToArrayOfSQL($sql1);
    $ven1 = $dato["resultado"];
    if($dato['error'] == "false")
    {
        echo "No existe esta entrega ...............";
        exit;
    }
    $identreg = $ven1[0]['identrega'];
    $html .= "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN'>";
    $html .= "<html>";
    $html .= "<head>";
    $html .= "<title></title>";
    $html .= "<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>";
    $html .= "<link href='".$_SESSION["ruta"]."css/print.css' rel='stylesheet' type='text/css' media='all'>";
    //$html .= "<link href='../print.css' rel='stylesheet' type='text/css' media='all'>";
    $html .= "</head>";
    $html .= "<body>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
    $html .= "<tr>";
    //$html .= "<td style='width:400px;height:100px;border-bottom:1px solid #000000;'><img style='height:100px;' src='logo.jpg'>";
    $html .= "</td>";
    $html .= "<td style='width:150px;height:100px;border-bottom:1px solid #000000;text-align:center;font-size:20px;font-family:Tahoma;'>";
    $html .= "REPORTE <br>ENTREGA";
    $html .= "</td>";
    $html .= "<td style='width:200px;height:100px;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:200px;'>";
    //$html .= "<tr><td align='right'><img src='".$_SESSION["ruta"]."php/impl/codigo.jpg'><td><tr>";
    $html .= "<tr><td align='right' style='font-size:11px; font-family:Tahoma; text-align:center;font-weight:bold;'>".$identreg."<td><tr>";
    $html .= "</table>";

    $html .= "<tr>";
    $html .= "<td colspan='3'>";
    $sqlCar = "SELECT
  ent.idventa AS venta,
  ent.fecha,
  CONCAT(cli.nombre ,' ',
  cli.apellido1,' ',
  cli.apellido2) as cliente,
  ent.montocancelado AS cancelado,
  alm.nombre AS almacen


FROM
  entregas ent,
  almacenes alm,
  cliente cli,
  ventas ven
WHERE
  ent.idalmacen = alm.idalmacen AND
  ent.identrega = '$identrega' AND
  ent.idventa = ven.idventa AND
  ven.idcliente = cli.idcliente
                ";
    $carac = dibujarTablaOfSQLNormal($sqlCar, "ENTREGAS");
    $html .= $carac['resultado'];
    $html .="<HR>";
    $html .= "</td>";
    $html .= "</tr>";
    $html .= "<tr>";
    $html .= "<td colspan='3'>";
    $sqlCar1 = "SELECT
                  prod.nombre,
                  ive.cantidad,
                  ent.fecha,
                  ent.responsable,
                  alm.nombre AS almacen
                FROM
                  productos prod,
                  itementregaventa ive,
                  entregas ent,
                  almacenes alm
                WHERE
                  ent.identrega = '$identrega' AND
                  ent.idventa = ive.idventa AND
                  ive.idproducto = prod.idproducto AND
                  ent.idalmacen = alm.idalmacen
                ";
    //AND c.idcompra = '$idcompra'";
    $carac1 = dibujarTablaOfSQLNormal($sqlCar1, "PRODUCTOS");
    $html .= $carac1['resultado'];
    $html .="<HR>";
    $html .= "</td>";
    $html .= "</tr>";

    $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'><div id='pie'>
    <p>Importadora Asia<br />
         Cochabamba - Bolivia<br />
         Telf. 4555651
    </p>
    </div></td></tr>";
    $html .= "</table>";
    $html .= "</body>";
    $html .= "</html>";
    if($return == true)
    {
        return $html;
    }
    else
    {
        echo $html;
    }


}



function reporteProveedor($idproveedor, $return)
{
    $html = "";

    $html .= "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN'>";
    $html .= "<html>";
    $html .= "<head>";
    $html .= "<title></title>";
    $html .= "<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>";
    $html .= "<link href='".$_SESSION["ruta"]."css/print.css' rel='stylesheet' type='text/css' media='all'>";
    //$html .= "<link href='../print.css' rel='stylesheet' type='text/css' media='all'>";
    $html .= "</head>";
    $html .= "<body>";
    $html .= "<table cellpadding='1' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
    //$html .= "<td style='width:400px;height:100px;border-bottom:1px solid #000000;'><img style='height:100px;' src='logo.jpg'>";
    $html .= "</td>";
    $html .= "<td style='width:150px;height:100px;border-bottom:1px solid #000000;text-align:center;font-size:20px;font-family:Tahoma;'>";

    $html .= "REPORTE <br>DE<br> PROVEEDOR";
    $html .= "</td>";
    //$html .= "<td style='width:400px;height:100px;border-bottom:1px solid #000000;'><img style='height:100px;' src='logo.jpg'>";
    $html .= "<td style='width:200px;height:100px;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:200px;'>";
    $html .= "<tr><tr>";
    $html .= "<tr><td align='right' style='font-size:11px; font-family:Tahoma; text-align:center;font-weight:bold;'><td><tr>";


    $html .= "</table>";
    $html .= "</td>";
    $html .= "</tr>";
    $html .= "<tr>";
    $html .= "<td style='width:33%;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $sql = "SELECT
              prov.codigo,
              prov.nombre,
              prov.telefono,
              prov.representante,
              prov.ciudad,
              prov.pais,
              prov.direccion
            FROM
              proveedores prov
            WHERE
              prov.idproveedor = '$idproveedor'
";
    //    dibujarTablaOfSQLNormal
    $producto = dibujarTablaOfSQLNormal($sql, "Informacion del proveedor");
    $html .= $producto['resultado'];
    $html .= "</td>";
    $html .= "<td style='width:33%;text-align:right;font-size:11px;font-family:Tahoma;' valign='top'>";
    //    $sqlCar = "SELECT pv.nombre, pv.representante FROM productos p,proveedores pv WHERE  p.idproveedor = pv.idproveedor AND p.idproducto = '$idproducto'";
    //    $carac = dibujarTablaOfSQLNormal($sqlCar, "Proveedor");
    //    $html .= $carac['resultado'];
    $html .="<br>";
    //    $sqlKar = "SELECT
    //  tp.fecha,
    //  tp.hora,
    //  tp.deposito,
    //  tp.retiro,
    //  tp.saldo
    //FROM
    //  transaccionproveedor tp,
    //  proveedores pv
    //WHERE
    //  tp.idproveedor = pv.idproveedor AND
    //  tp.idproveedor = '$idproveedor'";
    //    $kardex = dibujarTuplaOfSQLNormal($sqlKar, "Movimiento del proveedor");
    //    $html .= $kardex['resultado'];
    $html .= "</td>";
    $html .= "<td style='width:33%;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";

    $html .= "</td>";
    $html .= "</tr>";

    $html .= "<tr><td colspan='3'>";
    $sqlInv = "
SELECT
  tp.fecha,
  tp.hora,
  tp.deposito,
  tp.retiro,
  tp.saldo
FROM
  transaccionproveedor tp,
  proveedores pv
WHERE
  tp.idproveedor = pv.idproveedor AND
  tp.idproveedor = '$idproveedor'
";
    $inventario = dibujarTablaOfSQLNormal($sqlInv, "Movimiento del proveedor");
    $html .= $inventario['resultado'];
    $html .= "</td></tr>";


    $html .= "<tr><td colspan='3'>";
    $sqlInv = "
SELECT
  prod.nombre,
  prod.codigo,
  prod.codigobarra
FROM
  `productos` prod,
  `proveedores` prov
WHERE
  prov.idproveedor = prod.idproveedor AND
  prov.idproveedor = '$idproveedor'
";
    $inventario = dibujarTablaOfSQLNormal($sqlInv, "Compras del proveedor ");
    $html .= $inventario['resultado'];
    $html .= "</td></tr>";

    $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'><div id='pie'>
    <p>Calzados Balderrama<br />
         Cochabamba - Bolivia<br />

    </p>
</div></td></tr>";
    $html .= "</table>";
    $html .= "</body>";
    $html .= "</html>";
    if($return == true)
    {
        return $html;
    }
    else
    {
        echo $html;
    }


}

function bolatadePago($idempleado,$retuen)
{
    //echo "esta em el metodo";
    $idemp = $idempleado;
    //   $idultimosueldo = findUltimoID("sueldo","numero",true);
    ////    $idultimosueldo = findUltimoID("sueldo", "numero", true);
    //    $numeroSueldo = $idultimosueldo['resultado']+1;
    //    ////    echo $idultimoempleadoA['resultado'];
    //    $fecha = date("Y-m-d");
    //    $usuario = $_SESSION['login'];
    //    $idsueldo = "sue-".$numeroSueldo;
    //
    //    $sql = "
    //SELECT
    //  SUM(ant.monto) AS anticipos,
    //  sue.sueldo
    //FROM
    //  anticipo ant,
    //  empleado sue
    //WHERE
    //
    //  sue.idempleado = '$idempleado'
    //  and ant.idmes = '$val'
    //GROUP BY
    //  sue.sueldo
    //";
    //
    //           // MostrarConsulta($sql);
    //
    //    $entrega = getTablaToArrayOfSQL($sql);
    //
    //    $restante = $entrega[0]['sueldo'] - $entrega[0]['anticipos'];
    //    getSqlNewSueldo($idsueldo, $idemp, $numeroSueldo, $sueldo, $fecha, $usuario, $return);
    reporteBoletaEmpleadoHTML($idemp, $return);
}

function getSqlNewSueldo($idsueldo, $idempleado, $numero, $sueldo, $fecha, $usuario, $return){
    $setC[0]['campo'] = 'idsueldo';
    $setC[0]['dato'] = $idsueldo;
    $setC[1]['campo'] = 'idempleado';
    $setC[1]['dato'] = $idempleado;
    $setC[2]['campo'] = 'numero';
    $setC[2]['dato'] = $numero;
    $setC[3]['campo'] = 'sueldo';
    $setC[3]['dato'] = $sueldo;
    $setC[4]['campo'] = 'fecha';
    $setC[4]['dato'] = $fecha;
    $setC[5]['campo'] = 'usuario';
    $setC[5]['dato'] = $usuario;
    $sql2 = generarInsertValues($setC);
    return "INSERT INTO sueldo ".$sql2;
}

function reporteEmpleadoHTML($idempleado, $return)
{

    $val = Date("m");


    $sql = "
SELECT
  SUM(ant.monto) AS anticipos,
  sue.sueldo
FROM
  anticipo ant,
  empleado sue
WHERE

  sue.idempleado = '$idempleado'
  and ant.idmes = '$val'
GROUP BY
  sue.sueldo
";

    //        MostrarConsulta($sql);

    $datos = getTablaToArrayOfSQL($sql);
    //            echo $datos['error'];
    if($datos['error'] == "false")
    {
        $sql3 = "
SELECT

  sue.sueldo
FROM

  empleado sue
WHERE
  sue.idempleado = '$idempleado'
GROUP BY
  sue.sueldo
";
        //        MostrarConsulta($sql3);
        $datoss = getTablaToArrayOfSQL($sql3);
        $entrega = $datoss["resultado"];
        //                 $totalAnticipos = $entrega[0]['anticipos'];

        $sueldo = $entrega[0]['sueldo'];

        $restante = $entrega[0]['sueldo'] - 0;
        //
        $tc = $entrega[0]['numero'];


        $html = "";
        $fecha = Date("Y-m-d");
        $html .= "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN'>";
        $html .= "<html>";
        $html .= "<head>";
        $html .= "<title></title>";
        $html .= "<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>";
        $html .= "<link href='".$_SESSION["ruta"]."css/print.css' rel='stylesheet' type='text/css' media='all'>";
        //$html .= "<link href='../print.css' rel='stylesheet' type='text/css' media='all'>";
        $html .= "</head>";
        $html .= "<body>";
        $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
        $html .= "<tr>";
        //$html .= "<td style='width:400px;height:100px;border-bottom:1px solid #000000;'><img style='height:100px;' src='logo.jpg'>";
        $html .= "</td>";
        $html .= "<td style='width:150px;height:100px;border-bottom:1px solid #000000;text-align:center;font-size:20px;font-family:Tahoma;'>";
        $html .= "<h2>ANTICIPO <BR> EMPLEADO</h2><br>";
        $html .= "</td>";
        $html .= "<td style='width:200px;height:100px;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";
        $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:200px;'>";
        $html .= "<tr><td align='right'><td><tr>";
        $html .= "<tr><td align='right' style='font-size:11px; font-family:Tahoma; text-align:center;font-weight:bold;'>".$ven[0]['idproforma']."<td><tr>";
        $html .= "</table>";
        $html .= "</td>";
        $html .= "</tr>";
        $html .= "<tr>";
        $html .= "<td colspan='3'>";
        $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
        $html .= "<tr><td style='width:100px;font-size:11px;font-weight:bold;'></td><td style='width:500px;' ></td><td style='width:75px;font-size:11px;font-weight:bold;'></td><td style='width:75px;'></td></tr>";
        $html .= "<tr><td style='font-size:11px;font-weight:bold;'></td><td></td><td style='font-size:11px;font-weight:bold;'></td><td></td></tr>";
        $html .= "<tr><td style='font-size:11px;font-weight:bold;'></td><td></td><td style='font-size:11px;font-weight:bold;'>Fecha:</td><td>$fecha </td></tr>";
        $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Sueldo...</td><td></td><td style='font-size:11px;font-weight:bold;'></td><td></td></tr>";
        $html .= "</table>";
        $html .= "</td>";
        $html .= "</tr>";
        $html .= "<tr>";
        $html .= "<td colspan='3'>";
        $sqlIV = "

SELECT
  emp.nombre,
  emp.apellidos,
  emp.sueldo,
  usr.nombre AS usuario,
  CONCAT(mes.mes, '-', anio.anio) AS gestion
FROM
  empleado emp,

  usuario usr,
  anio,
  gestion_mes ges,
  mes
WHERE

  emp.idempleado = '$idempleado' AND
  anio.idanio = ges.idanio AND
  mes.idmes = ges.idmes and ges.idmes = '$val'
";
        //        MostrarConsulta($sqlIV);
        $table = dibujarTablaOfSQL($sqlIV, $tc);
        $html .= $table['resultado'];
        $html .= "</td>";
        $html .= "</tr>";
        $html .= "<tr>";
        $html .= "<td colspan='3'>";
        $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
        $html .= "<tr><td style='width:100px;font-size:11px;font-weight:bold;'></td><td style='width:450px;'></td><td style='width:125px;font-size:11px;font-weight:bold;'>Total Anticipos ():</td><td style='width:75px;text-align:right;'>0</td></tr>";
        $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Observaciones:</td><td>Proforma Valida Con Sello y Firma.</td><td style='font-size:11px;font-weight:bold;'>Sueldo ():</td><td style='width:75px;text-align:right;'>".$sueldo."</td></tr>";
        $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Emitido por:</td><td>".$_SESSION['login']."</td><td style='font-size:11px;font-weight:bold;'>Saldo a Pagar ():</td><td style='width:75px;text-align:right;'>".$restante."</td></tr>";
        $html .= "<tr><td style='font-size:11px;font-weight:bold;'></td><td></td><td style='font-size:11px;font-weight:bold;'></td><td style='width:75px;text-align:right;'></td></tr>";
        $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'><div id='pie'>
    <p>Importadora Asia<br />
         Cochabamba - Bolivia<br />
         Telf. 4555651
    </p>
</div></td></tr>";
        $html .= "</table>";
        $html .= "</td>";
        $html .= "</tr>";
        $html .= "</table>";
        $html .= "</body>";
        $html .= "</html>";
        if($return == true)
        {
            return $html;
        }
        else
        {
            echo $html;
        }
    }
    else
    {
        $entrega = $datos["resultado"];
        /*aqui modificamos los campos segun la moneda */
        $totalAnticipos = $entrega[0]['anticipos'];
        //  $totalCredito = $ven[0]['credito'];
        $sueldo = $entrega[0]['sueldo'];
        $restante = $entrega[0]['sueldo'] - $entrega[0]['anticipos'];
        $tc = $entrega[0]['numero'];


        $html = "";
        $fecha = Date("Y-m-d");
        $html .= "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN'>";
        $html .= "<html>";
        $html .= "<head>";
        $html .= "<title></title>";
        $html .= "<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>";
        $html .= "<link href='".$_SESSION["ruta"]."css/print.css' rel='stylesheet' type='text/css' media='all'>";
        //$html .= "<link href='../print.css' rel='stylesheet' type='text/css' media='all'>";
        $html .= "</head>";
        $html .= "<body>";
        $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
        $html .= "<tr>";
        //$html .= "<td style='width:400px;height:100px;border-bottom:1px solid #000000;'><img style='height:100px;' src='logo.jpg'>";
        $html .= "</td>";
        $html .= "<td style='width:150px;height:100px;border-bottom:1px solid #000000;text-align:center;font-size:20px;font-family:Tahoma;'>";
        $html .= "<h2>ANTICIPO <BR> EMPLEADO</h2><br>";
        $html .= "</td>";
        $html .= "<td style='width:200px;height:100px;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";
        $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:200px;'>";
        $html .= "<tr><td align='right'><td><tr>";
        $html .= "<tr><td align='right' style='font-size:11px; font-family:Tahoma; text-align:center;font-weight:bold;'>".$ven[0]['idproforma']."<td><tr>";
        $html .= "</table>";
        $html .= "</td>";
        $html .= "</tr>";
        $html .= "<tr>";
        $html .= "<td colspan='3'>";
        $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
        $html .= "<tr><td style='width:100px;font-size:11px;font-weight:bold;'></td><td style='width:500px;' ></td><td style='width:75px;font-size:11px;font-weight:bold;'></td><td style='width:75px;'></td></tr>";
        $html .= "<tr><td style='font-size:11px;font-weight:bold;'></td><td></td><td style='font-size:11px;font-weight:bold;'></td><td></td></tr>";
        $html .= "<tr><td style='font-size:11px;font-weight:bold;'></td><td></td><td style='font-size:11px;font-weight:bold;'>Fecha:</td><td>$fecha </td></tr>";
        $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Anticipos...</td><td></td><td style='font-size:11px;font-weight:bold;'></td><td></td></tr>";
        $html .= "</table>";
        $html .= "</td>";
        $html .= "</tr>";
        $html .= "<tr>";
        $html .= "<td colspan='3'>";
        $sqlIV = "

SELECT
  emp.nombre,
  emp.apellidos,
  ant.monto AS anticipo,
  ant.fecha,
  usr.nombre AS usuario,
  CONCAT(mes.mes,'-',
  anio.anio) as gestion
FROM
  empleado emp,

  anticipo ant,
  usuario usr,
  `anio` anio,
  `gestion_mes` ges,
  `mes` mes
WHERE


  emp.idempleado = '$idempleado' AND
  ant.usuario = usr.idusuario AND
  anio.idanio = ges.idanio AND
  mes.idmes = ges.idmes AND
  ant.idmes = ges.idmes AND
  ant.idanio = ges.idanio
and ant.idmes = '$val'
";
        //        MostrarConsulta($sqlIV);
        $table = dibujarTablaOfSQL($sqlIV, $tc);
        $html .= $table['resultado'];
        $html .= "</td>";
        $html .= "</tr>";
        $html .= "<tr>";
        $html .= "<td colspan='3'>";
        $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
        $html .= "<tr><td style='width:100px;font-size:11px;font-weight:bold;'></td><td style='width:450px;'></td><td style='width:125px;font-size:11px;font-weight:bold;'>Total Anticipos ():</td><td style='width:75px;text-align:right;'>".$totalAnticipos."</td></tr>";
        $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Observaciones:</td><td>Proforma Valida Con Sello y Firma.</td><td style='font-size:11px;font-weight:bold;'>Sueldo ():</td><td style='width:75px;text-align:right;'>".$sueldo."</td></tr>";
        $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Emitido por:</td><td>".$_SESSION['login']."</td><td style='font-size:11px;font-weight:bold;'>Saldo a Pagar ():</td><td style='width:75px;text-align:right;'>".$restante."</td></tr>";
        $html .= "<tr><td style='font-size:11px;font-weight:bold;'></td><td></td><td style='font-size:11px;font-weight:bold;'></td><td style='width:75px;text-align:right;'></td></tr>";
        $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'><div id='pie'>
    <p>Importadora Asia<br />
         Cochabamba - Bolivia<br />
         Telf. 4555651
    </p>
</div></td></tr>";
        $html .= "</table>";
        $html .= "</td>";
        $html .= "</tr>";
        $html .= "</table>";
        $html .= "</body>";
        $html .= "</html>";
        if($return == true)
        {
            return $html;
        }
        else
        {
            echo $html;
        }
    }

}

//============================================

function reporteBoletaEmpleadoHTML($idempleado, $return)
{

    $hoy = Date("m");
    //    echo $hoy;
    $hoys = $hoy - 1;
    //    echo $hoys;
    if ($hoys <= 9)
    {
        $val = "0".$hoys;
    }
    else{
        $val = $hoys;
    }
    //  echo $val;
    $sql = "
SELECT
  SUM(ant.monto) AS anticipos,
  sue.sueldo
FROM
  anticipo ant,
  empleado sue
WHERE

  sue.idempleado = '$idempleado' AND ant.idempleado = '$idempleado' and
  ant.idmes = '$val'
GROUP BY
  sue.sueldo
";

    //MostrarConsulta($sql);

    $datos = getTablaToArrayOfSQL($sql);
    //            echo $datos['error'];
    if($datos['error'] == "false")
    {

        //    echo "entro cumpliendo";

        $sql3 = "
                SELECT

                  sue.sueldo
                FROM

                  empleado sue
                WHERE
                  sue.idempleado = '$idempleado'
                GROUP BY
                  sue.sueldo
                ";
        //        MostrarConsulta($sql3);
        $datoss = getTablaToArrayOfSQL($sql3);
        $entrega = $datoss["resultado"];
        //         $totalAnticipos = $entrega[0]['anticipos'];

        $sueldo = $entrega[0]['sueldo'];

        $restante = $entrega[0]['sueldo'] - 0;

        $tc = $entrega[0]['numero'];

        $numeroA = findUltimoID("gestion_mes", "numero", true);

        $numero = $numeroA['resultado'];
        $numeroB = $numero - 1;
        //echo $numeroB;
        if($numeroB ==0)
        {
            //echo "entro";
            $html = "";
            $fecha = Date("Y-m-d");
            $html .= "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN'>";
            $html .= "<html>";
            $html .= "<head>";
            $html .= "<title></title>";
            $html .= "<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>";
            $html .= "<link href='".$_SESSION["ruta"]."css/print.css' rel='stylesheet' type='text/css' media='all'>";
            //$html .= "<link href='../print.css' rel='stylesheet' type='text/css' media='all'>";
            $html .= "</head>";
            $html .= "<body>";
            $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
            $html .= "<tr>";
            //$html .= "<td style='width:400px;height:100px;border-bottom:1px solid #000000;'><img style='height:100px;' src='logo.jpg'>";
            $html .= "</td>";
            $html .= "<td style='width:150px;height:100px;border-bottom:1px solid #000000;text-align:center;font-size:20px;font-family:Tahoma;'>";
            $html .= "<h2>BOLETAS <BR> EMPLEADO</h2><br>";
            $html .= "</td>";
            $html .= "<td style='width:200px;height:100px;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";
            $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:200px;'>";
            $html .= "<tr><td align='right'><td><tr>";
            $html .= "<tr><td align='right' style='font-size:11px; font-family:Tahoma; text-align:center;font-weight:bold;'>".$ven[0]['idproforma']."<td><tr>";
            $html .= "</table>";
            $html .= "</td>";
            $html .= "</tr>";
            $html .= "<tr>";
            $html .= "<td colspan='3'>";
            $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
            $html .= "<tr><td style='width:100px;font-size:11px;font-weight:bold;'></td><td style='width:500px;' ></td><td style='width:75px;font-size:11px;font-weight:bold;'></td><td style='width:75px;'></td></tr>";
            $html .= "<tr><td style='font-size:11px;font-weight:bold;'></td><td></td><td style='font-size:11px;font-weight:bold;'></td><td></td></tr>";
            $html .= "<tr><td style='font-size:11px;font-weight:bold;'></td><td></td><td style='font-size:11px;font-weight:bold;'>Fecha:</td><td>$fecha </td></tr>";
            $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Sueldo...</td><td></td><td style='font-size:11px;font-weight:bold;'></td><td></td></tr>";
            $html .= "</table>";
            $html .= "</td>";
            $html .= "</tr>";
            $html .= "<tr>";
            $html .= "<td colspan='3'>";
            $sqlIV = "

            SELECT
              emp.nombre,
              emp.apellidos,
              emp.sueldo,
              usr.nombre AS usuario,
              CONCAT(mes.mes, '-', anio.anio) AS gestion,
              emp.idalmacen
            FROM
              empleado emp,

              usuario usr,
              anio,
              mes,
              gestion_mes ges
            WHERE
              emp.idempleado = '$idempleado' AND

              ges.idmes = mes.idmes AND
              ges.idanio = anio.idanio AND
              ges.idmes = '$val'
            ";
            //                    MostrarConsulta($sqlIV);
            $table = dibujarTablaOfSQL($sqlIV, $tc);
            $html .= $table['resultado'];
            $html .= "</td>";
            $html .= "</tr>";
            $html .= "<tr>";
            $html .= "<td colspan='3'>";
            $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
            $html .= "<tr><td style='width:100px;font-size:11px;font-weight:bold;'></td><td style='width:450px;'></td><td style='width:125px;font-size:11px;font-weight:bold;'>Total Anticipos ():</td><td style='width:75px;text-align:right;'>0</td></tr>";
            $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Observaciones:</td><td>Proforma Valida Con Sello y Firma.</td><td style='font-size:11px;font-weight:bold;'>Sueldo ():</td><td style='width:75px;text-align:right;'>".$sueldo."</td></tr>";
            $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Emitido por:</td><td>".$_SESSION['login']."</td><td style='font-size:11px;font-weight:bold;'>Saldo a Pagar ():</td><td style='width:75px;text-align:right;'>".$restante."</td></tr>";
            $html .= "<tr><td style='font-size:11px;font-weight:bold;'></td><td></td><td style='font-size:11px;font-weight:bold;'></td><td style='width:75px;text-align:right;'></td></tr>";
            $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'><div id='pie'>
                <p>Importadora Asia<br />
                     Cochabamba - Bolivia<br />
                     Telf. 4555651
                </p>
            </div></td></tr>";
            $html .= "</table>";
            $html .= "</td>";
            $html .= "</tr>";
            $html .= "</table>";
            $html .= "</body>";
            $html .= "</html>";
            if($return == true)
            {
                return $html;
            }
            else
            {
                echo $html;
            }
        }
        echo "no se puede generar reporte del mes anterior";
    }
    else
    {
        if($datos['error'] != "false")
        {

            //                echo "hola";
            $entrega = $datos["resultado"];
        /*aqui modificamos los campos segun la moneda */
            $totalAnticipos = $entrega[0]['anticipos'];
            //  $totalCredito = $ven[0]['credito'];
            $sueldo = $entrega[0]['sueldo'];
            $restante = $entrega[0]['sueldo'] - $entrega[0]['anticipos'];
            $tc = $entrega[0]['numero'];


            $numeroA = findUltimoID("gestion_mes", "numero", true);
            $numero = $numeroA['resultado'];
            $numeroB = $numero - 1;
            if($numeroB !=0)
            {
                $html = "";
                $fecha = Date("Y-m-d");
                $html .= "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN'>";
                $html .= "<html>";
                $html .= "<head>";
                $html .= "<title></title>";
                $html .= "<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>";
                $html .= "<link href='".$_SESSION["ruta"]."css/print.css' rel='stylesheet' type='text/css' media='all'>";
                //$html .= "<link href='../print.css' rel='stylesheet' type='text/css' media='all'>";
                $html .= "</head>";
                $html .= "<body>";
                $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
                $html .= "<tr>";
                //$html .= "<td style='width:400px;height:100px;border-bottom:1px solid #000000;'><img style='height:100px;' src='logo.jpg'>";
                $html .= "</td>";
                $html .= "<td style='width:150px;height:100px;border-bottom:1px solid #000000;text-align:center;font-size:20px;font-family:Tahoma;'>";
                $html .= "<h2>BOLETA <BR> EMPLEADO</h2><br>";
                $html .= "</td>";
                $html .= "<td style='width:200px;height:100px;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";
                $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:200px;'>";
                $html .= "<tr><td align='right'><td><tr>";
                $html .= "<tr><td align='right' style='font-size:11px; font-family:Tahoma; text-align:center;font-weight:bold;'>".$ven[0]['idproforma']."<td><tr>";
                $html .= "</table>";
                $html .= "</td>";
                $html .= "</tr>";
                $html .= "<tr>";
                $html .= "<td colspan='3'>";
                $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
                $html .= "<tr><td style='width:100px;font-size:11px;font-weight:bold;'></td><td style='width:500px;' ></td><td style='width:75px;font-size:11px;font-weight:bold;'></td><td style='width:75px;'></td></tr>";
                $html .= "<tr><td style='font-size:11px;font-weight:bold;'></td><td></td><td style='font-size:11px;font-weight:bold;'></td><td></td></tr>";
                $html .= "<tr><td style='font-size:11px;font-weight:bold;'></td><td></td><td style='font-size:11px;font-weight:bold;'>Fecha:</td><td>$fecha </td></tr>";
                $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Sueldo...</td><td></td><td style='font-size:11px;font-weight:bold;'></td><td></td></tr>";
                $html .= "</table>";
                $html .= "</td>";
                $html .= "</tr>";
                $html .= "<tr>";
                $html .= "<td colspan='3'>";
                $sqlIV = "

            SELECT
              emp.nombre,
              emp.apellidos,
              emp.sueldo,
              usr.nombre AS usuario,
              CONCAT(mes.mes, '-', anio.anio) AS gestion,
              emp.idalmacen,
              ant.monto,
              ant.fecha
            FROM
              empleado emp,

              usuario usr,
              anio,
              mes,
              gestion_mes ges,
              `anticipo` ant
            WHERE
              emp.idempleado = '$idempleado' AND

              ges.idmes = mes.idmes AND
              ges.idanio = anio.idanio AND

              ant.idmes = ges.idmes AND
              ant.idanio = ges.idanio and
              ges.idmes = '$val'
            ";
                //                    MostrarConsulta($sqlIV);
                $table = dibujarTablaOfSQL($sqlIV, $tc);
                $html .= $table['resultado'];
                $html .= "</td>";
                $html .= "</tr>";
                $html .= "<tr>";
                $html .= "<td colspan='3'>";
                $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
                $html .= "<tr><td style='width:100px;font-size:11px;font-weight:bold;'></td><td style='width:450px;'></td><td style='width:125px;font-size:11px;font-weight:bold;'>Total Anticipos ():</td><td style='width:75px;text-align:right;'>$totalAnticipos</td></tr>";
                $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Observaciones:</td><td>Proforma Valida Con Sello y Firma.</td><td style='font-size:11px;font-weight:bold;'>Sueldo ():</td><td style='width:75px;text-align:right;'>".$sueldo."</td></tr>";
                $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Emitido por:</td><td>".$_SESSION['login']."</td><td style='font-size:11px;font-weight:bold;'>Saldo a Pagar ():</td><td style='width:75px;text-align:right;'>".$restante."</td></tr>";
                $html .= "<tr><td style='font-size:11px;font-weight:bold;'></td><td></td><td style='font-size:11px;font-weight:bold;'></td><td style='width:75px;text-align:right;'></td></tr>";
                $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'><div id='pie'>
                <p>Importadora Asia<br />
                     Cochabamba - Bolivia<br />
                     Telf. 4555651
                </p>
            </div></td></tr>";
                $html .= "</table>";
                $html .= "</td>";
                $html .= "</tr>";
                $html .= "</table>";
                $html .= "</body>";
                $html .= "</html>";
                if($return == true)
                {
                    return $html;
                }
                else
                {
                    echo $html;
                }
            }

        }

    }


}


function reporteVentaHTML($idventadetalle, $return)
{
 $idtienda = $_SESSION['idtienda'];
     // echo "codigo".$idventadetalle;
    $html = "";


    $sql1 = " SELECT ved.numero,ved.fecha, ved.observacion,ved.nit,ved.hora,CONCAT( ved.nombrecliente, '-', ved.apellidocliente ) AS cliente,ved.idclienteempresa,ved.tipoventa, ved.cantidad, ved.totalbs AS total, ved.descuento, ved.montocancelado,ved.montoapagar, ved.montocanceladosus
FROM ventasdetalle ved
WHERE ved.idventadetalle = '$idventadetalle' "
    ;
               // MostrarConsulta($sql1);
    $dato = getTablaToArrayOfSQL($sql1);
    $ven = $dato["resultado"];
     $totalNeto = $ven[0]['montoapagar'];
     $idclienteempresa=$ven[0]['idclienteempresa'];

      $sql2 = " SELECT CONCAT( m.nombre,'/',ce.nombre, '-', ce.apellido ) AS clienteempresa
FROM empresas m, clienteempresa ce
WHERE ce.idclienteempresa = '$idclienteempresa'AND ce.idempresa=m.idempresa "
    ;
  $idalmacenA =  findBySqlReturnCampoUnique($sql2, true, true, 'clienteempresa');
    $clienteempresa = $idalmacenA['resultado'];

   $html .= "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN'>";
    $html .= "<html>";
    $html .= "<head>";
    $html .= "<title></title>";
    $html .= "<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>";
    $html .= "<link href='".$_SESSION["ruta"]."css/print.css' rel='stylesheet' type='text/css' media='all'>";
    //$html .= "<link href='../print.css' rel='stylesheet' type='text/css' media='all'>";
    $html .= "</head>";
    $html .= "<body>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
    $html .= "<tr>";
    //$html .= "<td style='width:400px;height:100px;border-bottom:1px solid #000000;'><img style='height:100px;' src='logo.jpg'>";
    $html .= "</td>";
    $html .= "<td style='width:150px;height:100px;border-bottom:1px solid #000000;text-align:center;font-size:20px;font-family:Tahoma;'>";
    $html .= "NOTA <br>DE<br> VENTA";
    $html .= "</td>";
    $html .= "<td style='width:200px;height:100px;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:200px;'>";
    //$html .= "<tr><td align='right'><img src='".$_SESSION["ruta"]."php/impl/codigo.jpg'><td><tr>";
    $html .= "<tr><td align='right' style='font-size:11px; font-family:Tahoma; text-align:center;font-weight:bold;'>".$num."<td><tr>";
    $html .= "</table>";
    $html .= "</td>";
    $html .= "</tr>";
    $html .= "<tr>";
    $html .= "<td colspan='3'>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
    $html .= "<tr><td style='width:100px;font-size:11px;font-weight:bold;'></td><td style='width:500px;' ></td><td style='width:75px;font-size:11px;font-weight:bold;'>Numero:</td><td style='width:75px;'>".$ven[0]['numero']."</td></tr>";
   //$cliente=$ven[0]['cliente'];
//$clienteempresa= $ven1[0]['clienteempresa'];
   if($ven[0]['nit']==NULL || $ven[0]['nit']==''){
   $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Cliente:</td><td>".$clienteempresa."</td><td style='font-size:11px;font-weight:bold;'> ".$ven1[0]['abreviacion']."</td><td>".$tc."</td></tr>";
   }else{
   $html .= "<tr><td style='font-size:11px;font-weight:bold;'>NIT:</td><td>".$ven[0]['nit']."</td><td style='font-size:11px;font-weight:bold;'> ".$ven1[0]['abreviacion']."</td><td>".$tc."</td></tr>";
   $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Cliente:</td><td>".$ven[0]['cliente']."</td><td style='font-size:11px;font-weight:bold;'> ".$ven1[0]['abreviacion']."</td><td>".$tc."</td></tr>";

   }

   $fecha1=$ven[0]['fecha'];
   $formatear = explode( '-' , $fecha1);
$fecha = $formatear[2].'-'.$formatear[1].'-' .$formatear[0];
   $html .= "<td></td><td></td><td style='font-size:11px;font-weight:bold;'>Fecha:</td><td>".$fecha."</td></tr>";
$html .= "<td style='font-size:11px;font-weight:bold;'>Por lo siguiente.....</td></tr>";


    $html .= "</table><br>";
    $html .= "</td>";
    $html .= "</tr>";
    $html .= "<tr>";
    $html .= "<td colspan='3'>";
    $sqlIV = "
    SELECT mdt.codigo, CONCAT( mdt.stylename, '-', mdt.color, '-', mdt.material ) AS detalle, emp.codigo AS vendedor, itv.cantidad, itv.total
FROM modelodetalle mdt, empleados emp, itemventa itv, kardextienda kar
WHERE itv.idkardextienda = kar.idkardextienda
AND kar.idmodelodetalle = mdt.idmodelodetalle
AND itv.idventa = '$idventadetalle'
AND itv.idempleado = emp.idempleado
                ";

    //         $totalDescuento = $ven[0]['descuento'];
    $table =
      // MostrarConsulta($sqlIV);
     // dibujarTablaOfSQLNormal

        $table = dibujarTablaOfSQLNormal($sqlIV, "Detalle de Venta");
    $html .= $table['resultado'];
    $html .= "</td>";
    $html .= "</tr>";
    $html .= "<tr>";
    $html .= "<td colspan='3'>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'><br>";
  //  $html .= "<td style='width:100px;font-size:11px;font-weight:bold;'>Son:</td><td style='width:450px;'>".convertir_a_letras($ven[0]['total'], $ven[0]['abreviacion'])."</td>";
//    $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Observaciones:</td><td>".$ven[0]['observacion']."</td><td style='font-size:11px;font-weight:bold;'> Descuento:</td><td style='width:75px;text-align:right;'>".$ven1[0]['descuento']."</td></tr>";
    //$html .= "<tr><td style='font-size:11px;font-weight:bold;'>Emitido por:</td><td>".$ven[0]['login']."</td><td style='font-size:11px;font-weight:bold;'>Total credito (".$ven[0]['descuento']."):</td><td style='width:75px;text-align:right;'>".$totalCredito."</td></tr>";
//    $html .= "<tr><td style='font-size:11px;font-weight:bold;'></td><td></td><td style='font-size:11px;font-weight:bold;'>Total Venta :</td><td style='width:75px;text-align:right;'>".$montoapagar."</td></tr>";
    //        $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'>Foreground SRL</td></tr>";
    $html .= "</table>";
    $html .= "</td>";
    $html .= "</tr>";
 $html .= "<tr>";
    $html .= "<td colspan='3'>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
    $html .= "<tr><td style='width:100px;font-size:11px;font-weight:bold;'></td><td style='width:500px;' ></td><td style='width:75px;font-size:11px;font-weight:bold;'>Numero:</td><td style='width:75px;'>".$ven1[0]['numerodocumento']."</td></tr>";
    $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Cantidad:</td><td>".$ven[0]['cantidad']."</td><td style='font-size:11px;font-weight:bold;'> ".$ven1[0]['abreviacion']."</td><td>".$tc."</td></tr>";
    $html .= "<td></td><td style='font-size:11px;font-weight:bold;'>Monto Total Bs:</td><td>".$ven[0]['total']."</td></tr>";
    $html .= "<td></td><td style='font-size:11px;font-weight:bold;'>Descuento:</td><td>".$ven[0]['descuento']."</td></tr>";
    $html .= "<td></td><td style='font-size:11px;font-weight:bold;'>Monto Cancelado Bs:</td><td>".$ven[0]['montocancelado']."</td></tr>";
 $html .= "<tr><td style='width:100px;font-size:15px;font-weight:bold;'>Son:</td><td style='width:450px;'>".convertir_a_letras($totalNeto, $ven[0]['abreviacion'])."</td><td style='font-size:15px;font-weight:bold;'>Total Descuento:</td><td style='width:75px;text-align:right;'>".$ven[0]['descuento']."</td></tr>";
        $html .= "<tr><td style='font-size:15px;font-weight:bold;'>Observaciones:</td><td>".$ven[0]['observacion']."</td><td style='font-size:15px;font-weight:bold;'>Total Venta :</td><td style='font-size:15px;font-weight:bold;text-align:right;'>".$ven[0]['montoapagar']."</td></tr>";

   // $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Por lo siguiente.....</td>";
    $html .= "</table><br>";
    $html .= "</td>";
    $html .= "</tr>";
    $html .= "<tr>";

    $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'><div id='pie'>
    <p>Calzados Balderrama<br />
         Cochabamba - Bolivia<br />

    </p>
</div></td></tr>";
    $html .= "</table>";
    $html .= "</body>";
    $html .= "</html>";
    if($return == true)
    {
        return $html;
    }
    else
    {
        echo $html;
    }

    //    }
}
function reporteVentaHTML222($idventa, $return)
{
    //hoooooooooooooooooooooooo
    $html = "";



    $sql = "
SELECT DISTINCT
  ven.codigo,
  ven.fecha,
  ven.hora,
  ven.nit,
  ven.montototal,
  ven.montoapagar,
  ven.montocancelado,
  cli.nombre as cliente,
 ven.responsable,
  ven.observacion
FROM
  `ventas` ven,
  `cliente` cli
WHERE
  ven.idventa = '$idventa' AND
  ven.idcliente = cli.idcliente
";
    //    MostrarConsulta($sql);
    $datos = getTablaToArrayOfSQL($sql);
    if($datos['error'] == "false")
    {
        echo "No existe esta venta ...............";
        exit;
    }
    //    else
    //    {
    $sql1=" SELECT DISTINCT
  ven.codigo,
  ven.fecha,
  ven.hora,
  ven.nit,
  ven.montototal,
  ven.montoapagar,
  ven.montocancelado,
  cli.nombre
FROM
  `ventas` ven,
  `cliente` cli
WHERE
  ven.idventa = '$idventa' AND
  ven.idcliente = cli.idcliente"
    ;
   
    $dato = getTablaToArrayOfSQL($sql1);
    $ven = $dato["resultado"];

    $montoapagar = $ven[0]['montoapagar'];

    $montototal = $ven[0]['montototal'];
    //
    $dato = getTablaToArrayOfSQL($sql);
    $ven1 = $dato["resultado"];
    $totalMonto = $ven1[0]['montototal'];
    $precio = $ven1[0]['precio'];
    $cantidad = $ven1[0]['cantidad'];
    $obsevacion = $ven1[0]['observacion'];
    $tc = $ven1[0]['monto'];
    $totalMonto = redondear($totalMonto, $_SESSION['usrDigitos']);
  
    $totalNeto = redondear($totalNeto, $_SESSION['usrDigitos']);

    $html .= "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN'>";
    $html .= "<html>";
    $html .= "<head>";
    $html .= "<title></title>";
    $html .= "<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>";
    $html .= "<link href='".$_SESSION["ruta"]."css/print.css' rel='stylesheet' type='text/css' media='all'>";
    $html .= "</head>";
    $html .= "<body>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
    $html .= "<tr>";
     $html .= "</td>";
    $html .= "<td style='width:150px;height:100px;border-bottom:1px solid #000000;text-align:center;font-size:20px;font-family:Tahoma;'>";
    $html .= "REPORTE <br>DE<br> DETALLE PEDIDO";
    $html .= "</td>";
    $html .= "<td style='width:200px;height:100px;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:200px;'>";
    //$html .= "<tr><td align='right'><img src='".$_SESSION["ruta"]."php/impl/codigo.jpg'><td><tr>";
    $html .= "<tr><td align='right' style='font-size:11px; font-family:Tahoma; text-align:center;font-weight:bold;'>".$ven1[0]['idventa']."<td><tr>";
    $html .= "</table>";
    $html .= "</td>";
    $html .= "</tr>";
    $html .= "<tr>";
    $html .= "<td colspan='3'>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
    $html .= "<tr><td style='width:100px;font-size:11px;font-weight:bold;'></td><td style='width:500px;' ></td><td style='width:75px;font-size:11px;font-weight:bold;'>Numero:</td><td style='width:75px;'>".$ven1[0]['codigo']."</td></tr>";
    $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Cliente:</td><td>".$ven1[0]['cliente']."</td><td style='font-size:11px;font-weight:bold;'> ".$ven1[0]['abreviacion']."</td><td>".$tc."</td></tr>";
    $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Usuario:</td><td>".$ven1[0]['responsable'] ."</td><td style='font-size:11px;font-weight:bold;'>Fecha:</td><td>".$ven1[0]['fecha']."</td></tr>";
    $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Por lo siguiente...</td><td></td><td style='font-size:11px;font-weight:bold;'></td></tr>";
    $html .= "</table>";
    $html .= "</td>";
    $html .= "</tr>";
    $html .= "<tr>";
    $html .= "<td colspan='3'>";
    $sqlIV = "
              SELECT
 pro.codigo AS Codigo,
 pro.nombre AS Producto,
it.precio AS Precio,
  it.cantidad AS Cantidad,
  it.total AS Total

FROM
  itemventa it,
  `productos` pro
WHERE
  it.idventa = '$idventa' AND
  it.idproducto = pro.idproducto
                ";
    //         $totalDescuento = $ven[0]['descuento'];
    $table =
    //    MostrarConsulta($sqlIV);
    $table = dibujarTablaOfSQL($sqlIV, "Detalle");
    //    $table = dibujarTablaOfSQL($sqlIV, "Productos");
    //    $table = dibujarTuplaOfSQLNormal($sqlIV, "Informacion del producto");
    $html .= $table['resultado'];
    $html .= "</td>";
    $html .= "</tr>";
    $html .= "<tr>";
    $html .= "<td colspan='3'>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
    $html .= "<tr><td style='width:100px;font-size:11px;font-weight:bold;'>Son:</td><td style='width:450px;'>".convertir_a_letras($montoapagar, $ven[0]['abreviacion'])."</td><td style='width:125px;font-size:11px;font-weight:bold;'>Montototal</td><td style='width:75px;text-align:right;'>".$montototal."</td></tr>";
    $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Observaciones:</td><td>".$ven1[0]['observacion']."</td><td style='font-size:11px;font-weight:bold;'> Descuento:</td><td style='width:75px;text-align:right;'>".$ven1[0]['descuento']."</td></tr>";
    //$html .= "<tr><td style='font-size:11px;font-weight:bold;'>Emitido por:</td><td>".$ven[0]['login']."</td><td style='font-size:11px;font-weight:bold;'>Total credito (".$ven[0]['descuento']."):</td><td style='width:75px;text-align:right;'>".$totalCredito."</td></tr>";
    $html .= "<tr><td style='font-size:11px;font-weight:bold;'></td><td></td><td style='font-size:11px;font-weight:bold;'>Total Venta :</td><td style='width:75px;text-align:right;'>".$montoapagar."</td></tr>";
    //        $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'>Foreground SRL</td></tr>";
    $html .= "</table>";
    $html .= "</td>";
    $html .= "</tr>";

    $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'><div id='pie'>
    <p>Importadora Asia<br />
         Cochabamba - Bolivia<br />
         Telf. 4555651
    </p>
</div></td></tr>";
    $html .= "</table>";
    $html .= "</body>";
    $html .= "</html>";
    if($return == true)
    {
        return $html;
    }
    else
    {
        echo $html;
    }

    //    }
}


function dibujarTablaOfSQL($sql, $tc = 1)
{
    if($link=new BD)
    {
        if($link->conectar())
        {
            if($re = $link->consulta($sql))
            {
                //echo mysql_num_rows($re);
                if($fi = mysql_fetch_array($re))
                {
                    $devS .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px;border:1px solid #000000;font-size:11px;'>";
                    $devS .= "<tr><td style='border-bottom:1px solid #000000;font-weight:bold;font-size:11px;text-align:center;background-color:silver;'>Nro</td>";

                    //dibjamos las cabeceras



                    for($zz = 0; $zz < mysql_num_fields($re); $zz++)
                    {
                        $devS .= "<td style='border-bottom:1px solid #000000;border-left:1px solid #000000;font-weight:bold;font-size:11px;text-align:center;background-color:silver;'>".mysql_field_name($re, $zz)."</td>";
                    }
                    $devS .= "</tr>";
                    $ii = 0;
                    //$totalCount = mysql_num_rows($re);
                    $z = 1;
                    do{
                        $devS .= "<tr><td style='text-align:center'>".$z."</td>";
                        for($i = 0; $i< mysql_num_fields($re); $i++)
                        {
                            if(mysql_field_type($re, $i) == "real")
                            {
                                $dato = $fi[$i];
                                if(mysql_field_name($re, $i) == "precio" || mysql_field_name($re, $i) == "importe")
                                {
                                    //                                    $dato = $fi[$i]/$tc;
                                    $dato = $fi[$i];
                                }
                                $devS .= "<td style='text-align:right;border-left: 1px solid #000000;'>&nbsp;".redondear($dato)."&nbsp;</td>";
                            }
                            else
                            {
                                $devS .= "<td style='border-left: 1px solid #000000;'>&nbsp;".$fi[$i]."&nbsp;</td>";
                            }
                        }
                        $devS .= "</tr>";
                        $ii++;
                        $z ++;
                    }while($fi = mysql_fetch_array($re));

                    $devS .= "</table>";

                    $dev['mensaje'] = "Existen resultados";
                    $dev['error']   = "true";
                    $dev['resultado'] = $devS;

                }
                else
                {
                    $dev['mensaje'] = "No se encontro datos en la consulta2".mysql_error();
                    $dev['error']   = "false";
                    $dev['resultado'] = "";
                }
            }
            else
            {
                $dev['mensaje'] = "Error en la consulta";
                $dev['error']   = "false";
                $dev['resultado'] = "";
            }
        }
        else
        {
            $dev['mensaje'] = "No se pudo conectar a la BD";
            $dev['error']   = "false";
            $dev['resultado'] = "";
        }
    }
    else
    {
        $dev['mensaje'] = "No se pudo crear la conexion a la BD";
        $dev['error']   = "false";
        $dev['resultado'] = "";
    }
    return $dev;
}
function reportealmacenHTML($idalmacen, $return)
{
    $html = "";

    $html .= "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN'>";
    $html .= "<html>";
    $html .= "<head>";
    $html .= "<title></title>";
    $html .= "<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>";
    $html .= "<link href='".$_SESSION["ruta"]."css/print.css' rel='stylesheet' type='text/css' media='all'>";
    //$html .= "<link href='../print.css' rel='stylesheet' type='text/css' media='all'>";
    $html .= "</head>";
    $html .= "<body>";
    $html .= "<table cellpadding='1' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
    $html .= "<tr>";
    //$html .= "<td style='width:400px;height:100px;border-bottom:1px solid #000000;'><img style='height:100px;' src='logo.jpg'>";
    $html .= "</td>";
    $html .= "<td style='width:150px;height:100px;border-bottom:1px solid #000000;text-align:center;font-size:20px;font-family:Tahoma;'>";
    $html .= "REPORTE <br>DE<br> ALMACEN";
    $html .= "</td>";
    $html .= "<td style='width:200px;height:100px;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";
    //    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:200px;'>";
    //    //$html .= "<tr><td align='right'><img src='".$_SESSION["ruta"]."php/codigo.jpg'><td><tr>";
    //    $html .= "<tr><td align='right' style='font-size:11px; font-family:Tahoma; text-align:center;font-weight:bold;'><td><tr>";
    //    $html .= "</table>";
    //    $html .= "</td>";
    //    $html .= "</tr>";
    $html .= "<tr>";
    //    $html .= "<td>";
    $html .= "</td>";

    $html .= "<td style='width:33%;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $sql = "SELECT a.idalmacen,a.nombre,a.direccion,a.telefono,a.estado
FROM almacenes a
WHERE  a.idalmacen = '$idalmacen'";
    $producto = dibujarTuplaOfSQLNormal($sql, "Informacion del Almacen");
    $html .= $producto['resultado'];
    $html .= "</td>";
    $html .= "<td style='width:33%;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";

    $html .= "</td>";
    $html .= "</tr>";
    $html .= "<tr><td colspan='3'>";
    $sqlInv2 = "SELECT
  p.idproducto AS codigo,p.nombre AS producto,pv.nombre AS proveedor,p.estado,k.saldocantidad,k.precio1bs AS precio,k.precio1sus AS Dolar,k.costounitario
FROM
  kardexalmacen ka,
  almacenes a,
  productos p,
  kardexalmacen k,
  proveedores pv
WHERE
  p.idproducto=k.idproducto AND
  p.idproveedor=pv.idproveedor AND
  ka.idproducto=p.idproducto AND
  ka.idalmacen = a.idalmacen AND
  ka.idalmacen = 'alm-1000' ORDER BY p.idproveedor ASC";
    $inventario2 = dibujarTablaOfSQLNormal($sqlInv2, "Inventario de Productos");
    $html .= $inventario2['resultado'];
    $html .= "</td></tr>";
  /*$html .= "<tr><td colspan='3'>";
    $sqlInv = "SELECT
 mka.fecha,mka.hora,mka.descripcion, p.idproducto AS codigo,p.nombre AS producto,p.estado,mka.entrada,mka.salida,mka.saldo,mka.ingreso,mka.egreso,mka.saldobs
FROM
  almacenes a,
  productos p,
  movimientokardexalmacen mka
WHERE
  mka.idproducto=p.idproducto AND
  mka.idalmacen = a.idalmacen AND
  mka.idalmacen = '$idalmacen' ";
    $inventario = dibujarTablaOfSQLNormal($sqlInv, "Movimientos de Almacen");
    $html .= $inventario['resultado'];
    $html .= "</td></tr>";
    */

    $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'><div id='pie'>
    <p>Importadora Asia<br />
         Cochabamba - Bolivia<br />
         Telf. 4555651
    </p>
</div></td></tr>";

    $html .= "</table>";
    $html .= "</body>";
    $html .= "</html>";
    if($return == true)
    {
        return $html;
    }
    else
    {
        echo $html;
    }

}



function arqueoDiarioHTML($almacen,$fecha,$efectivo_bs,$efectivo_sus, $return)
{

    if($fecha == null)
    {
        $fecha = Date("Y-m-d");
    }
    if($efectivo_sus == null)
    {
        $efectivo_sus = 0;
    }
    //echo $fecha;
    $sql2 = "SELECT
  alm.idalmacen
FROM
  `almacenes` alm
WHERE
  alm.nombre = '$almacen'";
    $idalmacenA =  findBySqlReturnCampoUnique($sql2, true, true, 'idalmacen');
    $idalmacen = $idalmacenA['resultado'];
    //    echo $idalmacen;
    $html = "";

    $html .= "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN'>";
    $html .= "<html>";
    $html .= "<head>";
    $html .= "<title></title>";
    $html .= "<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>";
    $html .= "<link href='".$_SESSION["ruta"]."css/print.css' rel='stylesheet' type='text/css' media='all'>";
    //$html .= "<link href='../print.css' rel='stylesheet' type='text/css' media='all'>";
    $html .= "</head>";
    $html .= "<body>";
    $html .= "<table cellpadding='1' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
    $html .= "<tr>";
    //$html .= "<td style='width:400px;height:100px;border-bottom:1px solid #000000;'><img style='height:100px;' src='logo.jpg'>";
    $html .= "</td>";
    $html .= "<td style='width:150px;height:100px;border-bottom:1px solid #000000;text-align:center;font-size:20px;font-family:Tahoma;'>";
    $html .= "ARQUEO <br>DE<br> ".$almacen."<br>";
    $html .=$fecha;
    $html .= "</td>";
    $html .= "<td style='width:200px;height:100px;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";
    //    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:200px;'>";
    //    //$html .= "<tr><td align='right'><img src='".$_SESSION["ruta"]."php/codigo.jpg'><td><tr>";
    //    $html .= "<tr><td align='right' style='font-size:11px; font-family:Tahoma; text-align:center;font-weight:bold;'><td><tr>";
    //    $html .= "</table>";
    //    $html .= "</td>";
    //    $html .= "</tr>";
    $html .= "<tr>";
    //    $html .= "<td>";
    $html .= "</td>";
    //

    $html .= "<td style='width:33%;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $sql = "SELECT
  SUM(vent.montoapagar) AS ventasTotales
FROM
  ventas vent
WHERE
  vent.idalmacen = '$idalmacen' AND
  vent.fecha = '$fecha'
";
    $ventaA=findBySqlReturnCampoUnique($sql, true, true, 'ventasTotales');
    $venta = $ventaA['resultado'];
    //    echo $venta;
    //    MostrarConsulta($sql);
    $producto = dibujarTuplaOfSQLNormal($sql, "Detalle Arqueo");

    $html .= $producto['resultado'];
    $html .= "</td>";
    // $html .= "<td style='width:33%;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";

    $html .= "</td>";
    $html .= "</tr>";

    $sqlA = "SELECT
  alm.fondocaja as FondoCaja
FROM
  `almacenes` alm
WHERE
  alm.nombre = '$almacen'";

    $cajaA =  findBySqlReturnCampoUnique($sqlA, true, true, 'fondocaja');
    $caja = $cajaA['resultado'];
    $html .= "<tr>";
    $html .= "<td style='width:33%;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $productoA = dibujarTuplaOfSQLNormal($sqlA, "");

    $html .= $productoA['resultado'];
    $html .= "</td></tr>";




    $html .= "<tr>";
    $html .= "<td style='width:33%;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $sqlInv = "SELECT
  egr.montototal AS Gastos,
  cueg.nombre as por
FROM
  egreso egr,
  almacenes alm,
  `itemegreso` iteg,
  `cuentaegreso` cueg
WHERE
  egr.fecha = '$fecha' AND
  alm.idalmacen = egr.idalmacen AND
  alm.nombre = '$almacen' AND
  egr.idegreso = iteg.idegreso AND
  cueg.idcuentaegreso = iteg.idcuentaegreso";
    //    MostrarConsulta($sqlInv);
    $inventario = dibujarTuplaOfSQLNormal($sqlInv, "");
    $html .= $inventario['resultado'];
    //    $html .= ;
    $sqlInv1 = "SELECT
  SUM(egr.montototal) AS Gastos_Totales
FROM
  egreso egr,
  almacenes alm,
  `itemegreso` iteg,
  `cuentaegreso` cueg
WHERE
  egr.fecha = '$fecha' AND
  alm.idalmacen = egr.idalmacen AND
  alm.nombre = '$almacen' AND
  egr.idegreso = iteg.idegreso AND
  cueg.idcuentaegreso = iteg.idcuentaegreso";
    $inventario1 = dibujarTuplaOfSQLNormal($sqlInv1, "");

    $html .= $inventario1['resultado'];
    $html .= "</td></tr>";


    $html .= "<tr>";
    $html .= "<td style='width:33%;text-align:right;font-size:11px;font-family:Tahoma;'>";

    $tipo = findUltimoID("tipocambio", "valor", true);
    $cambio = $tipo['resultado'];

    $sqlInv = "SELECT
  max(ticam.valor)as TipoCambio
FROM
  tipocambio ticam";
    //    $inventario = dibujarTablaOfSQLNormal($sqlInv, "Movimientos de Almacen");
    //    $html .= $inventario['resultado'];
    $inventario = dibujarTuplaOfSQLNormal($sqlInv, "");
    $html .= $inventario['resultado'];
    $html .= "</td></tr>";

    $html .= "<tr>";
    $html .= "<td style='width:33%;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:100%;border:1px solid #000000;font-size:11px;'>";

    //    $html .= "<tr><td colspan='2' style='border-bottom:1px solid #000000;font-weight:bold;font-size:11px;text-align:center;background-color:silver;'></td></tr>";

    $html .= "<tr><td style='font-weight:bold;'>&nbsp;&nbsp;Efectivo Bs:</td><td style='text-align:right;border-left: 1px solid #000000;'>&nbsp;".$efectivo_bs."&nbsp;</td></tr>";

    //    $html .= "<tr><td style='font-weight:bold;'>&nbsp;&nbsp;Efectivo Bs:</td>";

    //    $html .= "</tr>";
    $html .= "</table>";
    $html .= "</td></tr>";




    $html .= "<tr>";
    $html .= "<td style='width:33%;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:100%;border:1px solid #000000;font-size:11px;'>";

    //    $html .= "<tr><td colspan='2' style='border-bottom:1px solid #000000;font-weight:bold;font-size:11px;text-align:center;background-color:silver;'></td></tr>";

    $html .= "<tr><td style='font-weight:bold;'>&nbsp;&nbsp;Efectivo Sus:</td><td style='text-align:right;border-left: 1px solid #000000;'>&nbsp;".$efectivo_sus."&nbsp;</td></tr>";

    //    $html .= "<tr><td style='font-weight:bold;'>&nbsp;&nbsp;Efectivo Bs:</td>";

    //    $html .= "</tr>";
    $html .= "</table>";
    $html .= "</td></tr>";

    $sqlInv1 = "SELECT
  SUM(egr.montototal) AS Gastos_Totales
FROM
  egreso egr,
  almacenes alm,
  `itemegreso` iteg,
  `cuentaegreso` cueg
WHERE
  egr.fecha = '$fecha' AND
  alm.idalmacen = egr.idalmacen AND
  alm.nombre = '$almacen' AND
  egr.idegreso = iteg.idegreso AND
  cueg.idcuentaegreso = iteg.idcuentaegreso";

    $gastosA = findBySqlReturnCampoUnique($sqlInv1, true, true, 'Gastos_Totales');
    $gastos = $gastosA['resultado'];
    $total1 = $efectivo_bs+($efectivo_sus*$cambio);
    $total = $total1 + $gastos;
    //    echo "gastos".$gastos;
    //    echo "bs".$efectivo_bs;
    //    echo "sus".$efectivo_sus;
    //    echo "cambio".$cambio;
    //    echo "t".$total1;
    //    echo $total;
    $html .= "<tr>";
    $html .= "<td style='width:33%;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:100%;border:1px solid #000000;font-size:11px;'>";

    //    $html .= "<tr><td colspan='2' style='border-bottom:1px solid #000000;font-weight:bold;font-size:11px;text-align:center;background-color:silver;'></td></tr>";

    $html .= "<tr><td style='font-weight:bold;'>&nbsp;&nbsp;TotalEfectivo:</td><td style='text-align:right;border-left: 1px solid #000000;'>&nbsp;".$total."&nbsp;</td></tr>";

    //    $html .= "<tr><td style='font-weight:bold;'>&nbsp;&nbsp;Efectivo Bs:</td>";

    //    $html .= "</tr>";
    $html .= "</table>";
    $html .= "</td></tr>";
    $sobrante1 = $venta - $total;
    if($sobrante1 >0)
    {
        $sobrante = "-".$sobrante1;
        $html .= "<tr>";
        $html .= "<td style='width:33%;text-align:right;font-size:11px;font-family:Tahoma;'>";
        $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:100%;border:1px solid #000000;font-size:11px;'>";

        //    $html .= "<tr><td colspan='2' style='border-bottom:1px solid #000000;font-weight:bold;font-size:11px;text-align:center;background-color:silver;'></td></tr>";

        $html .= "<tr><td style='font-weight:bold;'>&nbsp;&nbsp;Faltante :</td><td style='text-align:right;border-left: 1px solid #000000;'>&nbsp;".$sobrante."&nbsp;</td></tr>";

        //    $html .= "<tr><td style='font-weight:bold;'>&nbsp;&nbsp;Efectivo Bs:</td>";

        //    $html .= "</tr>";
        $html .= "</table>";
        $html .= "</td></tr>";
    }
    else
    {

        $faltante1 = $venta-$total;
        $faltante = $faltante1*-1;
        $html .= "<tr>";
        $html .= "<td style='width:33%;text-align:right;font-size:11px;font-family:Tahoma;'>";
        $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:100%;border:1px solid #000000;font-size:11px;'>";

        //    $html .= "<tr><td colspan='2' style='border-bottom:1px solid #000000;font-weight:bold;font-size:11px;text-align:center;background-color:silver;'></td></tr>";

        $html .= "<tr><td style='font-weight:bold;'>&nbsp;&nbsp;Sobrante:</td><td style='text-align:right;border-left: 1px solid #000000;'>&nbsp;".$faltante."&nbsp;</td></tr>";

        //    $html .= "<tr><td style='font-weight:bold;'>&nbsp;&nbsp;Efectivo Bs:</td>";

        //    $html .= "</tr>";
        $html .= "</table>";
        $html .= "</td></tr>";
    }
    $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'><div id='pie'>
    <p>Importadora Asia<br />
         Cochabamba - Bolivia<br />
         Telf. 4555651
    </p>
</div></td></tr>";

    $html .= "</table>";
    $html .= "</body>";
    $html .= "</html>";
    if($return == true)
    {
        return $html;
    }
    else
    {
        echo $html;
    }

}


function reporteCliente($idcliente, $return)
{
    $html = "";

    $html .= "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN'>";
    $html .= "<html>";
    $html .= "<head>";
    $html .= "<title></title>";
    $html .= "<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>";
    $html .= "<link href='".$_SESSION["ruta"]."css/print.css' rel='stylesheet' type='text/css' media='all'>";
    //$html .= "<link href='../print.css' rel='stylesheet' type='text/css' media='all'>";
    $html .= "</head>";
    $html .= "<body>";
    $html .= "<table cellpadding='1' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
    $html .= "<tr>";
    //$html .= "<td style='width:400px;height:100px;border-bottom:1px solid #000000;'><img style='height:100px;' src='logo.jpg'>";
    $html .= "</td>";
    $html .= "<td style='width:150px;height:100px;border-bottom:1px solid #000000;text-align:center;font-size:20px;font-family:Tahoma;'>";
    $html .= "REPORTE <br>DE<br> CLIENTE";
    $html .= "</td>";
    $html .= "<td style='width:200px;height:100px;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:200px;'>";
    // $html .= "<tr><td align='right'><img src='".$_SESSION["ruta"]."php/codigo.jpg'><td><tr>";
    $html .= "<tr><td align='right' style='font-size:11px; font-family:Tahoma; text-align:center;font-weight:bold;'><td><tr>";
    $html .= "</table>";
    $html .= "</td>";
    $html .= "</tr>";
    $html .= "<tr>";
    $html .= "<td style='width:33%;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $sql = "SELECT
              ticli.nombre AS tipo,
              alm.nombre AS almacen,
              cli.nombre,
              cli.telefono,
              cli.direccion,
              cli.estado
            FROM
              tipo_clientes ticli,
              almacenes alm,
              clientes cli
            WHERE
              cli.idtipocliente = ticli.idtipocliente AND
              cli.idalmacen = alm.idalmacen AND
              cli.idcliente = '$idcliente'";
    $producto = dibujarTablaOfSQLNormal($sql, "Informacion Cliente");
    $html .= $producto['resultado'];
    $html .= "</td>";
    $html .= "<td style='width:33%;text-align:right;font-size:11px;font-family:Tahoma;' valign='top'>";
    $sqlCar = "SELECT
  kc.observacion,
  kc.fecha,
  kc.deposito,
  kc.retiro,
  kc.saldo
FROM
  kardexcliente kc,
  cliente c
WHERE
  c.idcliente = kc.idcliente AND
  kc.idcliente = '$idcliente'";
    $carac = dibujarTablaOfSQLNormal($sqlCar, "Kardex de Cliente");
    $html .= $carac['resultado'];
    $html .="<br>";
    /*$sqlKar = "SELECT cu.codigo AS codigo,cu.montoactual AS monto Actual,cu.fecha,a.nombre AS almacen FROM cuenta cu,almacenes a,cliente c
    WHERE cu.idcliente=c.idcliente AND cu.idalmacen=a.idalmacen AND cu.idcliente = '$idcliente'";
    $kardex = dibujarTablaOfSQLNormal($sqlKar, "Cuenta");
    $html .= $kardex['resultado'];*/
    $html .= "</td>";
    $html .= "<td style='width:33%;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";

    $html .= "</td>";
    $html .= "</tr>";
    $html .= "<tr><td colspan='3'>";
    $sqlInv = "SELECT
  a.nombre AS Almacen,
  v.fecha,
  v.hora,
  v.cajero AS vendedor,
  tv.nombre AS Tipo,
  v.montototal AS Monto
FROM
  almacenes a,
  ventas v,
  tipoventa tv,
  cliente c
WHERE
  v.idalmacen = a.idalmacen AND
  c.idcliente = v.idcliente AND
  v.idcliente = 'cli-1000'
ORDER BY
  v.fecha DESC";
    $inventario = dibujarTablaOfSQLNormal($sqlInv, "Compras Realizadas por el Cliente");
    $html .= $inventario['resultado'];
    $html .= "</td></tr>";

    $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'><div id='pie'>
    <p>Calzados Balderrama<br />
         Cochabamba - Bolivia<br />

    </p>
</div></td></tr>";
    $html .= "</table>";
    $html .= "</body>";
    $html .= "</html>";
    if($return == true)
    {
        return $html;
    }
    else
    {
        echo $html;
    }

}


function detalleColeccion($idcoleccion, $return)
{
    //hoooooooooooooooooooooooo
    $html = "";


    $sql1= "SELECT
  col.codigo,
  mar.imagen
FROM
  coleccion col,
  marcas mar
WHERE
  col.idmarca = mar.idmarca AND
  col.idcoleccion = '$idcoleccion'";
    //            MostrarConsulta($sql1);
    $dato = getTablaToArrayOfSQL($sql1);
    $ven = $dato["resultado"];
    $codigo = $ven[0]['codigo'];
    $imagen = $ven[0]['imagen'];
    $fecha = Date("Y-m-d");
    $time = date("h:i:s");
    $html .= "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN'>";
    $html .= "<html>";
    $html .= "<head>";
    $html .= "<title></title>";
    $html .= "<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>";
    $html .= "<link href='".$_SESSION["ruta"]."css/print.css' rel='stylesheet' type='text/css' media='all'>";
    //$html .= "<link href='../print.css' rel='stylesheet' type='text/css' media='all'>";
    $html .= "</head>";
    $html .= "<body>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
    $html .= "<tr>";
    //$html .= "<td style='width:400px;height:100px;border-bottom:1px solid #000000;'><img style='height:100px;' src='logo.jpg'>";
    $html .= "</td>";
    $html .= "<td style='width:150px;height:100px;border-bottom:1px solid #000000;text-align:center;font-size:20px;font-family:Tahoma;'>";
    $html .= "DETALLE <br>DE<br> COLECCION";
    $html .= "</td>";
    $html .= "<td style='width:200px;height:100px;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:200px;'>";
    //$html .= "<tr><td align='right'><img src='".$_SESSION["ruta"]."php/impl/codigo.jpg'><td><tr>";
    $html .= "<tr><td align='right' style='font-size:11px; font-family:Tahoma; text-align:center;font-weight:bold;'>".$ven1[0]['idventa']."<td><tr>";
    $html .= "</table>";
    $html .= "</td>";
    $html .= "</tr>";
    $html .= "<tr>";
    $html .= "<td colspan='3'>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
    //$html .= "<tr><td style='width:100px;font-size:11px;font-weight:bold;'></td><td style='width:500px;' ></td><td style='width:75px;font-size:11px;font-weight:bold;'>Numero:</td><td style='width:75px;'>".$ven1[0]['numerodocumento']."</td></tr>";
    $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Codigo Coleccion:<dd>".$codigo."</td></tr>";
    $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Fecha:<dd>".$fecha."</td></tr>";
    $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Hora: <dd>".$time."</td></tr>";
    $html .= "<tr><td style='width:100px;font-size:11px;font-weight:bold;'>Imagen:</td><td style='width:450px;'>".$imagen."</td></tr>";
    $html .="<br>";
    $html .= "</table>";
    $html .= "</td>";
    $html .= "</tr>";
    $html .= "<tr>";
    $html .= "<td colspan='3'>";

    $sqlIV = "
               SELECT
  carac.descripcionmaterial,
  carac.descripcioncolor,
  mode.stylename,
  li.numero
FROM
  caracteristicas carac,
  modelos mode,
  lineas li,
  calzados calz,
  coleccion cole
WHERE
  calz.idcaracteristica = carac.idcaracteristica AND
  mode.idlinea = li.idlinea AND
  calz.idmodelo = mode.idmodelo AND
  mode.idcoleccion = cole.idcoleccion AND
  cole.idcoleccion = '$idcoleccion'
                ";
    //         $totalDescuento = $ven[0]['descuento'];
    // $table =
    //    MostrarConsulta($sqlIV);
    $table = dibujarTablaOfSQL($sqlIV, $tc);
    //    $table = dibujarTablaOfSQL($sqlIV, "Productos");
    //    $table = dibujarTuplaOfSQLNormal($sqlIV, "Informacion del producto");
    $html .="<br>";
    $html .="<br>";
    $html .= $table['resultado'];
    $html .= "</td>";
    $html .= "</tr>";
    $html .= "<tr>";
    $html .= "<td colspan='3'>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
    //$html .= "<tr><td style='width:100px;font-size:11px;font-weight:bold;'>Son:</td><td style='width:450px;'>".convertir_a_letras($montoapagar, $ven[0]['abreviacion'])."</td></tr>";
    // $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Observaciones:</td><td>".$ven[0]['observacion']."</td></tr>";
    //$html .= "<tr><td style='font-size:11px;font-weight:bold;'>Emitido por:</td><td>".$ven[0]['login']."</td><td style='font-size:11px;font-weight:bold;'>Total credito (".$ven[0]['descuento']."):</td><td style='width:75px;text-align:right;'>".$totalCredito."</td></tr>";
    // $html .= "<tr><td style='font-size:11px;font-weight:bold;'></td><td></td><td style='font-size:11px;font-weight:bold;'>Total Venta :</td><td style='width:75px;text-align:right;'>".$montoapagar."</td></tr>";
    //        $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'>Foreground SRL</td></tr>";
    $html .= "</table>";
    $html .= "</td>";
    $html .= "</tr>";

    $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'><div id='pie'>
    <p>Calzados Balderrama<br />
         Cochabamba - Bolivia<br />

    </p>
</div></td></tr>";
    $html .= "</table>";
    $html .= "</body>";
    $html .= "</html>";
    if($return == true)
    {
        return $html;
    }
    else
    {
        echo $html;
    }

    //    }
}



function detalleModelo($idmarca, $return)
{
    //hoooooooooooooooooooooooo
    $html = "";


    $sql1= "SELECT

  mar.imagen
FROM

  marcas mar
WHERE
  mar.idmarca  = '$idmarca'";
    //            MostrarConsulta($sql1);
    $dato = getTablaToArrayOfSQL($sql1);
    $ven = $dato["resultado"];

    $imagen = $ven[0]['imagen'];
    $fecha = Date("Y-m-d");
    $time = date("h:i:s");
    $html .= "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN'>";
    $html .= "<html>";
    $html .= "<head>";
    $html .= "<title></title>";
    $html .= "<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>";
    $html .= "<link href='".$_SESSION["ruta"]."css/print.css' rel='stylesheet' type='text/css' media='all'>";
    //$html .= "<link href='../print.css' rel='stylesheet' type='text/css' media='all'>";
    $html .= "</head>";
    $html .= "<body>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
    $html .= "<tr>";
    //$html .= "<td style='width:400px;height:100px;border-bottom:1px solid #000000;'><img style='height:100px;' src='logo.jpg'>";
    $html .= "</td>";
    $html .= "<td style='width:150px;height:100px;border-bottom:1px solid #000000;text-align:center;font-size:20px;font-family:Tahoma;'>";
    $html .= "DETALLE <br>DE<br> COLECCION";
    $html .= "</td>";
    $html .= "<td style='width:200px;height:100px;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:200px;'>";
    //$html .= "<tr><td align='right'><img src='".$_SESSION["ruta"]."php/impl/codigo.jpg'><td><tr>";
    $html .= "<tr><td align='right' style='font-size:11px; font-family:Tahoma; text-align:center;font-weight:bold;'>".$ven1[0]['idventa']."<td><tr>";
    $html .= "</table>";
    $html .= "</td>";
    $html .= "</tr>";
    $html .= "<tr>";
    $html .= "<td colspan='3'>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
    //$html .= "<tr><td style='width:100px;font-size:11px;font-weight:bold;'></td><td style='width:500px;' ></td><td style='width:75px;font-size:11px;font-weight:bold;'>Numero:</td><td style='width:75px;'>".$ven1[0]['numerodocumento']."</td></tr>";
    $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Codigo Coleccion:<dd>".$codigo."</td></tr>";
    $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Fecha:<dd>".$fecha."</td></tr>";
    $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Hora: <dd>".$time."</td></tr>";
    $html .= "<tr><td style='width:100px;font-size:11px;font-weight:bold;'>Imagen:</td><td style='width:450px;'>".$imagen."</td></tr>";
    $html .="<br>";
    $html .= "</table>";
    $html .= "</td>";
    $html .= "</tr>";
    $html .= "<tr>";
    $html .= "<td colspan='3'>";

    $sqlIV = "
          SELECT
  mo.codigo,
  mo.stylename,
  mo.detalle,
  li.codigo AS linea,
  co.codigo AS coleccion
FROM
  modelos mo,
  `coleccion` co,
  `lineas` li
WHERE
  mo.idcoleccion = co.idcoleccion AND
  mo.idlinea = li.idlinea AND
  mo.idmarca = '$idmarca'
                ";
    //         $totalDescuento = $ven[0]['descuento'];
    // $table =
    //    MostrarConsulta($sqlIV);
    $table = dibujarTablaOfSQL($sqlIV, $tc);
    //    $table = dibujarTablaOfSQL($sqlIV, "Productos");
    //    $table = dibujarTuplaOfSQLNormal($sqlIV, "Informacion del producto");
    $html .="<br>";
    $html .="<br>";
    $html .= $table['resultado'];
    $html .= "</td>";
    $html .= "</tr>";
    $html .= "<tr>";
    $html .= "<td colspan='3'>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
    //$html .= "<tr><td style='width:100px;font-size:11px;font-weight:bold;'>Son:</td><td style='width:450px;'>".convertir_a_letras($montoapagar, $ven[0]['abreviacion'])."</td></tr>";
    // $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Observaciones:</td><td>".$ven[0]['observacion']."</td></tr>";
    //$html .= "<tr><td style='font-size:11px;font-weight:bold;'>Emitido por:</td><td>".$ven[0]['login']."</td><td style='font-size:11px;font-weight:bold;'>Total credito (".$ven[0]['descuento']."):</td><td style='width:75px;text-align:right;'>".$totalCredito."</td></tr>";
    // $html .= "<tr><td style='font-size:11px;font-weight:bold;'></td><td></td><td style='font-size:11px;font-weight:bold;'>Total Venta :</td><td style='width:75px;text-align:right;'>".$montoapagar."</td></tr>";
    //        $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'>Foreground SRL</td></tr>";
    $html .= "</table>";
    $html .= "</td>";
    $html .= "</tr>";

    $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'><div id='pie'>
    <p>Calzados Balderrama<br />
         Cochabamba - Bolivia<br />

    </p>
</div></td></tr>";
    $html .= "</table>";
    $html .= "</body>";
    $html .= "</html>";
    if($return == true)
    {
        return $html;
    }
    else
    {
        echo $html;
    }

    //    }
}
function DetalleIngresoHTML($idingreso, $return)
{
    $html = "";

    $html .= "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN'>";
    $html .= "<html>";
    $html .= "<head>";
    $html .= "<title></title>";
    $html .= "<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>";
    $html .= "<link href='".$_SESSION["ruta"]."css/print.css' rel='stylesheet' type='text/css' media='all'>";
    //$html .= "<link href='../print.css' rel='stylesheet' type='text/css' media='all'>";
    $html .= "</head>";
    $html .= "<body>";
    $html .= "<table cellpadding='1' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
    $html .= "<tr>";
    //$html .= "<td style='width:400px;height:100px;border-bottom:1px solid #000000;'><img style='height:100px;' src='logo.jpg'>";
    $html .= "</td>";
    $html .= "<td style='width:150px;height:100px;border-bottom:1px solid #000000;text-align:center;font-size:20px;font-family:Tahoma;'>";
    $html .= "REPORTE <br>DE<br> INGRESO A ALMACEN";
    $html .= "</td>";
    $html .= "<td style='width:200px;height:100px;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";

    $html .= "</tr>";

    $html .= "<td style='width:33%;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $sql = "SELECT pe.numerofactura, pe.fecha, pe.observacion, pe.totalpares, pe.totalcajas, pe.montototal, pe.estado, ma.opcion, ma.nombre AS marca, u.nombre AS responsable
FROM `ingresoalmacen` pe, `pedidos` ped, `marcas` ma, `usuario` u
WHERE pe.idpedido = ped.idpedido
AND ped.idmarca = ma.idmarca
AND pe.responsable = u.idusuario AND pe.idingreso = '$idingreso'";
    $proveedor = dibujarTuplaOfSQLNormal($sql, "Informacion del Ingreso");
    $html .= $proveedor['resultado'];

    $sql = "
SELECT mar.nombre AS marca, mdd.codigo AS modelo, kar.totalpares AS pares, kar.totalcajas AS cajas, kar.totalbs AS montototal,kar.idcliente AS cliente,kar.idvendedor AS vendedor
FROM `detalleingresoalmacen` kar, `modelos` mdd, `marcas` mar
WHERE kar.idmodelo = mdd.idmodelo
AND mdd.idmarca = mar.idmarca
AND kar.idingreso ='$idingreso'
";

    $proveedor = dibujarTablaOfSQLNormal($sql, "Detalle");
    $html .= $proveedor['resultado'];
    //    $html .= "</td>";
    //    $html .= "</tr>";
    //
    //    $html .= "<tr>";
    //
    //    $html .= "<td>";
    //    $html .= "</td>";
    //
    //    $html .= "</tr>";

    $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'><div id='pie'>
    <p>Calzados Balderrama<br />
         Cochabamba - Bolivia<br />
         Telf.
    </p>
</div></td></tr>";
    $html .= "</table>";
    $html .= "</body>";
    $html .= "</html>";
    if($return == true)
    {
        return $html;
    }
    else
    {
        echo $html;
    }

}

function reporteClienteCredito($idcliente, $return)
{
    $html = "";

    $html .= "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN'>";
    $html .= "<html>";
    $html .= "<head>";
    $html .= "<title></title>";
    $html .= "<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>";
    $html .= "<link href='".$_SESSION["ruta"]."css/print.css' rel='stylesheet' type='text/css' media='all'>";
    //$html .= "<link href='../print.css' rel='stylesheet' type='text/css' media='all'>";
    $html .= "</head>";
    $html .= "<body>";
    $html .= "<table cellpadding='1' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
    $html .= "<tr>";
    //$html .= "<td style='width:400px;height:100px;border-bottom:1px solid #000000;'><img style='height:100px;' src='logo.jpg'>";
    $html .= "</td>";
    $html .= "<td style='width:150px;height:100px;border-bottom:1px solid #000000;text-align:center;font-size:20px;font-family:Tahoma;'>";
    $html .= "REPORTE <br>DE<br> CREDITO";
    $html .= "</td>";
    $html .= "<td style='width:200px;height:100px;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:200px;'>";
    //$html .= "<tr><td align='right'><img src='".$_SESSION["ruta"]."php/codigo.jpg'><td><tr>";
    $html .= "<tr><td align='right' style='font-size:11px; font-family:Tahoma; text-align:center;font-weight:bold;'><td><tr>";
    $html .= "</table>";
    $html .= "</td>";
    $html .= "</tr>";
    $html .= "<tr>";
    $html .= "<td style='width:33%;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $sql = "SELECT c.numero, cm.nombre AS comunidad, t.nombre AS tipo, c.nombre, c.apellido1, c.apellido2, c.nit, c.telefono, c.celular, c.email,
     c.direccion, a.nombre AS almacen FROM cliente c, comunidades cm, tipocliente t,almacenes a WHERE c.idcomunidad = cm.idcomunidad AND c.idalmacen=a.idalmacen
     AND c.idtipocliente = t.idtipocliente AND c.idcliente = '$idcliente'";
    $producto = dibujarTuplaOfSQLNormal($sql, "Informacion del Cliente");
    $html .= $producto['resultado'];
    $html .= "</td>";
    $html .= "<td style='width:33%;text-align:right;font-size:11px;font-family:Tahoma;' valign='top'>";
    //$sqlCar = "SELECT  kc.observacion, kc.fecha,kc.deposito, kc.retiro,kc.saldo FROM cliente c, kardexcliente kc WHERE c.idcliente = kc.idcliente AND kc.idcliente  = '$idcliente'";
    //$carac = dibujarTablaOfSQLNormal($sqlCar, "Kardex de Cliente");
    //$html .= $carac['resultado'];
    //$html .="<br>";here
    $sqlKar = "SELECT

                  cr.idcredito AS codigo,
                  cr.idventa AS venta,
                  cr.fecha,
                  cr.hora,
                  cr.tiempo AS plazo,
                  cr.montototal,
                  mc.saldo
                FROM
                  credito cr,
                  movimientocredito mc,
                  cliente c,
                  ventas v
                WHERE
                  c.idcliente = cr.idcliente AND
                  cr.idventa = v.idventa AND
                  mc.idcredito = cr.idcredito AND
                  cr.idcliente = '$idcliente'
            ";
    $kardex = dibujarTablaOfSQLNormal($sqlKar, "Creditos");
    $html .= $kardex['resultado'];
    $html .= "</td>";
    $html .= "<td style='width:33%;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";

    $html .= "</td>";
    $html .= "</tr>";
    $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'><div id='pie'>
    <p>Importadora Asia<br />
         Cochabamba - Bolivia<br />
         Telf. 4555651
    </p>
</div></td></tr>";
    $html .= "</table>";
    $html .= "</body>";
    $html .= "</html>";
    if($return == true)
    {
        return $html;
    }
    else
    {
        echo $html;
    }

}



function reporteTraspaso($idtraspaso, $return)
{
    $html = "";

    $html .= "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN'>";
    $html .= "<html>";
    $html .= "<head>";
    $html .= "<title></title>";
    $html .= "<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>";
    $html .= "<link href='".$_SESSION["ruta"]."css/print.css' rel='stylesheet' type='text/css' media='all'>";
    //$html .= "<link href='../print.css' rel='stylesheet' type='text/css' media='all'>";
    $html .= "</head>";
    $html .= "<body>";
    $html .= "<table cellpadding='1' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
    $html .= "<tr>";
    //$html .= "<td style='width:400px;height:100px;border-bottom:1px solid #000000;'><img style='height:100px;' src='logo.jpg'>";
    $html .= "</td>";
    $html .= "<td style='width:150px;height:100px;border-bottom:1px solid #000000;text-align:center;font-size:20px;font-family:Tahoma;'>";
    $html .= "REPORTE <br>DE<br> TRASPASO";
    $html .= "</td>";
    $html .= "<td style='width:200px;height:100px;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";

    $html .= "</tr>";

    $html .= "<td style='width:33%;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $sql = "SELECT a.codigo AS Codigo,a.nombre AS AlmacenOrigen, t.almacendestino AS AlmacenDestino ,t.fecha, t.numerodocumento AS documento
    FROM almacenes a, traspaso t  WHERE t.idalmacen=a.idalmacen AND t.idtraspaso = '$idtraspaso'";
    $proveedor = dibujarTuplaOfSQLNormal($sql, "Informacion del Traspaso");
    $html .= $proveedor['resultado'];

    $sql = "
SELECT
  prod.nombre,
  prod.codigo,
  dtr.cantidad,
  tra.almacendestino,
  tra.fecha
FROM
  traspaso tra,
  detalletraspaso dtr,
  productos prod
WHERE
  prod.idproducto = dtr.idproducto AND
  tra.idtraspaso = dtr.idtraspaso AND
  tra.idtraspaso = '$idtraspaso'
";

    $proveedor = dibujarTablaOfSQLNormal($sql, "Detalle");
    $html .= $proveedor['resultado'];
    //    $html .= "</td>";
    //    $html .= "</tr>";
    //
    //    $html .= "<tr>";
    //
    //    $html .= "<td>";
    //    $html .= "</td>";
    //
    //    $html .= "</tr>";

    $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'><div id='pie'>
    <p>Calzados Balderrama<br />
         Cochabamba - Bolivia<br />
         Telf.
    </p>
</div></td></tr>";
    $html .= "</table>";
    $html .= "</body>";
    $html .= "</html>";
    if($return == true)
    {
        return $html;
    }
    else
    {
        echo $html;
    }

}


function reporteEntregaventa($identrega, $return)
{//opcional
    $html = "";

    $html .= "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN'>";
    $html .= "<html>";
    $html .= "<head>";
    $html .= "<title></title>";
    $html .= "<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>";
    $html .= "<link href='".$_SESSION["ruta"]."css/print.css' rel='stylesheet' type='text/css' media='all'>";
    //$html .= "<link href='../print.css' rel='stylesheet' type='text/css' media='all'>";
    $html .= "</head>";
    $html .= "<body>";
    $html .= "<table cellpadding='1' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
    $html .= "<tr>";
    $html .= "<td style='width:400px;height:100px;border-bottom:1px solid #000000;'><img style='height:100px;' src='".$_SESSION["ruta"]."php/configuracion/".$_SESSION["empresa"]."/".$producto[0]['link']."'>";
    $html .= "</td>";
    $html .= "<td style='width:150px;height:100px;border-bottom:1px solid #000000;text-align:center;font-size:20px;font-family:Tahoma;'>";
    $html .= "REPORTE <br>DE<br>ENTREGA";
    $html .= "</td>";
    $html .= "<td style='width:200px;height:100px;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:200px;'>";
    $html .= "<tr><td align='right'><img src='".$_SESSION["ruta"]."php/codigo.jpg'><td><tr>";
    $html .= "<tr><td align='right' style='font-size:11px; font-family:Tahoma; text-align:center;font-weight:bold;'><td><tr>";
    $html .= "</table>";
    $html .= "</td>";
    $html .= "</tr>";
    $html .= "<tr>";
    $html .= "<td>";
    $html .= "</td>";
    $html .= "<td style='width:33%;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $sql = "SELECT pv.codigo AS Codigo,tp.nombre AS tipo,ci.nombre AS Ciudad,pv.nombre AS Proveedor,pv.representante AS Representante,pv.direccion, cp.idcuentaproveedor AS Cuenta
    FROM tipoproveedor tp,proveedores pv,ciudades ci ,cuentaproveedor cp WHERE cp.idproveedor=pv.idproveedor AND pv.idtipoproveedor=tp.idtipoproveedor AND pv.idciudad=ci.idciudad AND pv.idproveedor = '$idproveedor'";
    $proveedor = dibujarTuplaOfSQLNormal($sql, "Informacion de la entrega");
    $html .= $proveedor['resultado'];
    $html .= "</td>";
   /* $html .= "<td style='width:33%;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $sql = "SELECT pv.codigo AS Codigo,tp.nombre AS tipo,ci.nombre AS Ciudad,pv.nombre AS Proveedor,pv.representante AS Representante,pv.direccion
    FROM tipoproveedor tp,proveedores pv,ciudades ci WHERE pv.idtipoproveedor=tp.idtipoproveedor AND pv.idciudad=ci.idciudad AND pv.idproveedor = '$idproveedor'";
    $proveedor = dibujarTuplaOfSQLNormal($sql, "Cuenta  Proveedor");
    $html .= $proveedor['resultado'];
    $html .= "</td>";*/

    $html .= "</tr>";

    $html .= "<tr>";

    $html .= "<td>";
    $html .= "</td>";
    $html .= "<td>";
    $sql = "SELECT tp.fecha,tp.hora,tp.deposito,tp.retiro,tp.saldo,tp.idcompra
    FROM proveedores pv, transaccionproveedor tp WHERE  tp.idproveedor=pv.idproveedor AND tp.idproveedor = '$idproveedor'";
    $proveedor = dibujarTablaOfSQLNormal($sql, "Productos por entrega");
    $html .= $proveedor['resultado'];
    $html .= "</td>";
    $html .= "</tr>";

    $html .= "<tr>";

    $html .= "<td>";
    $html .= "</td>";
    $html .= "<td style='width:33%;text-align:right;font-size:11px;font-family:Tahoma;' valign='top'>";

    $sqlCar = "SELECT c.fecha,c.hora,c.idcompra,c.observacion,c.montototal,c.descuento,c.montoapagar FROM proveedores pv , compra c WHERE c.idproveedor=pv.idproveedor AND c.idproveedor = '$idproveedor'";
    $sqlCar1 = "SELECT * FROM proveedores pv , compra c WHERE c.idcompra=i.idcompra AND c.idproveedor=pv.idproveedor AND c.idproveedor = '$idproveedor'";
    $idcompra = $sqlCar1['idcompra'];

    $sqlitem = "SELECT  SUM(i.cantidad) AS total FROM proveedores pv, compra c,items i WHERE i.idcompra=c.idcompra AND c.idcompra=i.idcompra AND c.idproveedor=pv.idproveedor AND c.idproveedor = '$idproveedor' ";
    $total = $sqlitem['total'];

    $carac = dibujarTablaOfSQLNormal($sqlCar, "Compras del Proveedor");
    $html .= $carac['resultado'];
    $html .="<br>";
    $html .= "</td>";
    $html .= "</tr>";

    $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'><div id='pie'>
    <p>Importadora Asia<br />
         Cochabamba - Bolivia<br />
         Telf. 4555651
    </p>
</div></td></tr>";
    $html .= "</table>";
    $html .= "</body>";
    $html .= "</html>";
    if($return == true)
    {
        return $html;
    }
    else
    {
        echo $html;
    }

}
function reporteEntregacompra($idcompra, $return)
{
    $html = "";

    $html .= "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN'>";
    $html .= "<html>";
    $html .= "<head>";
    $html .= "<title></title>";
    $html .= "<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>";
    $html .= "<link href='".$_SESSION["ruta"]."css/print.css' rel='stylesheet' type='text/css' media='all'>";
    //$html .= "<link href='../print.css' rel='stylesheet' type='text/css' media='all'>";
    $html .= "</head>";
    $html .= "<body>";
    $html .= "<table cellpadding='1' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
    $html .= "<tr>";
    $html .= "<td style='width:400px;height:100px;border-bottom:1px solid #000000;'><img style='height:100px;' src='".$_SESSION["ruta"]."php/configuracion/".$_SESSION["empresa"]."/".$producto[0]['link']."'>";
    $html .= "</td>";
    $html .= "<td style='width:150px;height:100px;border-bottom:1px solid #000000;text-align:center;font-size:20px;font-family:Tahoma;'>";
    $html .= "REPORTE <br>DE<br>ENTREGA";
    $html .= "</td>";
    $html .= "<td style='width:200px;height:100px;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:200px;'>";
    $html .= "<tr><td align='right'><img src='".$_SESSION["ruta"]."php/codigo.jpg'><td><tr>";
    $html .= "<tr><td align='right' style='font-size:11px; font-family:Tahoma; text-align:center;font-weight:bold;'><td><tr>";
    $html .= "</table>";
    $html .= "</td>";
    $html .= "</tr>";
    $html .= "<tr>";
    $html .= "<td>";
    $html .= "</td>";
    $html .= "<td style='width:33%;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $sql = "SELECT ec.identregacompra AS entrega,ec.idcompra AS compra,ec.fecha,ec.hora,ec.montoacuenta,ec.saldo
    FROM compra c,entregacompra ec WHERE ec.idcompra=c.idcompra AND ec.idcompra = '$idcompra'";
    $proveedor = dibujarTablaOfSQLNormal($sql, "Informacion de la entrega");
    $html .= $proveedor['resultado'];
    $html .= "</td>";
    $html .= "</tr>";
    $html .= "<tr>";
    $html .= "<td>";
    $html .= "</td>";
    $html .= "<td>";
    $sql = "SELECT ec.identregacompra AS entrega,ei.idproducto AS codigo,ei.nombre,ei.detalle,ei.color,ei.precio,ei.cantidad,ei.preciobs,ei.total
    FROM compra c,entregacompra ec, entregaitems ei,productos p WHERE ei.idproducto=p.idproducto AND ei.identregacompra=ec.identregacompra AND ec.idcompra=c.idcompra AND ec.idcompra = '$idcompra'";
    $proveedor = dibujarTablaOfSQLNormal($sql, "Productos por entrega");
    $html .= $proveedor['resultado'];
    $html .= "</td>";
    $html .= "</tr>";

    $html .= "<tr>";

    $html .= "<td>";
    $html .= "</td>";
    $html .= "<td style='width:33%;text-align:right;font-size:11px;font-family:Tahoma;' valign='top'>";

    $sqlCar = "SELECT c.fecha,c.hora,c.idcompra,c.observacion,c.montototal,c.descuento,c.montoapagar FROM proveedores pv , compra c WHERE c.idproveedor=pv.idproveedor AND c.idproveedor = '$idproveedor'";
    $sqlCar1 = "SELECT * FROM proveedores pv , compra c WHERE c.idcompra=i.idcompra AND c.idproveedor=pv.idproveedor AND c.idproveedor = '$idproveedor'";
    $idcompra = $sqlCar1['idcompra'];

    $sqlitem = "SELECT  SUM(i.cantidad) AS total FROM proveedores pv, compra c,items i WHERE i.idcompra=c.idcompra AND c.idcompra=i.idcompra AND c.idproveedor=pv.idproveedor AND c.idproveedor = '$idproveedor' ";
    $total = $sqlitem['total'];

    $carac = dibujarTablaOfSQLNormal($sqlCar, "Compras del Proveedor");
    $html .= $carac['resultado'];
    $html .="<br>";
    $html .= "</td>";
    $html .= "</tr>";

    $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'><div id='pie'>
    <p>Importadora Asia<br />
         Cochabamba - Bolivia<br />
         Telf. 4555651
    </p>
</div></td></tr>";
    $html .= "</table>";
    $html .= "</body>";
    $html .= "</html>";
    if($return == true)
    {
        return $html;
    }
    else
    {
        echo $html;
    }

}


function reporteProforma($idproforma, $return)
{

    $html = "";
    $sql = "
SELECT
  pr.idproforma,
  pr.fecha,
  pr.nombre,
  pr.nit,
  pr.montototal,
  pr.descuento,
  pr.montoapagar,
  pr.validez,
  pr.referencia,
  pr.numero,
  CONCAT(usr.nombre,' ', usr.apellido1,' ',usr.apellido2) AS cajero

FROM
  proforma pr,
  usuario usr
WHERE
  pr.idproforma = '$idproforma' AND
  pr.idusuario = usr.idusuario
";


    $datos = getTablaToArrayOfSQL($sql);



    if($datos['error'] == "false")
    {
        echo "No existe esta ventaA";
        exit;
    }
    else
    {
        $ven = $datos["resultado"];
        /*aqui modificamos los campos segun la monedad */
        $totalMonto = $ven[0]['montototal'];
        //        $totalCredito = $ven[0]['descuento'];
        $totalDescuento = $ven[0]['descuento'];
        $totalNeto = $ven[0]['montoapagar'];
        $fecha = $ven[0]['fecha'];
        $cajero = $ven[0]['cajero'];



        $tc = $ven[0]['monto'];;

        //        $totalMonto = $totalMonto/$tc;
        //        $totalCredito = $totalCredito/$tc;
        //        $totalDescuento = $totalDescuento/$tc;
        //        $totalNeto = $totalNeto/$tc;

        $totalMonto = redondear($totalMonto, $_SESSION['usrDigitos']);
        $totalCredito = redondear($totalCredito, $_SESSION['usrDigitos']);
        $totalDescuento = redondear($totalDescuento, $_SESSION['usrDigitos']);
        $totalNeto = redondear($totalNeto, $_SESSION['usrDigitos']);

/*aqui modificamos los campos segun la monedad */


        $html .= "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN'>";
        $html .= "<html>";
        $html .= "<head>";
        $html .= "<title></title>";
        $html .= "<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>";
        $html .= "<link href='".$_SESSION["ruta"]."css/print.css' rel='stylesheet' type='text/css' media='all'>";
        //$html .= "<link href='../print.css' rel='stylesheet' type='text/css' media='all'>";
        $html .= "</head>";
        $html .= "<body>";
        $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
        $html .= "<tr>";
        //$html .= "<td style='width:400px;height:100px;border-bottom:1px solid #000000;'><img style='height:100px;' src='logo.jpg'>";
        $html .= "</td>";
        $html .= "<td style='width:150px;height:100px;border-bottom:1px solid #000000;text-align:center;font-size:20px;font-family:Tahoma;'>";
        $html .= "<h2>PROFORMA</h2><br>";
        $html .= "</td>";
        $html .= "<td style='width:200px;height:100px;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";
        $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:200px;'>";
        $html .= "<tr><td align='right'><td><tr>";
        $html .= "<tr><td align='right' style='font-size:11px; font-family:Tahoma; text-align:center;font-weight:bold;'>".$ven[0]['idproforma']."<td><tr>";
        $html .= "</table>";
        $html .= "</td>";
        $html .= "</tr>";
        $html .= "<tr>";
        $html .= "<td colspan='3'>";
        $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
        $html .= "<tr><td style='width:100px;font-size:11px;font-weight:bold;'>Cliente:</td><td style='width:500px;' >".$ven[0]['nombre']."</td><td style='width:75px;font-size:11px;font-weight:bold;'>Numero:</td><td style='width:75px;'>".$ven[0]['numero']."</td></tr>";
        $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Nit o CI:</td><td>".$ven[0]['nit']."</td><td style='font-size:11px;font-weight:bold;'>Validez</td><td>".$ven[0]['validez']." Dias.</td></tr>";
        $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Telefono:</td><td></td><td style='font-size:11px;font-weight:bold;'>Fecha:</td><td>".$ven[0]['fecha']."</td></tr>";
        $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Por lo siguiente...</td><td></td><td style='font-size:11px;font-weight:bold;'></td><td></td></tr>";
        $html .= "</table>";
        $html .= "</td>";
        $html .= "</tr>";
        $html .= "<tr>";
        $html .= "<td colspan='3'>";
        $sqlIV = "

SELECT
  itm.cantidad,
  itm.precio,
  pro.nombre,
  prv.nombre As proveedor,
  itm.total
FROM
  itemproforma itm,
  productos pro,
  proveedores prv
WHERE
  itm.idproducto = pro.idproducto AND
  pro.idproveedor = prv.idproveedor AND
  itm.idproforma = '$idproforma'
";

        $table = dibujarTablaOfSQL($sqlIV, $tc);
        $html .= $table['resultado'];
        $html .= "</td>";
        $html .= "</tr>";
        $html .= "<tr>";
        $html .= "<td colspan='3'>";
        $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
        $html .= "<tr><td style='width:100px;font-size:11px;font-weight:bold;'>Son:</td><td style='width:450px;'>".convertir_a_letras($totalNeto, $ven[0]['abreviacion'])."</td><td style='width:125px;font-size:11px;font-weight:bold;'>Total Precio (".$ven[0]['abreviacion']."):</td><td style='width:75px;text-align:right;'>".$totalMonto."</td></tr>";
        $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Observaciones:</td><td>Proforma Valida Con Sello y Firma.</td><td style='font-size:11px;font-weight:bold;'>Total Desc (".$ven[0]['abreviacion']."):</td><td style='width:75px;text-align:right;'>".$totalDescuento."</td></tr>";
        $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Emitido por:</td><td>$cajero</td><td style='font-size:11px;font-weight:bold;'>Total credito (".$ven[0]['abreviacion']."):</td><td style='width:75px;text-align:right;'>".$totalCredito."</td></tr>";
        $html .= "<tr><td style='font-size:11px;font-weight:bold;'></td><td></td><td style='font-size:11px;font-weight:bold;'>Total Venta (".$ven[0]['abreviacion']."):</td><td style='width:75px;text-align:right;'>".$totalNeto."</td></tr>";
        $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'><div id='pie'>
    <p>Importadora Asia<br />
         Cochabamba - Bolivia<br />
         Telf. 4555651
    </p>
</div></td></tr>";
        $html .= "</table>";
        $html .= "</td>";
        $html .= "</tr>";
        $html .= "</table>";
        $html .= "</body>";
        $html .= "</html>";
        if($return == true)
        {
            return $html;
        }
        else
        {
            echo $html;
        }
    }

}





//prueba
function reportecuentaproveedorHTML($idproveedor, $return)
{
    $html = "";

    $html .= "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN'>";
    $html .= "<html>";
    $html .= "<head>";
    $html .= "<title></title>";
    $html .= "<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>";
    $html .= "<link href='".$_SESSION["ruta"]."css/print.css' rel='stylesheet' type='text/css' media='all'>";
    //$html .= "<link href='../print.css' rel='stylesheet' type='text/css' media='all'>";
    $html .= "</head>";
    $html .= "<body>";
    $html .= "<table cellpadding='1' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
    $html .= "<tr>";
    $html .= "<td style='width:400px;height:100px;border-bottom:1px solid #000000;'><img style='height:100px;' src='".$_SESSION["ruta"]."php/configuracion/".$_SESSION["empresa"]."/".$producto[0]['link']."'>";
    $html .= "</td>";
    $html .= "<td style='width:150px;height:100px;border-bottom:1px solid #000000;text-align:center;font-size:20px;font-family:Tahoma;'>";
    $html .= "REPORTE <br>CUENTA<br>PROVEEDOR ";
    $html .= "</td>";
    $html .= "<td style='width:200px;height:100px;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:200px;'>";
    $html .= "<tr><td align='right'><img src='".$_SESSION["ruta"]."php/codigo.jpg'><td><tr>";
    $html .= "<tr><td align='right' style='font-size:11px; font-family:Tahoma; text-align:center;font-weight:bold;'><td><tr>";
    $html .= "</table>";
    $html .= "</td>";
    $html .= "</tr>";
    $html .= "<td style='width:33%;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";

    $html .= "</td>";

    $html .= "<tr>";
    $html .= "<td style='width:33%;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";

    $html .= "</td>";

    $html .= "<td style='width:33%;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $sql = "SELECT pv.codigo AS Codigo,tp.nombre AS tipo,ci.nombre AS Ciudad,pv.nombre AS Proveedor,pv.representante AS Representante,pv.direccion,cu.codigo AS Cuenta,cu.fecha AS registro,cu.detalle
    FROM tipoproveedor tp,proveedores pv,ciudades ci, cuentaproveedor cu WHERE pv.idtipoproveedor=tp.idtipoproveedor AND pv.idproveedor=cu.idproveedor AND pv.idciudad=ci.idciudad AND tp.idtipoproveedor='tpr-1001'AND pv.idproveedor = '$idproveedor'";
    $proveedor = dibujarTuplaOfSQLNormal($sql, "Informacion del Proveedor");
    $html .= $proveedor['resultado'];

    $html .= "</td>";
    $html .= "</tr>";
    $html .= "<td style='width:33%;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";

    $html .= "</td>";

    $html .= "<td style='width:33%;text-align:right;font-size:11px;font-family:Tahoma;' valign='top'>";
    $sqlCar = "SELECT tpr.numero, tpr.fecha, tpr.hora, tpr.deposito,tpr.retiro, tpr.saldo
    FROM tipoproveedor tp,proveedores pv,cuentaproveedor cu,transaccionproveedor tpr WHERE pv.idtipoproveedor=tp.idtipoproveedor AND pv.idproveedor=cu.idproveedor AND cu.idcuentaproveedor=tpr.idcuentaproveedor AND tp.idtipoproveedor='tpr-1001'AND pv.idproveedor = '$idproveedor'";
    $carac = dibujarTablaOfSQLNormal($sqlCar, "transacciones del Proveedor");
    $html .= $carac['resultado'];
    $html .="<br>";
   /* $sqlKar = "SELECT co.idcompra, p.nombre AS Producto, c.nombre AS Categoria, p.unidad, i.preciobs AS Precio, i.preciosus AS Precio, i.cantidad, i.total
FROM proveedores pv, items i, productos p, categorias c, productoproveedor pp, compra co WHERE pp.idproducto = p.idproducto AND pp.idproveedor = pv.idproveedor
AND p.idcategoria = c.idcategoria AND co.idcompra = i.idcompra AND pv.idproveedor = co.idproveedor AND co.idproveedor = '$idproveedor'";
    $kardex = dibujarTablaOfSQLNormal($sqlKar, "Productos por cada Compra");
    $html .= $kardex['resultado'];*/
    $html .= "</td>";
    $html .= "</tr>";

    $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'><div id='pie'>
    <p>Importadora Asia<br />
         Cochabamba - Bolivia<br />
         Telf. 4555651
    </p>
</div></td></tr>";
    $html .= "</table>";
    $html .= "</body>";
    $html .= "</html>";
    if($return == true)
    {
        return $html;
    }
    else
    {
        echo $html;
    }

}


function dibujarTablaOfSQLNormal($sql, $titulo = "ninguno")
{
    if($link=new BD)
    {
        if($link->conectar())
        {
            if($re = $link->consulta($sql))
            {
                //echo mysql_num_rows($re);
                if($fi = mysql_fetch_array($re))
                {
                    $devS .= "<table cellpadding='0' cellspacing='0' border='0' style='width:100%;border:1px solid #000000;font-size:11px;'>";
                    if($titulo != "ninguno")
                    {
                        $devS .= "<tr><td colspan='".(mysql_num_fields($re)+1)."' style='border-bottom:1px solid #000000;font-weight:bold;font-size:11px;text-align:center;background-color:silver;'>$titulo</td></tr>";
                    }
                    $devS .= "<tr><td style='border-bottom:1px solid #000000;font-weight:bold;font-size:11px;text-align:center;background-color:silver;'>Nro</td>";

                    //dibjamos las cabeceras



                    for($zz = 0; $zz < mysql_num_fields($re); $zz++)
                    {
                        $devS .= "<td style='border-bottom:1px solid #000000;border-left:1px solid #000000;font-weight:bold;font-size:11px;text-align:center;background-color:silver;'>".mysql_field_name($re, $zz)."</td>";
                    }
                    $devS .= "</tr>";
                    $ii = 0;
                    //$totalCount = mysql_num_rows($re);
                    $z = 1;
                    do{
                        $devS .= "<tr><td style='text-align:center'>".$z."</td>";
                        for($i = 0; $i< mysql_num_fields($re); $i++)
                        {
                            if(mysql_field_type($re, $i) == "real")
                            {
                                $dato = $fi[$i];
                                if(mysql_field_name($re, $i) == "precio" || mysql_field_name($re, $i) == "importe")
                                {
                                    //                                    $dato = $fi[$i]/$tc;
                                    $dato = $fi[$i];
                                }
                                $devS .= "<td style='text-align:right;border-left: 1px solid #000000;'>&nbsp;".redondear($dato)."&nbsp;</td>";
                            }
                            else
                            {
                                $devS .= "<td style='border-left: 1px solid #000000;'>&nbsp;".$fi[$i]."&nbsp;</td>";
                            }
                        }
                        $devS .= "</tr>";
                        $ii++;
                        $z ++;
                    }while($fi = mysql_fetch_array($re));

                    $devS .= "</table>";

                    $dev['mensaje'] = "Existen resultados";
                    $dev['error']   = "true";
                    $dev['resultado'] = $devS;

                }
                else
                {
                    $dev['mensaje'] = "No se encontro datos en la consulta2".mysql_error();
                    $dev['error']   = "false";
                    $dev['resultado'] = "";
                }
            }
            else
            {
                $dev['mensaje'] = "Error en la consulta";
                $dev['error']   = "false";
                $dev['resultado'] = "";
            }
        }
        else
        {
            $dev['mensaje'] = "No se pudo conectar a la BD";
            $dev['error']   = "false";
            $dev['resultado'] = "";
        }
    }
    else
    {
        $dev['mensaje'] = "No se pudo crear la conexion a la BD";
        $dev['error']   = "false";
        $dev['resultado'] = "";
    }
    return $dev;
}
function dibujarTablatotalOfSQLNormal($sql, $titulo = "ninguno",$pie = "ninguno")
{
    if($link=new BD)
    {
        if($link->conectar())
        {
            if($re = $link->consulta($sql))
            {
                //echo mysql_num_rows($re);
                if($fi = mysql_fetch_array($re))
                {
                    $devS .= "<table cellpadding='0' cellspacing='0' border='0' style='width:100%;border:1px solid #000000;font-size:11px;'>";
                    if($titulo != "ninguno")
                    {
                        $devS .= "<tr><td colspan='".(mysql_num_fields($re)+1)."' style='border-bottom:1px solid #000000;font-weight:bold;font-size:11px;text-align:center;background-color:silver;'>$titulo</td></tr>";
                        //           $devvS .= "<td><td colspan='".(mysql_num_fields($re)-1)."' style='border-bottom:1px solid #000000;font-weight:bold;font-size:11px;text-align:center;background-color:silver;'>$total</td></tr>";

                    }
                    $devS .= "<tr><td style='border-bottom:1px solid #000000;font-weight:bold;font-size:11px;text-align:center;background-color:silver;'>Nro</td>";
                    //                   $devvS .= "<tr><td style='border-bottom:1px solid #000000;font-weight:bold;font-size:11px;text-align:center;background-color:silver;'>Total</td>";

                    //dibjamos las cabeceras



                    for($zz = 0; $zz < mysql_num_fields($re); $zz++)
                    {
                        $devS .= "<td style='border-bottom:1px solid #000000;border-left:1px solid #000000;font-weight:bold;font-size:11px;text-align:center;background-color:silver;'>".mysql_field_name($re, $zz)."</td>";
                    }
                    $devS .= "</tr>";
                    $ii = 0;
                    //$totalCount = mysql_num_rows($re);
                    $z = 1;
                    do{
                        $devS .= "<tr><td style='text-align:center'>".$z."</td>";
                        for($i = 0; $i< mysql_num_fields($re); $i++)
                        {
                            if(mysql_field_type($re, $i) == "real")
                            {
                                $dato = $fi[$i];
                                if(mysql_field_name($re, $i) == "precio" || mysql_field_name($re, $i) == "importe")
                                {
                                    //                                    $dato = $fi[$i]/$tc;
                                    $dato = $fi[$i];
                                }
                                $devS .= "<td style='text-align:right;border-left: 1px solid #000000;'>&nbsp;".redondear($dato)."&nbsp;</td>";
                            }
                            else
                            {
                                $devS .= "<td style='border-left: 1px solid #000000;'>&nbsp;".$fi[$i]."&nbsp;</td>";
                            }
                        }
                        $devS .= "</tr>";
                        $ii++;
                        $z ++;
                    }while($fi = mysql_fetch_array($re));
                    //dibujamos pie
                    if($pie != "ninguno")
                    {
                        $devS .= "<tr><td colspan='".(mysql_num_fields($re)+1)."' style='border-bottom:1px solid #000000;font-weight:bold;font-size:11px;text-align:center;background-color:silver;'></td></tr>";
                    }
                    $devS .= "<tr><td style='border-bottom:1px solid #000000;font-weight:bold;font-size:11px;text-align:center;background-color:silver;'>Total</td>";

                    $devS .= "</table>";

                    $dev['mensaje'] = "Existen resultados";
                    $dev['error']   = "true";
                    $dev['resultado'] = $devS;

                }
                else
                {
                    $dev['mensaje'] = "No se encontro datos en la consulta2".mysql_error();
                    $dev['error']   = "false";
                    $dev['resultado'] = "";
                }
            }
            else
            {
                $dev['mensaje'] = "Error en la consulta";
                $dev['error']   = "false";
                $dev['resultado'] = "";
            }
        }
        else
        {
            $dev['mensaje'] = "No se pudo conectar a la BD";
            $dev['error']   = "false";
            $dev['resultado'] = "";
        }
    }
    else
    {
        $dev['mensaje'] = "No se pudo crear la conexion a la BD";
        $dev['error']   = "false";
        $dev['resultado'] = "";
    }
    return $dev;
}

function generarSalidaMaterialMediaCartaChorro($idalmacen, $return)
{
    $html = "";
    $sql = "SELECT
  v.idalmacen,
  v.codigo,
  v.nombre,
  v.responsable,
  v.direccion,
  v.telefono
FROM
  almacenes v
WHERE
  v.idalmacen = '$idalmacen'";
    $datos = getTablaToArrayOfSQL($sql);
    //echo $datos['error'];
    if($datos['error'] == "false")
    {
        echo "No existe esta venta";
        exit;
    }
    else
    {
        $ven = $datos["resultado"];
        /*aqui modificamos los campos segun la monedad */
        $totalMonto = $ven[0]['bruta'];
        $totalCredito = $ven[0]['credito'];
        $totalDescuento = $ven[0]['descuento'];
        $totalNeto = $ven[0]['neto'];
        $tc = $ven[0]['monto'];;

        //        $totalMonto = $totalMonto/$tc;
        //        $totalCredito = $totalCredito/$tc;
        //        $totalDescuento = $totalDescuento/$tc;
        //        $totalNeto = $totalNeto/$tc;

        $totalMonto = redondear($totalMonto, $_SESSION['usrDigitos']);
        $totalCredito = redondear($totalCredito, $_SESSION['usrDigitos']);
        $totalDescuento = redondear($totalDescuento, $_SESSION['usrDigitos']);
        $totalNeto = redondear($totalNeto, $_SESSION['usrDigitos']);

/*aqui modificamos los campos segun la monedad */


        $html .= "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN'>";
        $html .= "<html>";
        $html .= "<head>";
        $html .= "<title></title>";
        $html .= "<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>";
        $html .= "<link href='".$_SESSION["ruta"]."css/print.css' rel='stylesheet' type='text/css' media='all'>";
        //$html .= "<link href='../print.css' rel='stylesheet' type='text/css' media='all'>";
        $html .= "</head>";
        $html .= "<body>";
        $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
        $html .= "<tr>";
        $html .= "<td style='width:400px;height:100px;border-bottom:1px solid #000000;'><img style='height:100px;' src='".$_SESSION["ruta"]."php/configuracion/".$_SESSION["empresa"]."/".$ven[0]['link']."'>";
        $html .= "</td>";
        $html .= "<td style='width:150px;height:100px;border-bottom:1px solid #000000;text-align:center;font-size:20px;font-family:Tahoma;'>";
        $html .= "SALIDA <br>DE<br> MATERIAL";
        $html .= "</td>";
        $html .= "<td style='width:200px;height:100px;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";
        $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:200px;'>";
        $html .= "<tr><td align='right'><img src='".$_SESSION["ruta"]."php/impl/logo/codigo.png'><td><tr>";
        $html .= "<tr><td align='right' style='font-size:11px; font-family:Tahoma; text-align:center;font-weight:bold;'>".$ven[0]['idalmacen']."<td><tr>";
        $html .= "</table>";
        $html .= "</td>";
        $html .= "</tr>";
        $html .= "<tr>";
        $html .= "<td colspan='3'>";
        $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
        $html .= "<tr><td style='width:100px;font-size:11px;font-weight:bold;'>Cliente:</td><td style='width:500px;' >".$ven[0]['nomCliente']."</td><td style='width:75px;font-size:11px;font-weight:bold;'>Numero:</td><td style='width:75px;'>".$ven[0]['numeroimpresion']."</td></tr>";
        $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Direccion:</td><td>".$ven[0]['direccion']."</td><td style='font-size:11px;font-weight:bold;'>T/C (Bs/".$ven[0]['codigo'].")</td><td>".$tc."</td></tr>";
        $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Telefono:</td><td></td><td style='font-size:11px;font-weight:bold;'>Fecha:</td><td>".$ven[0]['nombre']."</td></tr>";
        $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Por lo siguiente...</td><td></td><td style='font-size:11px;font-weight:bold;'>Fecha:</td><td>".$ven[0]['telefono']."</td></tr>";
        $html .= "</table>";
        $html .= "</td>";
        $html .= "</tr>";
        $html .= "<tr>";
        $html .= "<td colspan='3'>";
        $sqlIV = "SELECT v.idalmacen, v.codigo,v.nombre AS nomCliente,v.responsable,v.direccion,v.telefono FROM almacenes v WHERE v.idalmacen = '$idalamcen'";
        $table = dibujarTablaOfSQL($sqlIV, $tc);
        $html .= $table['resultado'];
        $html .= "</td>";
        $html .= "</tr>";
        $html .= "<tr>";
        $html .= "<td colspan='3'>";
        $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
        $html .= "<tr><td style='width:100px;font-size:11px;font-weight:bold;'>Son:</td><td style='width:450px;'>".convertir_a_letras($totalNeto, $ven[0]['abreviacion'])."</td><td style='width:125px;font-size:11px;font-weight:bold;'>Total Precio (".$ven[0]['abreviacion']."):</td><td style='width:75px;text-align:right;'>".$totalMonto."</td></tr>";
        $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Observaciones:</td><td>".$ven[0]['observaciones']."</td><td style='font-size:11px;font-weight:bold;'>Total Desc (".$ven[0]['abreviacion']."):</td><td style='width:75px;text-align:right;'>".$totalDescuento."</td></tr>";
        $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Emitido por:</td><td>".$ven[0]['login']."</td><td style='font-size:11px;font-weight:bold;'>Total credito (".$ven[0]['abreviacion']."):</td><td style='width:75px;text-align:right;'>".$totalCredito."</td></tr>";
        $html .= "<tr><td style='font-size:11px;font-weight:bold;'></td><td></td><td style='font-size:11px;font-weight:bold;'>Total Venta (".$ven[0]['abreviacion']."):</td><td style='width:75px;text-align:right;'>".$totalNeto."</td></tr>";
        $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'>Balderrama V 1.0 Kernel SRL</td></tr>";
        $html .= "</table>";
        $html .= "</td>";
        $html .= "</tr>";

        $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'><div id='pie'>
    <p>Importadora Asia<br />
         Cochabamba - Bolivia<br />
         Telf. 4555651
    </p>
</div></td></tr>";
        $html .= "</table>";
        $html .= "</body>";
        $html .= "</html>";
        if($return == true)
        {
            return $html;
        }
        else
        {
            echo $html;
        }
    }

}

function generarCompraMediaCartaChorro($idventa, $return)
{
    $html = "";
    $sql = "SELECT
  v.idventa,
  v.observaciones,
  v.nombre AS nomCliente,
  u.login,
  v.numeroimpresion,
  ci.idpiepagina,
  v.idcliente,
  p.idpago,
  p.bruta,
  p.descuento,
  p.neto,
  p.credito,
  m.nombre AS moneda,
  m.abreviacion,
  v.fecha,
  v.hora,
  tcm.monto,
  men.link
FROM
  venta v,
  usuario u,
  configimpresion ci,
  pago p,
  moneda m,
  tipocambio_moneda tcm,
  tipocambio tc,
  `membrete` men
WHERE
  v.idventa = '$idventa' AND
  v.idcajero = u.idusuario AND
  v.idreport = ci.idconfjasper AND
  v.idpago = p.idpago AND
  p.idmoneda = m.idmoneda AND
  p.idtipocambio = tc.idtipocambio AND
  tc.idtipocambio = tcm.idtipocambio AND
  tcm.idmoneda = m.idmoneda AND
  ci.idmembrete = men.idmembrete";
    $datos = getTablaToArrayOfSQL($sql);
    if($datos['error'] == "false")
    {
        echo "No existe esta compra";
        exit;
    }
    else
    {
        $ven = $datos["resultado"];
        /*aqui modificamos los campos segun la monedad */
        $totalMonto = $ven[0]['bruta'];
        $totalCredito = $ven[0]['credito'];
        $totalDescuento = $ven[0]['descuento'];
        $totalNeto = $ven[0]['neto'];
        $tc = $ven[0]['monto'];;

        $totalMonto = $totalMonto/$tc;
        $totalCredito = $totalCredito/$tc;
        $totalDescuento = $totalDescuento/$tc;
        $totalNeto = $totalNeto/$tc;

        $totalMonto = redondear($totalMonto, $_SESSION['usrDigitos']);
        $totalCredito = redondear($totalCredito, $_SESSION['usrDigitos']);
        $totalDescuento = redondear($totalDescuento, $_SESSION['usrDigitos']);
        $totalNeto = redondear($totalNeto, $_SESSION['usrDigitos']);

        /*aqui modificamos los campos segun la monedad */


        $html .= "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN'>";
        $html .= "<html>";
        $html .= "<head>";
        $html .= "<title></title>";
        $html .= "<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>";
        $html .= "<link href='".$_SESSION["ruta"]."css/print.css' rel='stylesheet' type='text/css' media='all'>";
        //$html .= "<link href='../print.css' rel='stylesheet' type='text/css' media='all'>";
        $html .= "</head>";
        $html .= "<body>";
        $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
        $html .= "<tr>";
        $html .= "<td style='width:400px;height:100px;border-bottom:1px solid #000000;'><img style='height:100px;' src='".$_SESSION["ruta"]."php/configuracion/".$_SESSION["empresa"]."/".$ven[0]['link']."'>";
        $html .= "</td>";
        $html .= "<td style='width:150px;height:100px;border-bottom:1px solid #000000;text-align:center;font-size:20px;font-family:Tahoma;'>";
        $html .= "SALIDA <br>DE<br> MATERIAL";
        $html .= "</td>";
        $html .= "<td style='width:200px;height:100px;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";
        $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:200px;'>";
        $html .= "<tr><td align='right'><img src='".$_SESSION["ruta"]."php/dao/impl/codigo.jpg'><td><tr>";
        $html .= "<tr><td align='right' style='font-size:11px; font-family:Tahoma; text-align:center;font-weight:bold;'>".$ven[0]['idventa']."<td><tr>";
        $html .= "</table>";
        $html .= "</td>";
        $html .= "</tr>";
        $html .= "<tr>";
        $html .= "<td colspan='3'>";
        $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
        $html .= "<tr><td style='width:100px;font-size:11px;font-weight:bold;'>Cliente:</td><td style='width:500px;' >".$ven[0]['nomCliente']."</td><td style='width:75px;font-size:11px;font-weight:bold;'>Numero:</td><td style='width:75px;'>".$ven[0]['numeroimpresion']."</td></tr>";
        $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Direccion:</td><td>".$ven[0]['direccion']."</td><td style='font-size:11px;font-weight:bold;'>T/C (Bs/".$ven[0]['abreviacion'].")</td><td>".$tc."</td></tr>";
        $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Telefono:</td><td></td><td style='font-size:11px;font-weight:bold;'>Fecha:</td><td>".$ven[0]['fecha']."</td></tr>";
        $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Por lo siguiente...</td><td></td><td style='font-size:11px;font-weight:bold;'>Fecha:</td><td>".$ven[0]['fecha']."</td></tr>";

        $html .= "</table>";
        $html .= "</td>";
        $html .= "</tr>";
        $html .= "<tr>";
        $html .= "<td colspan='3'>";
        $sqlIV = "SELECT p.codigo,  p.nombre, iv.cantidad, u.nombre AS unidad, iv.precio, iv.cantidad*iv.precio AS importe  FROM itemventa iv, producto p, unidad u WHERE iv.idventa = '$idventa' AND iv.idproducto = p.idproducto AND p.idunidad = u.idunidad";
        $table = dibujarTablaOfSQL($sqlIV, $tc);
        $html .= $table['resultado'];
        $html .= "</td>";
        $html .= "</tr>";
        $html .= "<tr>";
        $html .= "<td colspan='3'>";
        $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
        $html .= "<tr><td style='width:100px;font-size:11px;font-weight:bold;'>Son:</td><td style='width:450px;'>".convertir_a_letras($totalNeto, $ven[0]['abreviacion'])."</td><td style='width:125px;font-size:11px;font-weight:bold;'>Total Precio (".$ven[0]['abreviacion']."):</td><td style='width:75px;text-align:right;'>".$totalMonto."</td></tr>";
        $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Observaciones:</td><td>".$ven[0]['observaciones']."</td><td style='font-size:11px;font-weight:bold;'>Total Desc (".$ven[0]['abreviacion']."):</td><td style='width:75px;text-align:right;'>".$totalDescuento."</td></tr>";
        $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Emitido por:</td><td>".$ven[0]['login']."</td><td style='font-size:11px;font-weight:bold;'>Total credito (".$ven[0]['abreviacion']."):</td><td style='width:75px;text-align:right;'>".$totalCredito."</td></tr>";
        $html .= "<tr><td style='font-size:11px;font-weight:bold;'></td><td></td><td style='font-size:11px;font-weight:bold;'>Total Venta (".$ven[0]['abreviacion']."):</td><td style='width:75px;text-align:right;'>".$totalNeto."</td></tr>";
        $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'>Selkis V 1.0 Kernel SRL</td></tr>";
        $html .= "</table>";
        $html .= "</td>";
        $html .= "</tr>";

        $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'><div id='pie'>
    <p>Importadora Asia<br />
         Cochabamba - Bolivia<br />
         Telf. 4555651
    </p>
</div></td></tr>";
        $html .= "</table>";
        $html .= "</body>";
        $html .= "</html>";
        if($return == true)
        {
            return $html;
        }
        else
        {
            echo $html;
        }
    }
}
function PreventaMediaCartaChorro($idventa, $return)
{
    $html = "";
    $sql = "SELECT
  v.idventa,
  v.observaciones,
  v.nombre AS nomCliente,
  u.login,
  v.numeroimpresion,
  ci.idpiepagina,
  v.idcliente,
  p.idpago,
  p.bruta,
  p.descuento,
  p.neto,
  p.credito,
  m.nombre AS moneda,
  m.abreviacion,
  v.fecha,
  v.hora,
  tcm.monto,
  men.link
FROM
  venta v,
  usuario u,
  configimpresion ci,
  pago p,
  moneda m,
  tipocambio_moneda tcm,
  tipocambio tc,
  `membrete` men
WHERE
  v.idventa = '$idventa' AND
  v.idusuario = u.idusuario AND
  v.idreport = ci.idconfjasper AND
  v.idpago = p.idpago AND
  p.idmoneda = m.idmoneda AND
  p.idtipocambio = tc.idtipocambio AND
  tc.idtipocambio = tcm.idtipocambio AND
  tcm.idmoneda = m.idmoneda AND
  ci.idmembrete = men.idmembrete";
    $datos = getTablaToArrayOfSQL($sql);
    if($datos['error'] == "false")
    {
        echo "No existe esta venta";
        exit;
    }
    else
    {
        $ven = $datos["resultado"];
        /*aqui modificamos los campos segun la monedad */
        $totalMonto = $ven[0]['bruta'];
        $totalCredito = $ven[0]['credito'];
        $totalDescuento = $ven[0]['descuento'];
        $totalNeto = $ven[0]['neto'];
        $tc = $ven[0]['monto'];;

        //        $totalMonto = $totalMonto/$tc;
        //        $totalCredito = $totalCredito/$tc;
        //        $totalDescuento = $totalDescuento/$tc;
        //        $totalNeto = $totalNeto/$tc;

        $totalMonto = redondear($totalMonto, $_SESSION['usrDigitos']);
        $totalCredito = redondear($totalCredito, $_SESSION['usrDigitos']);
        $totalDescuento = redondear($totalDescuento, $_SESSION['usrDigitos']);
        $totalNeto = redondear($totalNeto, $_SESSION['usrDigitos']);

/*aqui modificamos los campos segun la monedad */


        $html .= "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN'>";
        $html .= "<html>";
        $html .= "<head>";
        $html .= "<title></title>";
        $html .= "<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>";
        $html .= "<link href='".$_SESSION["ruta"]."css/print.css' rel='stylesheet' type='text/css' media='all'>";
        //$html .= "<link href='../print.css' rel='stylesheet' type='text/css' media='all'>";
        $html .= "</head>";
        $html .= "<body>";
        $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
        $html .= "<tr>";
        $html .= "<td style='width:400px;height:100px;border-bottom:1px solid #000000;'><img style='height:100px;' src='".$_SESSION["ruta"]."php/configuracion/".$_SESSION["empresa"]."/".$ven[0]['link']."'>";
        $html .= "</td>";
        $html .= "<td style='width:150px;height:100px;border-bottom:1px solid #000000;text-align:center;font-size:20px;font-family:Tahoma;'>";
        $html .= "PREVENTA";
        $html .= "</td>";
        $html .= "<td style='width:200px;height:100px;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";
        $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:200px;'>";
        $html .= "<tr><td align='right'><img src='".$_SESSION["ruta"]."php/dao/impl/codigo.jpg'><td><tr>";
        $html .= "<tr><td align='right' style='font-size:11px; font-family:Tahoma; text-align:center;font-weight:bold;'>".$ven[0]['idventa']."<td><tr>";
        $html .= "</table>";
        $html .= "</td>";
        $html .= "</tr>";
        $html .= "<tr>";
        $html .= "<td colspan='3'>";
        $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
        $html .= "<tr><td style='width:100px;font-size:11px;font-weight:bold;'>Cliente:</td><td style='width:500px;' >".$ven[0]['nomCliente']."</td><td style='width:75px;font-size:11px;font-weight:bold;'>Numero:</td><td style='width:75px;'>".$ven[0]['numeroimpresion']."</td></tr>";
        $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Direccion:</td><td>".$ven[0]['direccion']."</td><td style='font-size:11px;font-weight:bold;'>T/C (Bs/".$ven[0]['abreviacion'].")</td><td>".$tc."</td></tr>";
        $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Telefono:</td><td></td><td style='font-size:11px;font-weight:bold;'>Fecha:</td><td>".$ven[0]['fecha']."</td></tr>";
        $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Por lo siguiente...</td><td></td><td style='font-size:11px;font-weight:bold;'>Fecha:</td><td>".$ven[0]['fecha']."</td></tr>";
        $html .= "</table>";
        $html .= "</td>";
        $html .= "</tr>";
        $html .= "<tr>";
        $html .= "<td colspan='3'>";
        $sqlIV = "SELECT p.codigo,  p.nombre, iv.cantidad, u.nombre AS unidad, iv.precio, iv.cantidad*iv.precio AS importe  FROM itemventa iv, producto p, unidad u WHERE iv.idventa = '$idventa' AND iv.idproducto = p.idproducto AND p.idunidad = u.idunidad";
        $table = dibujarTablaOfSQL($sqlIV, $tc);
        $html .= $table['resultado'];
        $html .= "</td>";
        $html .= "</tr>";
        $html .= "<tr>";
        $html .= "<td colspan='3'>";
        $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
        $html .= "<tr><td style='width:100px;font-size:11px;font-weight:bold;'>Son:</td><td style='width:450px;'>".convertir_a_letras($totalNeto, $ven[0]['abreviacion'])."</td><td style='width:125px;font-size:11px;font-weight:bold;'>Total Precio (".$ven[0]['abreviacion']."):</td><td style='width:75px;text-align:right;'>".$totalMonto."</td></tr>";
        $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Observaciones:</td><td>".$ven[0]['observaciones']."</td><td style='font-size:11px;font-weight:bold;'>Total Desc (".$ven[0]['abreviacion']."):</td><td style='width:75px;text-align:right;'>".$totalDescuento."</td></tr>";
        $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Vendedor:</td><td>".$ven[0]['login']."</td><td style='font-size:11px;font-weight:bold;'>Total credito (".$ven[0]['abreviacion']."):</td><td style='width:75px;text-align:right;'>".$totalCredito."</td></tr>";
        $html .= "<tr><td style='font-size:11px;font-weight:bold;'></td><td></td><td style='font-size:11px;font-weight:bold;'>Total Venta (".$ven[0]['abreviacion']."):</td><td style='width:75px;text-align:right;'>".$totalNeto."</td></tr>";
        $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'>Selkis V 1.0 Kernel SRL</td></tr>";
        $html .= "</table>";
        $html .= "</td>";
        $html .= "</tr>";

        $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'><div id='pie'>
    <p>Importadora Asia<br />
         Cochabamba - Bolivia<br />
         Telf. 4555651
    </p>
</div></td></tr>";
        $html .= "</table>";
        $html .= "</body>";
        $html .= "</html>";
        if($return == true)
        {
            return $html;
        }
        else
        {
            echo $html;
        }
    }

}
function CompraMediaCartaChorro($idcompra, $return)
{
    $html = "";
    $sql = "SELECT
  c.idcompra,
  c.observaciones,
  c.nombre AS nomCliente,
  u.login,
  c.numeroimpresion,
  ci.idpiepagina,
  c.idproveedor,
  p.idpago,
  p.bruta,
  p.descuento,
  p.neto,
  p.credito,
  m.nombre AS moneda,
  m.abreviacion,
  c.fecha,
  c.hora,
  tcm.monto,
  men.link
FROM
  compra c,
  usuario u,
  configimpresion ci,
  pago p,
  moneda m,
  tipocambio_moneda tcm,
  tipocambio tc,
  `membrete` men
WHERE
  c.idcompra = '$idcompra' AND
  c.idusuario = u.idusuario AND
  c.idreport = ci.idconfjasper AND
  c.idpago = p.idpago AND
  p.idmoneda = m.idmoneda AND
  p.idtipocambio = tc.idtipocambio AND
  tc.idtipocambio = tcm.idtipocambio AND
  tcm.idmoneda = m.idmoneda AND
  ci.idmembrete = men.idmembrete";
    $datos = getTablaToArrayOfSQL($sql);
    if($datos['error'] == "false")
    {
        echo "No existe esta venta";
        exit;
    }
    else
    {
        $ven = $datos["resultado"];
        /*aqui modificamos los campos segun la monedad */
        $totalMonto = $ven[0]['bruta'];
        $totalCredito = $ven[0]['credito'];
        $totalDescuento = $ven[0]['descuento'];
        $totalNeto = $ven[0]['neto'];
        $tc = $ven[0]['monto'];;

        //        $totalMonto = $totalMonto/$tc;
        //        $totalCredito = $totalCredito/$tc;
        //        $totalDescuento = $totalDescuento/$tc;
        //        $totalNeto = $totalNeto/$tc;

        $totalMonto = redondear($totalMonto, $_SESSION['usrDigitos']);
        $totalCredito = redondear($totalCredito, $_SESSION['usrDigitos']);
        $totalDescuento = redondear($totalDescuento, $_SESSION['usrDigitos']);
        $totalNeto = redondear($totalNeto, $_SESSION['usrDigitos']);

/*aqui modificamos los campos segun la monedad */


        $html .= "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN'>";
        $html .= "<html>";
        $html .= "<head>";
        $html .= "<title></title>";
        $html .= "<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>";
        $html .= "<link href='".$_SESSION["ruta"]."css/print.css' rel='stylesheet' type='text/css' media='all'>";
        //$html .= "<link href='../print.css' rel='stylesheet' type='text/css' media='all'>";
        $html .= "</head>";
        $html .= "<body>";
        $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
        $html .= "<tr>";
        $html .= "<td style='width:400px;height:100px;border-bottom:1px solid #000000;'><img style='height:100px;' src='".$_SESSION["ruta"]."php/configuracion/".$_SESSION["empresa"]."/".$ven[0]['link']."'>";
        $html .= "</td>";
        $html .= "<td style='width:150px;height:100px;border-bottom:1px solid #000000;text-align:center;font-size:20px;font-family:Tahoma;'>";
        $html .= "COMPRA <br>DE<br> PRODUCTOS";
        $html .= "</td>";
        $html .= "<td style='width:200px;height:100px;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";
        $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:200px;'>";
        $html .= "<tr><td align='right'><img src='".$_SESSION["ruta"]."php/dao/impl/codigo.jpg'><td><tr>";
        $html .= "<tr><td align='right' style='font-size:11px; font-family:Tahoma; text-align:center;font-weight:bold;'>".$ven[0]['idventa']."<td><tr>";
        $html .= "</table>";
        $html .= "</td>";
        $html .= "</tr>";
        $html .= "<tr>";
        $html .= "<td colspan='3'>";
        $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
        $html .= "<tr><td style='width:100px;font-size:11px;font-weight:bold;'>Proveedor:</td><td style='width:500px;' >".$ven[0]['nomCliente']."</td><td style='width:75px;font-size:11px;font-weight:bold;'>Numero:</td><td style='width:75px;'>".$ven[0]['numeroimpresion']."</td></tr>";
        $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Direccion:</td><td>".$ven[0]['direccion']."</td><td style='font-size:11px;font-weight:bold;'>T/C (Bs/".$ven[0]['abreviacion'].")</td><td>".$tc."</td></tr>";
        $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Telefono:</td><td></td><td style='font-size:11px;font-weight:bold;'>Fecha:</td><td>".$ven[0]['fecha']."</td></tr>";
        $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Por lo siguiente...</td><td></td><td style='font-size:11px;font-weight:bold;'>Fecha:</td><td>".$ven[0]['fecha']."</td></tr>";
        $html .= "</table>";
        $html .= "</td>";
        $html .= "</tr>";
        $html .= "<tr>";
        $html .= "<td colspan='3'>";
        $sqlIV = "SELECT p.codigo,  p.nombre, ic.cantidad, u.nombre AS unidad, ic.precio, ic.cantidad*ic.precio AS importe  FROM itemcompra ic, producto p, unidad u WHERE ic.idcompra = '$idcompra' AND ic.idproducto = p.idproducto AND p.idunidad = u.idunidad";
        $table = dibujarTablaOfSQL($sqlIV, $tc);
        $html .= $table['resultado'];
        $html .= "</td>";
        $html .= "</tr>";
        $html .= "<tr>";
        $html .= "<td colspan='3'>";
        $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
        $html .= "<tr><td style='width:100px;font-size:11px;font-weight:bold;'>Son:</td><td style='width:450px;'>".convertir_a_letras($totalNeto, $ven[0]['abreviacion'])."</td><td style='width:125px;font-size:11px;font-weight:bold;'>Total Precio (".$ven[0]['abreviacion']."):</td><td style='width:75px;text-align:right;'>".$totalMonto."</td></tr>";
        $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Observaciones:</td><td>".$ven[0]['observaciones']."</td><td style='font-size:11px;font-weight:bold;'>Total Desc (".$ven[0]['abreviacion']."):</td><td style='width:75px;text-align:right;'>".$totalDescuento."</td></tr>";
        $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Comprado por:</td><td>".$ven[0]['login']."</td><td style='font-size:11px;font-weight:bold;'>Total credito (".$ven[0]['abreviacion']."):</td><td style='width:75px;text-align:right;'>".$totalCredito."</td></tr>";
        $html .= "<tr><td style='font-size:11px;font-weight:bold;'></td><td></td><td style='font-size:11px;font-weight:bold;'>Total Venta (".$ven[0]['abreviacion']."):</td><td style='width:75px;text-align:right;'>".$totalNeto."</td></tr>";
        $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'>Selkis V 1.0 Kernel SRL</td></tr>";
        $html .= "</table>";
        $html .= "</td>";
        $html .= "</tr>";

        $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'><div id='pie'>
    <p>Importadora Asia<br />
         Cochabamba - Bolivia<br />
         Telf. 4555651
    </p>
</div></td></tr>";
        $html .= "</table>";
        $html .= "</body>";
        $html .= "</html>";
        if($return == true)
        {
            return $html;
        }
        else
        {
            echo $html;
        }
    }

}
function reporteMovimientoProducto($idproductos, $codigoIni, $codigoFin, $ciudad, $sucursal, $almacen, $categoria, $usuario, $tipo, $fechaIni, $fechaFin, $return)
{
    $select = " m.fecha, p.nombre, m.detalle, m.cantidadentrada AS entr, m.cantidadsalida AS salid, m.cantidadsaldo AS saldo, u.login, a.nombre, m.costounitario AS costo, m.valoradoingreso AS ventra, m.valoradoegreso AS vsalid, m.valoradosaldo AS vsaldo ";
    $from = " movimiento m, usuario u, almacen a, kardex k, producto p ";
    $where = "  m.idusuario = u.idusuario AND m.idalmacen = a.idalmacen AND m.idkardex = k.idkardex AND k.idproducto = p.idproducto ";
    if($idproductos != null && $idproductos != "")
    {
        $ids = split(",", $idproductos);
        $where .= " AND ( ";
        for($i = 1; $i< count($ids); $i++)
        {
            if($i == 1)
            {
                $where .= " k.idproducto = '".$ids[$i]."' ";
            }
            else
            {
                $where .= " OR k.idproducto = '".$ids[$i]."' ";
            }
        }
        $where .= " ) ";
    }
    else
    {
        if($ciudad != "Todos")
        {
            if($sucursal != "Todos")
            {
                if($almacen != "Todos")
                {
                    $where .= " AND a.idalmacen = '$almacen' ";
                }
                else
                {
                    $from .= " , sucursal s ";
                    $where .= " AND a.idsucursal = s.idsucursal AND s.idsucursal = '$sucursal' ";
                }
            }
            else
            {
                $from .= " , sucursal s, ciudad c ";
                $where .= " AND a.idsucursal = s.idsucursal AND s.idciudad = c.idciudad AND c.idciudad = '$ciudad' ";
            }
        }
        if($categoria != "Todos")
        {
            if($subcategoria != "Todos")
            {
                $from .= " , subcategoria sub ";
                $where .= " AND p.idsubcategoria = sub.idsubcategoria AND sub.idsubcategoria = '$subcategoria' ";
            }
            else
            {
                $from .= " , categoria cat, subcategoria sub ";
                $where .= " AND p.idsubcategoria = sub.idsubcategoria AND sub.idcategoria = cat.idcategoria AND cat.idcategoria = '$categoria' ";
            }
        }
    }
    if($usuario != "Todos")
    {
        $where .= " AND m.idusuario = '$usuario' ";
    }
    if($tipo == "Salidas")
    {
        $where .= " AND m.cantidadsalida > 0 ";
    }
    if($tipo == "Entradas")
    {
        $where .= " AND m.cantidadentrada > 0 ";
    }
    if($fechaIni != null && $fechaIni != "")
    {
        $where .= " AND m.fecha >= '$fechaIni' ";
    }

    if($fechaFin != null && $fechaFin != "")
    {
        $where .= " AND m.fecha <= '$fechaFin' ";
    }
    $sql = "SELECT $select FROM $from WHERE $where ORDER BY p.nombre ASC, m.fecha DESC";
    $html = "";
    $html .= "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN'>";
    $html .= "<html>";
    $html .= "<head>";
    $html .= "<title></title>";
    $html .= "<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>";
    $html .= "<link href='".$_SESSION["ruta"]."css/print.css' rel='stylesheet' type='text/css' media='all'>";
    //$html .= "<link href='../print.css' rel='stylesheet' type='text/css' media='all'>";
    $html .= "</head>";
    $html .= "<body>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
    $html .= "<tr>";
    $html .= "<td style='width:400px;height:100px;border-bottom:1px solid #000000;'><img style='height:100px;' src='".$_SESSION["ruta"]."php/configuracion/".$_SESSION["empresa"]."/".$ven[0]['link']."'>";
    $html .= "</td>";
    $html .= "<td style='width:150px;height:100px;border-bottom:1px solid #000000;text-align:center;font-size:20px;font-family:Tahoma;'>";
    $html .= "MOVIMIENTO <br>DE<br> PRODUCTOS";
    $html .= "</td>";
    $html .= "<td style='width:200px;height:100px;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:200px;'>";
    $html .= "<tr><td align='right'><img src='".$_SESSION["ruta"]."php/dao/impl/codigo.jpg'><td><tr>";
    $html .= "<tr><td align='right' style='font-size:11px; font-family:Tahoma; text-align:center;font-weight:bold;'>".$ven[0]['idventa']."<td><tr>";
    $html .= "</table>";
    $html .= "</td>";
    $html .= "</tr>";
    $html .= "<tr>";
    $html .= "<td colspan='3'>";
    $sqlIV = "SELECT p.codigo,  p.nombre, ic.cantidad, u.nombre AS unidad, ic.precio, ic.cantidad*ic.precio AS importe  FROM itemcompra ic, producto p, unidad u WHERE ic.idcompra = '$idcompra' AND ic.idproducto = p.idproducto AND p.idunidad = u.idunidad";
    $table = dibujarTablaOfSQL($sql, $tc);
    $html .= $table['resultado'];
    $html .= "</td>";
    $html .= "</tr>";

    $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'><div id='pie'>
    <p>Importadora Asia<br />
         Cochabamba - Bolivia<br />
         Telf. 4555651
    </p>
</div></td></tr>";
    $html .= "</table>";
    $html .= "</body>";
    $html .= "</html>";
    if($return == true)
    {
        return $html;
    }
    else
    {
        echo $html;
    }
}
function reporteKardexProducto($idproductos, $codigoIni, $codigoFin, $ciudad, $sucursal, $almacen, $categoria, $subcategoria, $usuario, $tipo, $fechaIni, $fechaFin, $return)
{
    $select = " m.fecha, p.nombre, m.detalle, m.cantidadentrada AS entr, m.cantidadsalida AS salid, m.cantidadsaldo AS saldo, u.login, a.nombre, m.costounitario AS costo, m.valoradoingreso AS ventra, m.valoradoegreso AS vsalid, m.valoradosaldo AS vsaldo ";
    $from = " movimiento m, usuario u, almacen a, kardex k, producto p ";
    $where = "  m.idusuario = u.idusuario AND m.idalmacen = a.idalmacen AND m.idkardex = k.idkardex AND k.idproducto = p.idproducto ";
    if($idproductos != null && $idproductos != "")
    {
        $ids = split(",", $idproductos);
        $where .= " AND ( ";
        for($i = 1; $i< count($ids); $i++)
        {
            if($i == 1)
            {
                $where .= " k.idproducto = '".$ids[$i]."' ";
            }
            else
            {
                $where .= " OR k.idproducto = '".$ids[$i]."' ";
            }
        }
        $where .= " ) ";
    }
    else
    {
        if($ciudad != "Todos")
        {
            if($sucursal != "Todos")
            {
                if($almacen != "Todos")
                {
                    $where .= " AND a.idalmacen = '$almacen' ";
                }
                else
                {
                    $from .= " , sucursal s ";
                    $where .= " AND a.idsucursal = s.idsucursal AND s.idsucursal = '$sucursal' ";
                }
            }
            else
            {
                $from .= " , sucursal s, ciudad c ";
                $where .= " AND a.idsucursal = s.idsucursal AND s.idciudad = c.idciudad AND c.idciudad = '$ciudad' ";
            }
        }
        if($categoria != "Todos")
        {
            if($subcategoria != "Todos")
            {
                $from .= " , subcategoria sub ";
                $where .= " AND p.idsubcategoria = sub.idsubcategoria AND sub.idsubcategoria = '$subcategoria' ";
            }
            else
            {
                $from .= " , categoria cat, subcategoria sub ";
                $where .= " AND p.idsubcategoria = sub.idsubcategoria AND sub.idcategoria = cat.idcategoria AND cat.idcategoria = '$categoria' ";
            }
        }
    }
    if($usuario != "Todos")
    {
        $where .= " AND m.idusuario = '$usuario' ";
    }
    if($tipo == "Salidas")
    {
        $where .= " AND m.cantidadsalida > 0 ";
    }
    if($tipo == "Entradas")
    {
        $where .= " AND m.cantidadentrada > 0 ";
    }
    if($fechaIni != null && $fechaIni != "")
    {
        $where .= " AND m.fecha >= '$fechaIni' ";
    }

    if($fechaFin != null && $fechaFin != "")
    {
        $where .= " AND m.fecha <= '$fechaFin' ";
    }
    $sql = "SELECT $select FROM $from WHERE $where ORDER BY p.nombre ASC, m.fecha DESC";
    $html = "";
    $html .= "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN'>";
    $html .= "<html>";
    $html .= "<head>";
    $html .= "<title></title>";
    $html .= "<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>";
    $html .= "<link href='".$_SESSION["ruta"]."css/print.css' rel='stylesheet' type='text/css' media='all'>";
    //$html .= "<link href='../print.css' rel='stylesheet' type='text/css' media='all'>";
    $html .= "</head>";
    $html .= "<body>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
    $html .= "<tr>";
    $html .= "<td style='width:400px;height:100px;border-bottom:1px solid #000000;'><img style='height:100px;' src='".$_SESSION["ruta"]."php/configuracion/".$_SESSION["empresa"]."/".$ven[0]['link']."'>";
    $html .= "</td>";
    $html .= "<td style='width:150px;height:100px;border-bottom:1px solid #000000;text-align:center;font-size:20px;font-family:Tahoma;'>";
    $html .= "MOVIMIENTO <br>DE<br> PRODUCTOS";
    $html .= "</td>";
    $html .= "<td style='width:200px;height:100px;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:200px;'>";
    $html .= "<tr><td align='right'><img src='".$_SESSION["ruta"]."php/dao/impl/codigo.jpg'><td><tr>";
    $html .= "<tr><td align='right' style='font-size:11px; font-family:Tahoma; text-align:center;font-weight:bold;'>".$ven[0]['idventa']."<td><tr>";
    $html .= "</table>";
    $html .= "</td>";
    $html .= "</tr>";
    $html .= "<tr>";
    $html .= "<td colspan='3'>";
    $sqlIV = "SELECT p.codigo,  p.nombre, ic.cantidad, u.nombre AS unidad, ic.precio, ic.cantidad*ic.precio AS importe  FROM itemcompra ic, producto p, unidad u WHERE ic.idcompra = '$idcompra' AND ic.idproducto = p.idproducto AND p.idunidad = u.idunidad";
    $table = dibujarTablaOfSQL($sql, $tc);
    $html .= $table['resultado'];
    $html .= "</td>";
    $html .= "</tr>";

    $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'><div id='pie'>
    <p>Importadora Asia<br />
         Cochabamba - Bolivia<br />
         Telf. 4555651
    </p>
</div></td></tr>";
    $html .= "</table>";
    $html .= "</body>";
    $html .= "</html>";
    if($return == true)
    {
        return $html;
    }
    else
    {
        echo $html;
    }
}



function  reporteProductos($categoria, $subcategoria, $codigo, $nombre,$marca, $medida,$cantidad,$almacen, $sucursal, $ciudad,$return = true)
{

    //http:localhost/web/php/dao/ReporteHTML.php?function=reporteProductos&categoria=Todos&subcategoria=Todos&codigo=""&nombre=""&marca=""&medida=""&cantidad=""&almacen=Todos&sucursal=Todos&ciudad=Todos

    if($start == null)
    {
        $start = 0;
    }
    if($limit == null)
    {
        $limit = 100;
    }
    if($sort != null)
    {
        $order = "ORDER BY $sort ";
        if($dir != null)
        {
            $order .= " $dir ";
        }
    }
    $dev['totalCount'] = 0;
    $dev['mensaje'] = "";
    $dev['error']   = "";
    $dev['resultado'] = "";

    $select = "p.idproducto, p.codigo, p.codigofabrica, p.nombre, m.nombre AS marca, ps.nombre AS pais, p.preciobs1, p.preciosus1, u.nombre AS unidad ";
    $from = " producto p, marca m, pais ps, unidad u ";
    $where = " p.idmarca = m.idmarca AND p.idpais = ps.idpais AND p.idunidad = u.idunidad ";
    if($ciudad != "Todos" && $ciudad != null && $ciudad != "")
    {
        if($sucursal != "Todos" && $sucursal != null && $sucursal != "")
        {
            if($almacen != "Todos" && $almacen != null && $almacen != "")
            {
                $from .= ", almacen a, productoalmacen pa";
                $where .= " AND a.idalmacen = pa.idalmacen AND pa.idproducto = p.idproducto AND a.idalmacen = '$almacen'";
                if($cantidad != NULL && $cantidad != "")
                {
                    $where .= " AND (pa.cantidad $cantidad)";
                }
                $select .= ", pa.cantidad AS cantidad ";
            }
            else
            {
                if($cantidad != NULL && $cantidad != "")
                {
                    // $where .= " AND (SELECT SUM(pa.cantidad) AS cantidad FROM productoalmacen ppa, almacen aaa
                    //WHERE ppa.idalmacen = aaa.idalmacen AND aaa.idsucursal = s.idsucursal) $cantidad ";
                    $where .= " AND cantidad $cantidad";
                }
                $select .= ", (SELECT SUM(ppa.cantidad) AS cantidad FROM productoalmacen ppa, almacen aaa
 WHERE ppa.idalmacen = aaa.idalmacen AND aaa.idsucursal = '$sucursal') AS cantidad  ";
                $from .= ", almacen a, sucursal s, productoalmacen pa";
                $where .= " AND a.idalmacen = pa.idalmacen AND pa.idproducto = p.idproducto AND a.idsucursal = s.idsucursal AND s.idsucursal = '$sucursal'";
            }
        }
        else
        {
            if($cantidad != NULL && $cantidad != "")
            {
                // $where .= " AND (SELECT SUM(pa.cantidad) AS cantidad FROM productoalmacen ppa, almacen aaa
                //WHERE ppa.idalmacen = aaa.idalmacen AND aaa.idsucursal = s.idsucursal) $cantidad ";
                $where .= " AND cantidad $cantidad";
            }
            $select .= ", (SELECT SUM(ppa.cantidad) AS cantidad FROM productoalmacen ppa, almacen aaa, sucursal sss
 WHERE ppa.idalmacen = aaa.idalmacen AND aaa.idsucursal = sss.idsucursal AND sss.idciudad = '$ciudad') AS cantidad  ";
            $from .= ", almacen a, sucursal s, ciudad c, productoalmacen pa";
            $where .= " AND a.idalmacen = pa.idalmacen AND pa.idproducto = p.idproducto AND a.idsucursal = s.idsucursal AND s.idciudad = c.idciudad AND c.idciudad = '$ciudad'";
        }
    }
    else
    {
        if($cantidad != NULL && $cantidad != "")
        {
            // $where .= " AND (SELECT SUM(pa.cantidad) AS cantidad FROM productoalmacen ppa, almacen aaa
            //WHERE ppa.idalmacen = aaa.idalmacen AND aaa.idsucursal = s.idsucursal) $cantidad ";
            $where .= " AND k.cantidadsaldo $cantidad";
        }
        $select .= ", k.cantidadsaldo AS cantidad ";
        $from .= ", kardex k ";
        $where .= " AND p.idkardex = k.idkardex ";
    }
    if($categoria != "Todos" && $categoria != null && $categoria != "")
    {
        if($subcategoria != "Todos" && $subcategoria != null && $subcategoria != "")
        {
            $from .= ", subcategoria sb";
            $where .= " AND p.idsubcategoria = sb.idsubcategoria AND sb.idsubcategoria = '$subcategoria'";
        }
        else
        {
            $from .= ", subcategoria sb, categoria ct";
            $where .= " AND p.idsubcategoria = sb.idsubcategoria AND sb.idcategoria = ct.idcategoria AND ct.idcategoria = '$categoria'";
        }
    }
    if($codigo != null && $codigo != "")
    {
        $where .= " AND p.codigo LIKE '%$codigo%' ";
    }
    if($nombre != null && $nombre != "")
    {
        $where .= " AND p.nombre LIKE '%$nombre%' ";
    }

    if($marca != null && $marca != "")
    {
        $where .= " AND m.nombre LIKE '%$marca%' ";
    }

    //    if($star == 0 && $limit == 0)
    //    {
    $sql = "SELECT ".$select." FROM ".$from. " WHERE ".$where." ".$order;
    //    }
    //    else
    //    {
    //        $sql = "SELECT ".$select." FROM ".$from. " WHERE ".$where." ".$order." LIMIT $start,$limit ";
    //    }

    $sql = "SELECT ".$select." FROM ".$from. " WHERE ".$where." ".$order;
    $html = "";
    $html .= "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN'>";
    $html .= "<html>";
    $html .= "<head>";
    $html .= "<title></title>";
    $html .= "<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>";
    $html .= "<link href='".$_SESSION["ruta"]."css/print.css' rel='stylesheet' type='text/css' media='all'>";
    //$html .= "<link href='../print.css' rel='stylesheet' type='text/css' media='all'>";
    $html .= "</head>";
    $html .= "<body>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
    $html .= "<tr>";
    $html .= "<td style='width:400px;height:100px;border-bottom:1px solid #000000;'><img style='height:100px;' src='".$_SESSION["ruta"]."php/configuracion/".$_SESSION["empresa"]."/".$ven[0]['link']."'>";
    $html .= "</td>";
    $html .= "<td style='width:150px;height:100px;border-bottom:1px solid #000000;text-align:center;font-size:20px;font-family:Tahoma;'>";
    $html .= "LISTA <br>DE<br> PRODUCTOS";
    $html .= "</td>";
    $html .= "<td style='width:200px;height:100px;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:200px;'>";
    $html .= "<tr><td align='right'><img src='".$_SESSION["ruta"]."php/dao/impl/codigo.jpg'><td><tr>";
    $html .= "<tr><td align='right' style='font-size:11px; font-family:Tahoma; text-align:center;font-weight:bold;'>".$ven[0]['idventa']."<td><tr>";
    $html .= "</table>";
    $html .= "</td>";
    $html .= "</tr>";

    $html .= "<tr>";
    $html .= "<td colspan='3'>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:100%;font-size:11px;font-weight:0;'>";
    //$html .= "<table border='1' width='100'>";

    $html .= "<tr>";
    $html .= "<th >Ciudad:</td>";
    $html .= "<th style='text-align:left;border-left: 1px solid #000000;'>$ciudad</th>";
    $html .= "<th >Almacen:</th>";
    $html .= "<th style='text-align:left;border-left: 1px solid #000000;'>$almacen</th>";
    $html .= "<th >Subcat:</th>";
    $html .= "<th style='text-align:left;border-left: 1px solid #000000;'>$subcategoria</th>";
    $html .= "</tr>";
    $html .= "<tr>";
    $html .= "<th >Cantidad:</th>";
    $html .= "<th style='text-align:left;border-left: 1px solid #000000;'>$cantidad</th>";
    $html .= "<th >Marca:</th>";
    $html .= "<th style='text-align:left;border-left: 1px solid #000000;'>$marca</th>";
    $html .= "<th >Sucursal:</th>";
    $html .= "<th style='text-align:left;border-left: 1px solid #000000;'>$sucursal</th>";
    $html .= "</tr>";
    $html .= "<tr>";
    $html .= "<th >Categoria:</th>";
    $html .= "<th style='text-align:left;border-left: 1px solid #000000;'>$categoria</th>";
    $html .= "<th >Codigo:</th>";
    $html .= "<th style='text-align:left;border-left: 1px solid #000000;'>$codigo</th>";
    $html .= "<th >Nombre:</th>";
    $html .= "<th style='text-align:left;border-left: 1px solid #000000;'>$nombre</th>";
    $html .= "</tr>";
    $html .= "<tr>";
    $html .= "<th >Medida:</th>";
    $html .= "<th style='text-align:left;border-left: 1px solid #000000;'>$medida</th>";
    $html .= "</tr>";

    $html .= "</table>";
    $html .= "</td>";
    $html .= "</tr>";
    $html .= "<tr>";
    $html .= "<td colspan='3'>";
    $table = dibujarTablaOfSQL($sql,$tc);
    $html .= $table['resultado'];
    $html .= "</td>";
    $html .= "</tr>";

    $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'><div id='pie'>
    <p>Importadora Asia<br />
         Cochabamba - Bolivia<br />
         Telf. 4555651
    </p>
</div></td></tr>";
    $html .= "</table>";
    $html .= "</body>";
    $html .= "</html>";
    if($return == true)
    {
        return $html;
    }
    else
    {
        echo $html;
    }
}


function reporteLibroMayor($idcuenta, $codigoIni, $codigoFin, $fechaIni, $fechaFin, $idmoneda, $opcion, $glosa, $return)
{
    $sql = "SELECT $select FROM $from WHERE $where ORDER BY v.fecha ASC ";
    $html = "";
    $html .= "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN'>";
    $html .= "<html>";
    $html .= "<head>";
    $html .= "<title></title>";
    $html .= "<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>";
    $html .= "<link href='".$_SESSION["ruta"]."css/print.css' rel='stylesheet' type='text/css' media='all'>";
    //$html .= "<link href='../print.css' rel='stylesheet' type='text/css' media='all'>";
    $html .= "</head>";
    $html .= "<body>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
    $html .= "<tr>";
    $html .= "<td style='width:400px;height:100px;border-bottom:1px solid #000000;'><img style='height:100px;' src='".$_SESSION["ruta"]."php/configuracion/".$_SESSION["empresa"]."/".$ven[0]['link']."'>";
    $html .= "</td>";
    $html .= "<td style='width:150px;height:100px;border-bottom:1px solid #000000;text-align:center;font-size:20px;font-family:Tahoma;'>";
    $html .= "LIBRO MAYOR <br> DETALLADO";
    $html .= "</td>";
    $html .= "<td style='width:200px;height:100px;border-bottom:1px solid #000000;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:200px;'>";
    $html .= "<tr><td align='right'><img src='".$_SESSION["ruta"]."php/dao/impl/codigo.jpg'><td><tr>";
    $html .= "<tr><td align='right' style='font-size:11px; font-family:Tahoma; text-align:center;font-weight:bold;'>".$ven[0]['idventa']."<td><tr>";
    $html .= "</table>";
    $html .= "</td>";
    $html .= "</tr>";
    $html .= "<tr>";
    $html .= "<tr>";
    $html .= "<td colspan='3'>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:100%;font-size:11px;font-weight:0;'>";
    //$html .= "<table border='1' width='100'>";

    $html .= "<tr>";
    $html .= "<th >Desde:</td>";
    $html .= "<th style='text-align:left;border-left: 1px solid #000000;'>$codigoIni</th>";
    $html .= "<th >Hasta:</th>";
    $html .= "<th style='text-align:left;border-left: 1px solid #000000;'>$codigoFin</th>";
    $html .= "<th >Fecha Ini:</th>";
    $html .= "<th style='text-align:left;border-left: 1px solid #000000;'>$fechaIni</th>";
    $html .= "</tr>";
    $html .= "<tr>";
    $html .= "<th >FechaFin:</th>";
    $html .= "<th style='text-align:left;border-left: 1px solid #000000;'>$fechaFin</th>";
    $html .= "<th >Moneda:</th>";
    $html .= "<th style='text-align:left;border-left: 1px solid #000000;'>$nombreMoneda</th>";
    $html .= "<th >Opcion:</th>";
    $html .= "<th style='text-align:left;border-left: 1px solid #000000;'>$opcion</th>";
    $html .= "</tr>";
    $html .= "<tr>";

    $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'><div id='pie'>
    <p>Importadora Asia<br />
         Cochabamba - Bolivia<br />
         Telf. 4555651
    </p>
</div></td></tr>";
    $html .= "</table>";
    $html .= "</td>";
    $html .= "</tr>";
    $html .= "<tr>";

    $html .= "<td colspan='3'>";
    if($idcuenta != null && $idcuenta != "")
    {
        $ids = split(",", $idcuenta);
        for($i = 1; $i< count($ids); $i++)
        {
            $html .= reporteLibroMayorCuenta($ids[$i], $fechaIni, $fechaFin, $idmoneda, $opcion, $glosa, true);
        }
    }
    else
    {
        $sqlA = "SELECT idcuenta FROM cuenta c";
        $link = new BD;
        $link->conectar();
        $re = $link->consulta($sqlA);
        if($fi = mysql_fetch_array($re))
        {
            do{
                $html .= reporteLibroMayorCuenta($fi['idcuenta'], $fechaIni, $fechaFin, $idmoneda, $opcion, $glosa, true);
            }while($fi = mysql_fetch_array($re));
        }

    }
    $html .= "</td>";
    $html .= "</tr>";
    $html .= "</table>";
    $html .= "</body>";
    $html .= "</html>";

    if($return == true)
    {
        return $html;
    }
    else
    {

        echo $html;
    }
}
function reporteLibroMayorCuenta($idcuenta, $fechaIni, $fechaFin, $idmoneda, $opcion, $glosa, $return)
{
    if($opcion != null && $opcion != "")
    {
        if($opcion== "detallado"){

            $select =" v.fecha, v.codigo, c.nombre, v.debe, v.haber, v.saldo ";
            $from = "vislibromayor v, cuenta c ";
            $where = " v.idcuenta = c.idcuenta ";
        }
        if($opcion== "mensual"){

            $select = "id.fecha, c.codigo, id.glosa, id.debe, id.haber, id.saldo";
            $from = "cuenta c, itemdocumento id, moneda m";
            $where = "c.idcuenta = id.idcuenta AND c.idcuenta='$idcuenta' ";
        }
    }
    if($fechaIni != null && $fechaIni != "")
    {
        $where .= " AND v.fecha >= '$fechaIni' ";
    }
    if($fechaFin != null && $fechaFin != "")
    {
        $where .= " AND v.fecha <= '$fechaFin' ";
    }


    $sql = "SELECT $select FROM $from WHERE v.idcuenta = '$idcuenta' AND $where ORDER BY v.fecha ASC ";
    $html = "";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
    $html .= "<tr>";
    $html .= "<tr>";
    $html .= "<td colspan='3'>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:100%;font-size:11px;font-weight:0;'>";
    //$html .= "<table border='1' width='100'>";

    $html .= "<tr>";
    $html .= "<th >Fecha Ini:</th>";
    $html .= "<th style='text-align:left;border-left: 1px solid #000000;'>$fechaIni</th>";
    $html .= "<th >FechaFin:</th>";
    $html .= "<th style='text-align:left;border-left: 1px solid #000000;'>$fechaFin</th>";
    $html .= "<th >Moneda:</th>";
    $html .= "<th style='text-align:left;border-left: 1px solid #000000;'>$nombreMoneda</th>";
    $html .= "</table>";
    $html .= "</td>";
    $html .= "</tr>";
    $html .= "<tr>";

    $html .= "<td colspan='3'>";
    //$sqlIV = "SELECT p.codigo,  p.nombre, ic.cantidad, u.nombre AS unidad, ic.precio, ic.cantidad*ic.precio AS importe  FROM itemcompra ic, producto p, unidad u WHERE ic.idcompra = '$idcompra' AND ic.idproducto = p.idproducto AND p.idunidad = u.idunidad";
    $table = dibujarTablaOfSQL($sql, 1);
    $html .= $table['resultado'];
    $html .= "</td>";
    $html .= "</tr>";
    $html .= "</table>";

    if($table['resultado'] == "")
    {
        $html = "";
    }


    if($return == true)
    {
        return $html;
    }
    else
    {
        echo $html;
    }
}


function dibujarTuplaOfSQLNormal($sql, $titulo = "ninguno")
{
    if($link=new BD)
    {
        if($link->conectar())
        {
            if($re = $link->consulta($sql))
            {
                //echo mysql_num_rows($re);
                if($fi = mysql_fetch_array($re))
                {
                    $devS .= "<table cellpadding='0' cellspacing='0' border='0' style='width:100%;border:1px solid #000000;font-size:11px;'>";
                    if($titulo != "ninguno")
                    {
                        $devS .= "<tr><td colspan='2' style='border-bottom:1px solid #000000;font-weight:bold;font-size:11px;text-align:center;background-color:silver;'>$titulo</td></tr>";
                    }
                    $ii = 0;
                    //$totalCount = mysql_num_rows($re);
                    $z = 1;
                    do{
                        for($i = 0; $i< mysql_num_fields($re); $i++)
                        {
                            $dato = $fi[$i];
                            if(mysql_field_type($re, $i) == "real")
                            {
                                $devS .= "<tr><td style='font-weight:bold;'>&nbsp;&nbsp;".mysql_field_name($re, $i)."</td><td style='text-align:right;border-left: 1px solid #000000;'>&nbsp;".redondear($dato)."&nbsp;</td></tr>";
                            }
                            else
                            {
                                $devS .= "<tr><td style='font-weight:bold;'>&nbsp;&nbsp;".mysql_field_name($re, $i)."</td><td style='text-align:left;border-left: 1px solid #000000;'>&nbsp;".$dato."&nbsp;</td></tr>";
                            }
                        }
                        $devS .= "</tr>";
                        $ii++;
                        $z ++;
                    }while($fi = mysql_fetch_array($re));

                    $devS .= "</table>";

                    $dev['mensaje'] = "Existen resultados";
                    $dev['error']   = "true";
                    $dev['resultado'] = $devS;

                }
                else
                {
                    $dev['mensaje'] = "No se encontro datos en la consulta2".mysql_error();
                    $dev['error']   = "false";
                    $dev['resultado'] = "";
                }
            }
            else
            {
                $dev['mensaje'] = "Error en la consulta";
                $dev['error']   = "false";
                $dev['resultado'] = "";
            }
        }
        else
        {
            $dev['mensaje'] = "No se pudo conectar a la BD";
            $dev['error']   = "false";
            $dev['resultado'] = "";
        }
    }
    else
    {
        $dev['mensaje'] = "No se pudo crear la conexion a la BD";
        $dev['error']   = "false";
        $dev['resultado'] = "";
    }
    return $dev;
}
function  CodigoBarraIngreso($idingreso,$return = true)
{


    $sql = "SELECT ".$select." FROM ".$from. " WHERE ".$where." ".$order;
    //    MostrarConsulta($sql);
    $html = "";
    $html .= "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN'>";
    $html .= "<html>";
    $html .= "<head>";
    $html .= "<title></title>";
    $html .= "<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>";
    $html .= "<link href='".$_SESSION["ruta"]."css/print.css' rel='stylesheet' type='text/css' media='all'>";
    //$html .= "<link href='../print.css' rel='stylesheet' type='text/css' media='all'>";
    $html .= "</head>";
    $html .= "<body>";
    
    $html .= "<table width='750' border='0' cellspacing='0' cellpadding='0'><tr>";
    $sql1="
SELECT
  kar.idkardextienda,
  kar.idmodelodetalle,
  kar.idtienda,
  kar.codigobarra,
  kar.saldocantidad,
  kar.cantidad,
  kar.numero,
  kar.talla,
  mdd.codigo,
  mdd.stylename,
  mdd.color,
  mdd.material,
  kar.codigobarraean13
FROM
  `kardextienda` kar,
  `modelodetalle` mdd
WHERE
  kar.idmodelodetalle = mdd.idmodelodetalle AND
  kar.idoperacion = '$idingreso'
";
//    echo $sql1;
    $row = NumeroTuplas($sql1);
    $row1= $row['resultado'];
    $sql2 = getTablaToArrayOfSQL($sql1);
    $sql3 = $sql2['resultado'];
    $j=0;
    for ($i=0;$i<$row1;$i++){

        $codigo = $sql3[$i];
        $codigoBarra = $codigo['codigobarra'];
        $codigo1 = $codigo['codigobarraean13'];
      
        $codigomodelo = $codigo['codigo'];
        $stylename = $codigo['stylename'];
        $saldocantidad = $codigo['saldocantidad'];
        for($h=0;$h<$saldocantidad;$h++){
            if($j==3){
                $html .="</tr><tr>";
                $j=0;
            }

            $html .="
    <td width='33%'><div align='center'>
      <p><img alt='Error? Cant display image!' src='php/imagen.php?code=ean13&amp;o=1&amp;t=50&amp;r=1&amp;text=".$codigo1."&amp;f=3&amp;a1=&amp;a2='></p>
      <p>Codigo : ".$codigomodelo."</p>
      <p>SytleName : ".$stylename." </p>
    </div></td>
";
            $j++;

        }

    }
    $html .= "</table>";
    $html .= "</body>";
    $html .= "</html>";
    if($return == true)
    {
        return $html;
    }
    else
    {
        echo $html;
    }
}

function  CodigoBarraIngresoAlmacen($idingreso,$return = true)
{


    $sql = "SELECT ".$select." FROM ".$from. " WHERE ".$where." ".$order;
    //    MostrarConsulta($sql);
    $html = "";
    $html .= "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN'>";
    $html .= "<html>";
    $html .= "<head>";
    $html .= "<title></title>";
    $html .= "<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>";
    $html .= "<link href='".$_SESSION["ruta"]."css/print.css' rel='stylesheet' type='text/css' media='all'>";
    //$html .= "<link href='../print.css' rel='stylesheet' type='text/css' media='all'>";
    $html .= "</head>";
    $html .= "<body>";

    $html .= "<table width='750' border='0' cellspacing='0' cellpadding='0'><tr>";
    revisarreimpresion($idingreso,false);
    
    $sql1="
SELECT kar.idkardexalmacen, kar.idmodelo, kar.codigobarra, kar.saldocantidadcaja,kar.generado, kar.cantidadcaja, kar.cantidadpares, kar.numero, kar.codigobarraean13, col.codigo AS coleccion, mar.nombre AS marca, mdd.codigo AS modelo
FROM `kardexalmacen` kar, `coleccion` col, `modelos` mdd, `marcas` mar
WHERE kar.idmarca = col.idmarca
AND kar.idmodelo = mdd.idmodelo
AND kar.idmarca = mar.idmarca
AND kar.idoperacion = '$idingreso'
";
//    echo $sql1;
    $row = NumeroTuplas($sql1);
    $row1= $row['resultado'];
    $sql2 = getTablaToArrayOfSQL($sql1);
  $sql3 = $sql2['resultado'];

$j=0;
    for ($i=0;$i<$row1;$i++){

        $codigo = $sql3[$i];
        $codigoBarra = $codigo['codigobarra'];
      
        $codigo1 = $codigo['codigobarraean13'];
        $codigomodelo = $codigo['modelo'];
        $marca = $codigo['marca'];
        $coleccion = $codigo['coleccion'];
       $pares = $codigo['cantidadpares'];
$saldocantidad = $codigo['saldocantidadcaja'];
  
       for($h=0;$h<$saldocantidad;$h++){
            if($j==3){
                $html .="</tr><tr>";
                $j=0;
            }

            $html .="
    <td width='33%'><div align='center'>
      <p><img alt='Error? Cant display image!' src='php/imagen.php?code=ean13&amp;o=1&amp;t=50&amp;r=1&amp;text=".$codigo1."&amp;f=3&amp;a1=&amp;a2='></p>
      <p>Marca : ".$marca."</p>
      <p>Coleccion : ".$coleccion." </p>
<p>Pares : ".$pares."</p>
<p>Modelo : ".$codigomodelo."</p>
    </div></td>
";
            $j++;

        }

    }
    $html .= "</table>";
    $html .= "</body>";
    $html .= "</html>";
    if($return == true)
    {
        return $html;
    }
    else
    {
        echo $html;
    }
}
function revisarreimpresion($idingreso, $return)
{

    $dev['mensaje'] = "";
    $dev['error'] = "false";
    $dev['resultado'] = "";
  // $proforma = $resultado->venta;
$emitida="1";
$sql2 = "SELECT
 generado
FROM
  ingresoalmacen
WHERE
  idingreso = '$idingreso'";
    $idalmacenA =  findBySqlReturnCampoUnique($sql2, true, true, 'generado');
    $generado = $idalmacenA['resultado'];
    $nuevogenerado="1";
    if($generado=="0"){
        $sql[] = "UPDATE ingresoalmacen SET generado='$nuevogenerado' WHERE idingreso='$idingreso'";
       $sql[] = "UPDATE kardexalmacen SET generado='$nuevogenerado' WHERE idoperacion='$idingreso'";

    }
          // MostrarConsulta($sql);
    if(ejecutarConsultaSQLBeginCommit($sql))
    {

       $dev['mensaje'] = "";
        $dev['error'] = "true";
        $dev['resultado'] = $respuesta;
        //$dev['resultado'] = $planilla;

    }
    else
    {
        $dev['mensaje'] = "";
        $dev['error'] = "false";
        $dev['resultado'] = "";
    }
    if($return == true)
    {
        return $dev;
    }
    else
    {
        $json = new Services_JSON();
        $output = $json->encode($dev);
       // print($output);
    }


}
function  AdicionCodigoBarraIngreso($idingreso,$return = true)
{


    $sql = "SELECT ".$select." FROM ".$from. " WHERE ".$where." ".$order;
    //    MostrarConsulta($sql);
    $html = "";
    $html .= "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN'>";
    $html .= "<html>";
    $html .= "<head>";
    $html .= "<title></title>";
    $html .= "<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>";
    $html .= "<link href='".$_SESSION["ruta"]."css/print.css' rel='stylesheet' type='text/css' media='all'>";
    //$html .= "<link href='../print.css' rel='stylesheet' type='text/css' media='all'>";
    $html .= "</head>";
    $html .= "<body>";

    $html .= "<table width='750' border='0' cellspacing='0' cellpadding='0'><tr>";

//    $sql1="
//SELECT kar.idkardextienda, kar.idmodelodetalle, kar.idtienda, kar.codigobarra, kar.saldocantidad, kar.cantidad, kar.numero, kar.talla,
// mdd.codigo, mdd.stylename, kar.codigobarraean13,mar.nombre AS marca,ka.color
//FROM `adicionkardextienda` kar, `modelos` mdd, `marcas` mar,`adiciondetalleingreso` ka
//WHERE kar.idmodelodetalle = mdd.idmodelo AND mdd.idmarca=mar.idmarca AND ka.idmodelo=kar.idmodelodetalle AND kar.idoperacion =ka.idingreso
//AND kar.idoperacion = '$idingreso'
//";
    $sql1="
SELECT kar.idkardextienda, kar.idmodelodetalle, kar.idtienda, kar.codigobarra,kar.precio3bs AS color, kar.saldocantidad, kar.cantidad, kar.numero, kar.talla,
 mdd.codigo, mdd.stylename, kar.codigobarraean13,mar.nombre AS marca
FROM `adicionkardextienda` kar, `modelos` mdd, `marcas` mar
WHERE kar.idmodelodetalle = mdd.idmodelo AND mdd.idmarca=mar.idmarca 
AND kar.idoperacion = '$idingreso'
";
  //  echo $sql1;
    $row = NumeroTuplas($sql1);
    $row1= $row['resultado'];
    $sql2 = getTablaToArrayOfSQL($sql1);
    $sql3 = $sql2['resultado'];
    $j=0;
    for ($i=0;$i<$row1;$i++){

        $codigo = $sql3[$i];
        $codigoBarra = $codigo['codigobarra'];
        $codigo1 = $codigo['codigobarraean13'];
$codigo = $sql3[$i];
       // $codigoBarra = $codigo['codigobarra'];

        $idmodelodetalle = $codigo['idmodelodetalle'];
        $codigomodelo = $codigo['codigo'];
        $marca = $codigo['marca'];
        $coleccion = $codigo['coleccion'];
       $talla = $codigo['talla'];
       
       $sql2="
SELECT kar.color
FROM `adiciondetalleingreso` kar
WHERE kar.idmodelo = '$imodelodetalle'
";
        $idalmacenA =  findBySqlReturnCampoUnique($sql2, true, true, 'color');
  //  $color = $idalmacenA['resultado'];
//echo $color;
       $color = $codigo['color'];

        $saldocantidad = $codigo['saldocantidad'];
        for($h=0;$h<$saldocantidad;$h++){
            if($j==4){
                $html .="</tr><tr>";
                $j=0;
            }
          $html .="
    <td style='width:25%;text-align:center;padding-bottom: 40px;padding-top: 0px; margin-top: -35px;font-size:12px;font-family:Tahoma;'>

      <p><img alt='Error? Cant display image!' src='php/imagen.php?code=ean13&amp;o=1&amp;t=50&amp;r=1&amp;text=".$codigo1."&amp;f=3&amp;a1=&amp;a2='><br />
    Marca : ".$marca."
Talla : ".$talla."<br />
Mod: ".$codigomodelo."
Col: ".$color."
    </div></td>
";
            $j++;

        }

    }
    $html .= "</table>";
    $html .= "</body>";
    $html .= "</html>";
    if($return == true)
    {
        return $html;
    }
    else
    {
        echo $html;
    }
}
function AdicionDetalleIngresoHTML($idingreso, $return)
{
 $idtienda = $_SESSION['idtienda'];
     // echo "codigo".$idventadetalle;
    $html = "";
$sql1 = "
      SELECT
ved.codigo,ved.fecha,ved.totalpares,mar.nombre AS marca
FROM
   adicioningresotienda ved, marcas mar
WHERE
   ved.idmarca=mar.idmarca AND ved.idingreso = '$idingreso' ";

 $idalmacenA =  findBySqlReturnCampoUnique($sql1, true, true, 'codigo');
   $numrecibo = $idalmacenA['resultado'];
   $idalmacenA1 =  findBySqlReturnCampoUnique($sql1, true, true, 'fecha');
   $fecha = $idalmacenA1['resultado'];
   $idalmacenA2 =  findBySqlReturnCampoUnique($sql1, true, true, 'marca');
   $marca = $idalmacenA2['resultado'];
      $idalmacenA23 =  findBySqlReturnCampoUnique($sql1, true, true, 'totalpares');
   $totalpares = $idalmacenA23['resultado'];

//    $sql1 = " SELECT ved.numero,ved.fecha, ved.observacion,ved.nit,ved.hora,CONCAT( ved.nombrecliente, '-', ved.apellidocliente ) AS cliente,ved.idclienteempresa,ved.tipoventa, ved.cantidad, ved.totalbs AS total, ved.descuento, ved.montocancelado,ved.montoapagar, ved.montocanceladosus
//FROM ventasdetalle ved
//WHERE ved.idventadetalle = '$idventadetalle' "
//    ;
//               // MostrarConsulta($sql1);
    //$dato = getTablaToArrayOfSQL($sql1);
    //$ven = $dato["resultado"];
    // $numrecibo = $ven[0]['codigo'];
    

   $html .= "<!DOCTYPE HTML PUBLIC '-//W3C//DTD HTML 4.01 Transitional//EN'>";
    $html .= "<html>";
    $html .= "<head>";
    $html .= "<title></title>";
    $html .= "<meta http-equiv='Content-Type' content='text/html; charset=UTF-8'>";
    $html .= "<link href='".$_SESSION["ruta"]."css/print.css' rel='stylesheet' type='text/css' media='all'>";
    //$html .= "<link href='../print.css' rel='stylesheet' type='text/css' media='all'>";
    $html .= "</head>";
    $html .= "<body>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
    $html .= "<tr>";
    //$html .= "<td style='width:400px;height:100px;border-bottom:1px solid #000000;'><img style='height:100px;' src='logo.jpg'>";
    $html .= "</td>";
    $html .= "<tr><td style='width:100px;font-size:11px;font-weight:bold;'>";
 $html .= "CALZADOS BALDERRAMA CBBA<br>";
  $html .= "Dir. San Martin esq.  Uruguay N 0699<br>";
   $html .= "Tel 4504183  Fax 4128833<br>";
    $html .= "e-mail: calzaba@supernet.com.bo";
$html .= "</td>";
$html .= "<td style='width:100px;font-size:11px;font-weight:bold;'></td>";
//$html .= "<td align:'left'; style='width:10px;height:100px;border-bottom:0px solid #000000;text-align:left;font-size:20px;font-family:Tahoma;'>";
//    $html .= "NOTA   DE ENTREGA";
//   $html .= "</td>";
  $html .= "<td style='width:200px;'>";
  $html .= "NOTA   DE REGISTRO";
   $html .= "</td>";
  $html .= "</tr>";

  $html .= "<td style='width:200px;height:100px;text-align:right;font-size:11px;font-family:Tahoma;'>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:200px;'>";
    //$html .= "<tr><td align='right'><img src='".$_SESSION["ruta"]."php/impl/codigo.jpg'><td><tr>";
    $html .= "<tr><td align='right' style='font-size:11px; font-family:Tahoma; text-align:center;font-weight:bold;'>";
    $html .= "<tr>";
    $html .= "<td>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
    $html .= "<tr><td style='width:100px;font-size:11px;font-weight:bold;'></td><td style='width:500px;'></td><td style='width:75px;font-size:11px;font-weight:bold;'>Nro:</td><td style='width:75px;'>".$numrecibo."</td></tr>";
 

  
   $formatear = explode( '-' , $fecha);
$fecha = $formatear[2].'-'.$formatear[1].'-' .$formatear[0];
   $html .= "<td></td><td></td><td style='font-size:11px;font-weight:bold;'>Fecha:</td><td>".$fecha."</td></tr>";
$html .= "<td style='font-size:11px;font-weight:bold;'>Marca:</td><td>".$marca."</td></tr>";

$html .= "<td style='font-size:11px;font-weight:bold;'>Por lo siguiente.....</td></tr>";
    $html .= "</table><br>";
    $html .= "</td>";
    $html .= "</tr>";
    $html .= "<tr>";
    $html .= "<td colspan='3'>";
    $sql2 ="
SELECT iddetalleingreso
FROM adiciondetalleingreso
WHERE idingreso = '$idingreso'
";

  $idalmacenA =  findBySqlReturnCampoUnique($sql2, true, true, 'iddetalleingreso');
    $iddetalleingreso = $idalmacenA['resultado'];
 $sqlIV = "
SELECT mdd.codigo AS modelo, dtp.totalpares, dtp.totalbs AS Precio, dtp.color, col.codigo AS coleccion, es.nombre AS estilo
FROM adiciondetalleingreso dtp, modelos mdd, coleccion col, lineas l, estilos es
WHERE dtp.idmodelo = mdd.idmodelo
AND mdd.idcoleccion = col.idcoleccion
AND mdd.idlinea = l.idlinea
AND l.idestilo = es.idestilo
AND dtp.idingreso  = '$idingreso'


";
   // $inventario = dibujarTablaOfSQLNormal($sqlInv, "Inventario");
    //$html .= $inventario['resultado'];

     $sqlV = " SELECT
                                dtpt.talla,
                                dtpt.cantidad
                                FROM
                               `detalleventamayortalla` dtpt
                                WHERE
                                dtpt.idventamayordetalle = '$idventamayordetalle'
                                ";

    //         $totalDescuento = $ven[0]['descuento'];
    $table =
      // MostrarConsulta($sqlIV);
     // dibujarTablaOfSQLNormal

        $table = dibujarTablaOfSQLNormal($sqlIV, "Detalle de Ingreso");
    $html .= $table['resultado'];
    $html .= "</td>";
    $html .= "</tr>";
     $html .= "<tr>";
    $html .= "<td colspan='3'>";
     $sqlV = " SELECT
                                dtpt.talla,
                                dtpt.cantidad
                                FROM
                               `detalleventamayortalla` dtpt
                                WHERE
                                dtpt.idventamayordetalle = '$idventamayordetalle'
                                ";
   // echo $idventamayor;
 $table1 =
           $table1 = dibujarTablaOfSQL($sqlV, "Tallas");
         //  $table1 =  dibujarTuplaOfSQLNormal($sqlV, $titulo = "ninguno");

    $html .= $table1['resultado'];
    $html .= "</td>";
    $html .= "</tr>";
    $html .= "<tr>";
    $html .= "<td colspan='3'>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'><br>";
  //  $html .= "<td style='width:100px;font-size:11px;font-weight:bold;'>Son:</td><td style='width:450px;'>".convertir_a_letras($ven[0]['total'], $ven[0]['abreviacion'])."</td>";
//    $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Observaciones:</td><td>".$ven[0]['observacion']."</td><td style='font-size:11px;font-weight:bold;'> Descuento:</td><td style='width:75px;text-align:right;'>".$ven1[0]['descuento']."</td></tr>";
    //$html .= "<tr><td style='font-size:11px;font-weight:bold;'>Emitido por:</td><td>".$ven[0]['login']."</td><td style='font-size:11px;font-weight:bold;'>Total credito (".$ven[0]['descuento']."):</td><td style='width:75px;text-align:right;'>".$totalCredito."</td></tr>";
//    $html .= "<tr><td style='font-size:11px;font-weight:bold;'></td><td></td><td style='font-size:11px;font-weight:bold;'>Total Venta :</td><td style='width:75px;text-align:right;'>".$montoapagar."</td></tr>";
    //        $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'>Foreground SRL</td></tr>";
    $html .= "</table>";
    $html .= "</td>";
    $html .= "</tr>";
 $html .= "<tr>";
    $html .= "<td colspan='3'>";
    $html .= "<table cellpadding='0' cellspacing='0' border='0' style='width:750px; font-size:11px; font-family:Tahoma;'>";
    $html .= "<tr><td style='width:100px;font-size:11px;font-weight:bold;'></td><td style='width:500px;' ></td><td style='width:75px;font-size:11px;font-weight:bold;'>Numero:</td><td style='width:75px;'>".$ven1[0]['numerodocumento']."</td></tr>";
    $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Cantidad Pares:</td><td>".$totalpares."</td><td style='font-size:11px;font-weight:bold;'> ".$ven1[0]['abreviacion']."</td><td>".$tc."</td></tr>";
//    $html .= "<td></td><td style='font-size:11px;font-weight:bold;'>Monto Total Bs:</td><td>".$ven[0]['total']."</td></tr>";
//    $html .= "<td></td><td style='font-size:11px;font-weight:bold;'>Descuento:</td><td>".$ven[0]['descuento']."</td></tr>";
//    $html .= "<td></td><td style='font-size:11px;font-weight:bold;'>Monto Cancelado Bs:</td><td>".$ven[0]['montocancelado']."</td></tr>";
// $html .= "<tr><td style='width:100px;font-size:15px;font-weight:bold;'>Son:</td><td style='width:450px;'>".convertir_a_letras($totalNeto, $ven[0]['abreviacion'])."</td><td style='font-size:15px;font-weight:bold;'>Total Descuento:</td><td style='width:75px;text-align:right;'>".$ven[0]['descuento']."</td></tr>";
        $html .= "<tr><td style='font-size:15px;font-weight:bold;'>Observaciones:</td><td>".$ven[0]['observacion']."</td><td style='font-size:15px;font-weight:bold;'></td><td style='font-size:15px;font-weight:bold;text-align:right;'>".$ven[0]['montoapagar']."</td></tr>";

   // $html .= "<tr><td style='font-size:11px;font-weight:bold;'>Por lo siguiente.....</td>";
    $html .= "</table><br>";
    $html .= "</td>";
    $html .= "</tr>";
    $html .= "<tr>";

    $html .= "<tr><td colspan='4' align='center' style='border-top:solid 1px #000000;'><div id='pie'>
    <p>Calzados Balderrama<br />
         Cochabamba - Bolivia<br />

    </p>
</div></td></tr>";
    $html .= "</table>";
    $html .= "</body>";
    $html .= "</html>";
    if($return == true)
    {
        return $html;
    }
    else
    {
        echo $html;
    }

    //    }
}


?>